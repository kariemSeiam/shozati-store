import{r as e,j as s,a6 as t,a8 as a,P as r,a5 as i,a9 as l,a as n,C as o,R as c,S as d,h as m,V as x,I as u,L as p,ae as h,o as b,g as y,ar as g,aC as j,aa as f,aD as v,aE as w}from"./vendor-react-Cigj1nJ7.js";import{A as N,c as C,C as k,b as S,d as T,e as I,f as P,g as A,h as O,u as L,i as M}from"./hooks-DR5HsQt1.js";import{P as F,B as q,a as z,F as H,M as D}from"./components-BozHnoVl.js";const E=()=>s.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",className:"absolute inset-0 w-full h-full opacity-10",children:[s.jsx("defs",{children:s.jsxs("pattern",{id:"premium-pattern",x:"0",y:"0",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:[s.jsx("circle",{cx:"5",cy:"5",r:"0.5",fill:"currentColor"}),s.jsx("circle",{cx:"0",cy:"0",r:"0.3",fill:"currentColor"}),s.jsx("circle",{cx:"10",cy:"10",r:"0.3",fill:"currentColor"})]})}),s.jsx("rect",{width:"100%",height:"100%",fill:"url(#premium-pattern)"})]}),V=({icon:a,onClick:r,isActive:l,label:n})=>{const[o,c]=e.useState(!1);return s.jsxs(t.button,{onHoverStart:()=>c(!0),onHoverEnd:()=>c(!1),onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative p-3 rounded-2xl overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white via-primary-50/50 to-white \r\n                     backdrop-blur-xl transition-all duration-300"}),s.jsx("div",{className:"absolute inset-0 text-primary-500/10",children:s.jsx(E,{})}),s.jsx(t.div,{className:"absolute inset-0 opacity-0 group-hover:opacity-100",animate:{background:o?["linear-gradient(45deg, rgba(14, 165, 233, 0.15) 0%, transparent 100%)","linear-gradient(45deg, transparent 0%, rgba(56, 189, 248, 0.15) 100%)"]:"none"},transition:{duration:2.5,repeat:1/0,repeatType:"reverse"}}),s.jsx(t.div,{className:"absolute inset-0 opacity-0 group-hover:opacity-100 rounded-2xl",animate:{boxShadow:o?["inset 0 0 0 1px rgba(14, 165, 233, 0.3), 0 4px 12px rgba(14, 165, 233, 0.1)","inset 0 0 0 1px rgba(56, 189, 248, 0.3), 0 4px 12px rgba(56, 189, 248, 0.1)"]:"none"},transition:{duration:1.8,repeat:1/0,repeatType:"reverse"}}),s.jsx(t.div,{animate:{scale:o?1.15:1,rotate:o?[0,8,-8,0]:0,y:o?-2:0},transition:{scale:{duration:.3,ease:"easeOut"},rotate:{duration:.6,ease:"easeInOut"},y:{duration:.2}},className:"relative",children:s.jsx(a,{className:"w-6 h-6 transition-all duration-300\n                       "+(o?"text-primary-600 filter drop-shadow-lg":"text-primary-700")})}),n&&s.jsx(i,{children:o&&s.jsx(t.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 \r\n                         text-xs font-medium text-primary-600 whitespace-nowrap",children:n})})]})},$=()=>s.jsx(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative px-4",children:s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:"/logo.png",alt:"Shozati Logo",className:"h-10 w-auto"}),s.jsx(t.div,{className:"absolute -inset-2 bg-gradient-to-r from-primary-500/20 via-primary-400/20 to-primary-500/20 \r\n                   blur-xl opacity-0 rounded-full",animate:{opacity:[0,.6,0],scale:[.9,1.1,.9],rotate:[0,5,0]},transition:{duration:4,repeat:1/0,repeatType:"reverse"}})]})}),U=({onOrdersClick:i,onProfileClick:n})=>{const{isAuthenticated:o,login:c}=e.useContext(N),[d,m]=e.useState(!1),[x,u]=e.useState(!1),p=async e=>{o?"orders"===e?i():"profile"===e&&n():m(!0)};return s.jsxs(t.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"sticky top-0 z-40",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-50/95 via-white/90 to-primary-50/95 \r\n                    backdrop-blur-lg shadow-lg shadow-primary-100/50"}),s.jsx("div",{className:"relative px-4 py-2",children:s.jsxs("div",{className:"flex justify-between items-center max-w-6xl mx-auto",children:[s.jsx(V,{icon:a,onClick:()=>p("profile"),label:"Profile"}),s.jsx($,{}),s.jsx(V,{icon:r,onClick:()=>p("orders"),label:"Orders"})]})}),s.jsx(F,{isOpen:d,onClose:()=>m(!1),onVerified:async e=>{u(!0);try{await c(e.phone_number)&&m(!1)}catch(s){throw l.error(s.message||"Login failed"),s}finally{u(!1)}},loading:x,isLogin:!0})]})},R=({onSelect:a})=>{const{slides:r,loading:l,error:c,fetchSlides:d}=C(),[m,x]=e.useState(0),[u,p]=e.useState(!1),[h,b]=e.useState(null),y=e.useRef({start:0,end:0}),g=e.useRef(null),j=e.useRef(null),f=e.useCallback(e=>{let s=e;e<0?s=r?.length-1:e>=r?.length&&(s=0),x(s)},[r?.length]),v=e.useCallback(e=>{b(e),f("right"===e?m-1:m+1),setTimeout(()=>b(null),300)},[m,f]);return e.useEffect(()=>{if(!(!r?.length||r.length<=1||u))return g.current=setInterval(()=>{v("left")},5e3),()=>g.current&&clearInterval(g.current)},[r,u,v]),l?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-primary-50",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(n,{className:"w-8 h-8 text-primary-500 animate-spin"})})}):c?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-primary-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(o,{className:"w-12 h-12 text-rose-500 mx-auto mb-4"}),s.jsx("p",{className:"text-slate-700 mb-4",children:"فشل في تحميل المحتوى"}),s.jsx("button",{onClick:d,className:"btn-primary",children:"إعادة المحاولة"})]})}):r?.length?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-neutral-50 shadow-md",children:s.jsxs("div",{ref:j,className:"absolute inset-0 transition-transform duration-300",dir:"rtl",onTouchStart:e=>{p(!0),y.current={start:e.touches[0].clientX,startTime:Date.now(),end:e.touches[0].clientX}},onTouchMove:e=>{y.current.end=e.touches[0].clientX;const s=y.current.start-y.current.end,t=j.current;t&&(t.style.transform=`translateX(${.5*-s}px)`)},onTouchEnd:()=>{p(!1);const e=j.current;e&&(e.style.transform="");const{start:s,end:t,startTime:a}=y.current,r=s-t,i=Date.now()-a,l=Math.abs(r/i);(Math.abs(r)>50||l>.5)&&v(r>0?"left":"right"),y.current={start:0,end:0}},children:[s.jsx(i,{initial:!1,mode:"wait",children:r.map((e,r)=>s.jsx(t.div,{initial:{opacity:0,x:"left"===h?100:-100},animate:{opacity:r===m?1:0,x:r===m?0:"left"===h?-100:100,transition:{duration:.3}},exit:{opacity:0,x:"left"===h?-100:100},className:"absolute inset-0 cursor-pointer",onClick:()=>a?.(e.product),children:s.jsxs("div",{className:"relative h-full",children:[s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover",loading:0===r?"eager":"lazy"}),s.jsx("div",{className:"absolute"}),s.jsxs("div",{className:"absolute bottom-0 right-0 p-6 text-right max-w-2xl",children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-2 drop-shadow-lg",children:e.title}),s.jsx("p",{className:"text-sm text-neutral-100 drop-shadow-md",children:e.description})]})]})},e.id))}),s.jsx("div",{className:"absolute bottom-2 inset-x-0 flex justify-center gap-2 z-20",children:r.map((e,a)=>s.jsx("button",{onClick:e=>{e.stopPropagation(),f(a)},className:"group","aria-label":`الانتقال إلى الشريحة ${a+1}`,children:s.jsx(t.div,{animate:{width:m===a?24:8,opacity:m===a?1:.7},className:"h-2 bg-white rounded-full transition-all duration-300 \r\n                         shadow-sm group-hover:opacity-90"})},a))})]})}):null},B=e=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),X=c.memo(({item:a,onRemove:l,onUpdateQuantity:n})=>{const[c,d]=e.useState(!1),[x,u]=e.useState(!1),p=e.useCallback(e=>{d(!0),e<1?u(!0):(n(a.cartItemId,e),setTimeout(()=>d(!1),300))},[a.cartItemId,n]),h=e.useCallback(()=>{x?(l(a.cartItemId),u(!1)):u(!0)},[x,a.cartItemId,l]);return s.jsxs("div",{className:"group relative card p-3 sm:p-4 \r\n                transition-all duration-200",dir:"rtl",children:[x&&s.jsx("div",{className:"absolute inset-0 z-20 rounded-2xl \r\n                    bg-white/95 backdrop-blur-sm\r\n                    flex items-center justify-center\r\n                    transition-opacity duration-200",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 p-4 text-center",children:[s.jsx(o,{className:"w-8 h-8 text-red-500"}),s.jsx("p",{className:"text-slate-800 font-medium",children:"هل تريد حذف هذا المنتج؟"}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsx("button",{onClick:h,className:"px-4 py-2 bg-rose-500 text-white rounded-xl\r\n                          font-medium hover:bg-rose-600 \r\n                          transition-colors duration-200",children:"تأكيد الحذف"}),s.jsx("button",{onClick:()=>u(!1),className:"btn-secondary",children:"إلغاء"})]})]})}),s.jsx(i,{children:c&&s.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-10 rounded-2xl bg-primary-50/30 \r\n                      flex items-center justify-center",children:s.jsx("div",{className:"bg-white/90 p-2 rounded-full shadow-lg",children:s.jsx(m,{className:"w-5 h-5 text-primary-500"})})})}),s.jsxs("div",{className:"relative flex gap-3 sm:gap-4",children:[s.jsx("div",{className:"relative flex-none w-20 sm:w-28 aspect-square",children:s.jsxs("div",{className:"relative h-full rounded-xl overflow-hidden \r\n                         bg-gradient-to-b from-neutral-50 to-white\r\n                         ring-1 ring-neutral-100 group-hover:ring-primary-100\r\n                         transition-all duration-300",children:[s.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover transform transition-all \r\n                         duration-500 group-hover:scale-105"}),s.jsxs(t.div,{layout:!0,className:"absolute bottom-1.5 left-1.5 \r\n                         bg-white/95 backdrop-blur-sm\r\n                         px-2 py-0.5 text-xs font-semibold\r\n                         text-primary-600 rounded-full shadow-md\r\n                         ring-1 ring-primary-100",children:["×",a.quantity]})]})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>!c&&u(!0),className:" absolute left-0 top-0 z-10 flex-left p-2 sm:p-2.5 rounded-xl\r\n                     bg-red-50 text-red-500 hover:bg-red-100\r\n                     transition-all duration-300\r\n                     disabled:opacity-50",disabled:c,"aria-label":"حذف المنتج",children:s.jsx(b,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between gap-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"font-bold text-neutral-900 \r\n                          group-hover:text-primary-600 \r\n                          transition-colors duration-300\r\n                          text-sm sm:text-base truncate",children:a.name}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(r,{className:"w-3.5 h-3.5 text-neutral-400"}),s.jsxs("p",{className:"text-xs sm:text-sm text-neutral-500",children:[a.size," - ",a.colorName]})]}),s.jsxs("div",{className:"flex items-baseline gap-1.5",children:[s.jsx(t.span,{layout:!0,className:"text-base sm:text-lg font-bold \r\n                           bg-gradient-to-l from-primary-600 to-primary-500 \r\n                           bg-clip-text text-transparent",children:B(a.price)}),s.jsx("span",{className:"text-xs sm:text-sm text-neutral-400",children:"/ القطعة"})]})]}),s.jsxs("div",{className:"flex justify-between items-end \r\n                         pt-2 sm:pt-3 mt-1 sm:mt-2\r\n                         border-t border-neutral-100",children:[s.jsxs("div",{className:"flex items-center gap-1 p-1 \r\n                           bg-neutral-50 rounded-lg \r\n                           group-hover:bg-primary-50/50",children:[s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(a.quantity+1),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md bg-white \r\n                           text-neutral-600 flex items-center justify-center \r\n                           shadow-sm hover:bg-primary-50 hover:text-primary-600",disabled:c,children:s.jsx(y,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),s.jsx(t.div,{layout:!0,className:"w-8 sm:w-10 text-center",children:s.jsx("span",{className:"text-neutral-800 font-semibold \r\n                                text-sm sm:text-base",children:a.quantity})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(a.quantity-1),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md bg-white \r\n                           text-neutral-600 flex items-center justify-center \r\n                           shadow-sm hover:bg-primary-50 hover:text-primary-600\r\n                           disabled:opacity-50 disabled:cursor-not-allowed",disabled:a.quantity<=1||c,children:s.jsx(g,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]}),s.jsxs("div",{className:"text-right ",children:[s.jsx("span",{className:"text-xs sm:text-sm text-neutral-500",children:"الإجمالي"}),s.jsx(t.div,{layout:!0,className:"text-base sm:text-lg font-bold \r\n                           bg-gradient-to-l from-primary-600 to-primary-500 \r\n                           bg-clip-text text-transparent",children:B(a.price*a.quantity)})]})]})]})]})]})}),Q=({isProcessing:a,onApplyCoupon:r})=>{const[l,n]=e.useState(""),c=e.useRef(null),{cartTotal:d}=e.useContext(k),{validateCoupon:m,currentCoupon:u,validatingCoupon:h,error:b,clearError:y,calculateDiscount:g,clearCoupon:j}=T();e.useEffect(()=>()=>{j()},[j]);const f=e.useCallback(async e=>{if(e?.preventDefault(),!l.trim()||h||a)return;const s=await m(l,d);if(s){const e=g(d);r({...s,discount:e})}},[l,h,a,m,d,g,r]),v=e.useCallback(e=>{const s=e.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");n(s),b&&y()},[b,y]),w=e.useCallback(()=>{n(""),j(),r(null)},[j,r]);return s.jsxs("div",{className:"space-y-3",dir:"rtl",children:[s.jsxs("form",{onSubmit:f,className:"relative group",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:c,type:"text",value:l,onChange:v,placeholder:"أدخل كود الخصم",maxLength:8,className:"w-full px-4 py-3 rounded-xl bg-white border border-primary-100\r\n                     focus:border-primary-500 focus:ring-2 focus:ring-primary-200\r\n                     transition-all duration-300 text-neutral-800\r\n                     placeholder:text-neutral-400 tracking-wide\r\n                     disabled:opacity-60 disabled:cursor-not-allowed\r\n                     group-hover:border-primary-200",disabled:a||h}),l&&s.jsxs(t.span,{initial:{opacity:0},animate:{opacity:1},className:"absolute left-28 top-1/2 -translate-y-1/2 text-xs text-neutral-400",children:[l.length,"/8"]}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:!l.trim()||a||h,className:"absolute left-2 top-2 px-4 py-1.5 bg-primary-500 text-white rounded-lg\r\n                     font-medium hover:bg-primary-600 transition-all duration-300\r\n                     disabled:opacity-50 disabled:cursor-not-allowed\r\n                     hover:shadow-md hover:shadow-primary-100\r\n                     flex items-center gap-2",children:[h?s.jsx(p,{className:"w-4 h-4 animate-spin"}):s.jsx(x,{className:"w-4 h-4"}),s.jsx("span",{children:"تطبيق"})]})]}),s.jsx(t.p,{initial:!1,animate:{opacity:l?0:.7},className:"absolute -bottom-6 right-2 text-xs text-neutral-500 pointer-events-none",children:"ادخل كود الخصم الخاص بك للحصول على خصم إضافي"})]}),s.jsxs(i,{mode:"wait",children:[b&&s.jsxs(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-red-600 bg-red-50/80 \r\n                     backdrop-blur-sm px-4 py-3 rounded-xl text-sm\r\n                     border border-red-100 shadow-sm",children:[s.jsx(o,{className:"w-4 h-4"}),s.jsx("span",{children:b})]}),u&&s.jsxs(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center justify-between gap-2 \r\n                     bg-success-50/80 backdrop-blur-sm px-4 py-3 rounded-xl\r\n                     border border-success-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-success-100 p-2 rounded-lg",children:s.jsx(x,{className:"w-5 h-5 text-success-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-success-700",children:"percentage"===u.discountType?`خصم ${u.discountValue}%`:`خصم ${B(u.discountValue)}`}),s.jsx("p",{className:"text-sm text-success-600",children:"تم تطبيق كود الخصم بنجاح"})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"font-bold text-success-600",children:B(g(d))}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:w,className:"text-xs text-success-600 hover:text-success-700\r\n                         underline underline-offset-2",children:"إزالة"})]})]})]})]})},W=({orderDetails:a,handleConfirmOrder:r,onBack:i,isLoading:l})=>{const{cartTotal:n,cart:o}=e.useContext(k),{currentCoupon:c}=T(),[d,b]=e.useState(null),{shippingCost:y,discount:g,finalTotal:j,itemsWithDiscount:f}=e.useMemo(()=>{const e=n>500?0:25,s=d||c,t=s?"percentage"===s.discountType?n*s.discountValue/100:s.discountValue:0,a=o.map(e=>{const a=e.price*e.quantity,r=s?"percentage"===s.discountType?a*s.discountValue/100:a/n*t:0;return{...e,originalTotal:a,discountAmount:Math.round(100*r)/100,finalTotal:Math.round(100*(a-r))/100}});return{shippingCost:e,discount:Math.round(100*t)/100,finalTotal:Math.round(100*(n+e-t))/100,itemsWithDiscount:a}},[o,n,c,d]),v=e.useCallback(()=>{r(d?.code||"")},[r,d,n,y,g,j,f]);return s.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4 font-arabic",children:[s.jsxs("div",{className:"bg-gradient-to-br from-white to-primary-50 rounded-3xl p-6 space-y-6\r\n                    border border-primary-100 shadow-sm relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-5 bg-repeat"}),s.jsxs("div",{className:"relative space-y-2",dir:"rtl",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-primary-100 rounded-full p-2",children:s.jsx(x,{className:"w-5 h-5 text-primary-600"})}),s.jsx("h4",{className:"font-bold text-xl text-neutral-800",children:"كوبون الخصم"})]})}),s.jsx(Q,{onApplyCoupon:b,isProcessing:l})]}),s.jsxs("div",{className:"relative space-y-2 pt-4 border-t border-primary-100",dir:"rtl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-primary-100 rounded-full p-2",children:s.jsx(u,{className:"w-5 h-5 text-primary-600"})}),s.jsx("h4",{className:"font-bold text-xl text-neutral-800",children:"عنوان التوصيل"})]}),s.jsxs(t.div,{className:"bg-white rounded-2xl p-5 space-y-3 border border-primary-100 shadow-sm\r\n                         hover:shadow-md transition-shadow duration-300",whileHover:{scale:1.01},children:[s.jsx("p",{className:"text-neutral-800 text-lg leading-relaxed",children:a.address.details}),s.jsxs("p",{className:"text-neutral-500 flex items-center gap-2",children:[s.jsx("span",{children:a.address.governorate}),s.jsx("span",{className:"text-primary-500",children:"•"}),s.jsx("span",{children:a.address.district})]})]})]}),s.jsx("div",{className:"relative space-y-4 pt-6 border-t border-primary-100",dir:"rtl",children:s.jsxs("div",{className:"space-y-4 bg-white rounded-2xl p-5 border border-primary-100",children:[f.map((e,a)=>s.jsxs("div",{className:"flex justify-between items-start pb-4 border-b border-neutral-100 last:border-0 last:pb-0",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-neutral-800",children:e.name}),s.jsxs("span",{className:"text-neutral-500",children:["×",e.quantity]})]}),e.discountAmount>0&&s.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-success-600",children:["وفرت ",B(e.discountAmount)]})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-neutral-800",children:B(e.originalTotal)}),e.discountAmount>0&&s.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-success-600 font-bold",children:B(e.finalTotal)})]})]},a)),s.jsxs("div",{className:"space-y-3 pt-4 border-t border-primary-100",children:[s.jsxs("div",{className:"flex justify-between text-neutral-600",children:[s.jsx("span",{children:"المجموع الفرعي"}),s.jsx("span",{className:"font-bold",children:B(n)})]}),s.jsxs("div",{className:"flex justify-between text-neutral-600",children:[s.jsx("span",{children:"رسوم التوصيل"}),s.jsx("span",{className:"font-bold "+(0===y?"text-success-600":""),children:0===y?"مجاناً":B(y)})]}),g>0&&s.jsxs("div",{className:"flex justify-between text-success-600",children:[s.jsx("span",{children:"الخصم"}),s.jsxs("span",{className:"font-bold",children:["- ",B(g)]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-neutral-100",dir:"ltr",children:[s.jsx("span",{className:"text-xl font-bold text-primary-600",children:B(j)}),s.jsx("span",{className:"text-lg text-neutral-800",children:"المجموع الكلي"})]})]})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},disabled:l,onClick:v,className:"w-full bg-gradient-to-r from-primary-500 to-primary-600 \r\n                   text-white rounded-xl py-4 font-bold text-lg\r\n                   disabled:opacity-50 flex items-center justify-center gap-3",children:l?s.jsx(p,{className:"w-6 h-6 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(m,{className:"w-6 h-6"}),s.jsx("span",{children:"تأكيد الطلب"})]})}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:i,className:"w-full bg-neutral-100 text-neutral-700 rounded-xl py-4 \r\n                   font-bold text-lg flex items-center justify-center gap-3",children:[s.jsx(h,{className:"w-6 h-6"}),s.jsx("span",{children:"العودة للسلة"})]})]})]})},G=({orderId:e,onViewOrders:a,emptyCart:r})=>s.jsxs(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 space-y-6",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-success-100 to-success-50 mx-auto flex items-center justify-center shadow-md",children:s.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},children:s.jsx(m,{className:"w-12 h-12 text-success-500"})})}),s.jsx("div",{className:"space-y-4",children:s.jsx("h3",{className:"text-xl font-bold text-neutral-800 p-2",children:"تم تأكيد طلبك بنجاح"})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{r(),a()},className:"bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-xl px-8 py-3 font-bold hover:shadow-lg hover:brightness-105 transition-all duration-300",children:"متابعة الطلب"})]}),_=()=>s.jsxs("div",{className:"text-center py-12 space-y-4 bg-primary-50 rounded-xl",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-primary-100 mx-auto flex items-center justify-center",children:s.jsx(d,{className:"w-12 h-12 text-primary-600"})}),s.jsx("h3",{className:"text-xl font-bold text-neutral-800",children:"السلة فارغة"}),s.jsx("p",{className:"text-neutral-600",children:"لم تقم بإضافة أي منتجات للسلة بعد"})]}),Z=({onOrderCreated:a,checkAuthAndProceed:r,openModal:n})=>{const{cart:o,isCartOpen:c,setIsCartOpen:m,removeFromCart:x,updateQuantity:u,emptyCart:p}=e.useContext(k),{userInfo:h}=e.useContext(N),{createOrder:b}=S(),[y,g]=e.useState({isProcessing:!1,confirmation:{show:!1,orderId:null,success:!1,total:0},error:null}),j=e.useCallback(()=>{r({requiresAuth:!0,requiresAddress:!0,onSuccess:()=>{g(e=>({...e,confirmation:{show:!0,orderId:null,success:!1,total:0}}))},onNotAuthenticated:()=>{n("showLogin")},onNoAddress:()=>{n("showLocation")}})},[r,n]),f=e.useCallback(async e=>{try{g(e=>({...e,isProcessing:!0,error:null}));const s={items:o.map(e=>({variant_id:e.variantId,size:e.size,quantity:e.quantity})),addressId:h.addresses[0].id,coupon:e||0},t=await b(s);t.success?(g(e=>({...e,isProcessing:!1,confirmation:{show:!0,orderId:t.order.id,success:!0,total:t.order.total,coupon:t.order.coupon}})),l.success("تم إنشاء طلبك بنجاح",{style:{background:"#EFF6FF",color:"#1E40AF"}})):(g(e=>({...e,isProcessing:!1,error:t.error})),l.error(t.error))}catch(s){g(e=>({...e,isProcessing:!1,error:s.message})),l.error(s.message)}},[o,h?.addresses,b]),v=e.useCallback(()=>{g(e=>({...e,confirmation:{show:!1,orderId:null,success:!1,total:0}}))},[]),w=e.useCallback(()=>{m(!1),g({isProcessing:!1,confirmation:{show:!1,orderId:null,success:!1,total:0},error:null}),a(y.confirmation.orderId)},[y.confirmation.orderId,a,m]);return s.jsx(q,{isOpen:c,onClose:()=>m(!1),title:"سلة التسوق",className:"bg-white",children:s.jsx("div",{className:"p-4",children:s.jsx(i,{mode:"wait",children:y.confirmation.success?s.jsx(G,{orderId:y.confirmation.orderId,onViewOrders:w,emptyCart:p,className:"bg-white shadow-lg rounded-xl p-6"}):y.confirmation.show?s.jsx(W,{orderDetails:{address:h.addresses[0],items:o,error:y.error},handleConfirmOrder:f,onBack:v,isLoading:y.isProcessing,className:"bg-white shadow-lg rounded-xl p-6"}):0===o.length?s.jsx(_,{}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"space-y-4",children:o.map(e=>s.jsx(X,{item:e,onRemove:x,onUpdateQuantity:u},`${e.id}-${e.variantId}-${e.size}`))}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:j,className:"w-full bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-xl py-4 font-bold hover:shadow-lg hover:brightness-105 transition-all duration-300 flex items-center justify-center gap-2",children:[s.jsx(d,{className:"w-5 h-5"}),s.jsx("span",{children:"متابعة الشراء"})]})]})})})})},J=e.memo(({selectedCategory:t,onSelect:a})=>{const r=e.useMemo(()=>[{id:"all",name:"الكل",icon:d,locked:!1,comingSoon:!1},{id:"women",name:"حريمي",icon:d,locked:!1,comingSoon:!1},{id:"men",name:"رجالي",icon:d,locked:!1,comingSoon:!1},{id:"bags",name:"شنط",icon:d,locked:!0,comingSoon:!0},{id:"accessories",name:"إكسسوارات",icon:d,locked:!0,comingSoon:!0}],[]);return s.jsxs("div",{className:"relative",dir:"rtl",children:[s.jsx("div",{className:"px-4 pt-3 pb-1",children:s.jsx("div",{className:"overflow-x-auto hide-scrollbar",children:s.jsx("div",{className:"flex gap-2 pb-2",children:r.map(e=>s.jsxs("button",{onClick:()=>!e.locked&&a(e.id),className:`relative min-w-max flex items-center gap-2 px-4 py-2.5 rounded-full \n                          text-sm font-medium transition-all duration-200 ${e.locked?"bg-primary-50/30 text-primary-600/50 opacity-80":t===e.id?"bg-gradient-primary text-white shadow-lg":"bg-neutral-50 text-slate-700 hover:bg-neutral-100 hover:shadow-sm"} ${e.locked?"":"hover:scale-102 active:scale-98"}`,disabled:e.locked,children:[s.jsx(e.icon,{className:"w-4 h-4 "+(e.locked?"text-primary-400/70":t===e.id?"text-white":"text-primary-600")}),s.jsx("span",{children:e.name}),e.comingSoon&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(j,{className:"w-3.5 h-3.5 text-primary-400"}),s.jsx("span",{className:"text-xs text-primary-400",children:"قريباً"})]}),t===e.id&&!e.locked&&s.jsx("div",{className:"absolute -right-1 -top-1",children:s.jsx(f,{className:"w-4 h-4 text-white"})})]},e.id))})})}),s.jsx("div",{className:"absolute top-0 right-0 w-12 h-full bg-gradient-to-l from-white to-transparent pointer-events-none"}),s.jsx("div",{className:"absolute top-0 left-0 w-12 h-full bg-gradient-to-r from-white to-transparent pointer-events-none"})]})});J.displayName="HorizontalCategoryScroller";const K=({productCode:t})=>{const{setIsCartOpen:a}=e.useContext(k),{uiState:r,closeModal:i,openModal:l,selectCategory:n,selectProduct:o,setOrderId:c}=A({selectedCategory:"all"}),{checkAuthAndProceed:d,handlePhoneVerification:m,handleLocationUpdate:x,isLoading:u,isAuthenticated:p,userInfo:h}=O(),{products:b,loading:y,loadMore:g,updateFilters:j,setPage:f,totalPages:w}=L({}),{slides:N,loading:S}=C(),{handleCategorySelect:T}=M({updateFilters:j,setPage:f,selectCategory:n}),I=e.useCallback(()=>{l("showProfile")},[l]),P=e.useCallback(()=>{p?d({requiresAuth:!0,requiresAddress:!0,onSuccess:()=>l("showOrders"),onNoAddress:()=>l("showLocation")}):l("showLogin")},[d,p,l]),F=e.useCallback(()=>{l(p?"showFavorites":"showLogin")},[p,l]),q=e.useCallback(()=>{a(!0)},[a]),E=e.useCallback(e=>{o(e)},[o]),V=e.useCallback(e=>{c(e)},[c]),$=e.useCallback(e=>{i(e)},[i]),B=e.useCallback(async e=>{try{(await m(e)).success&&i("showLogin")}catch{}},[m,i]),X=e.useCallback(async e=>{try{(await x(e)).success&&i("showLocation")}catch{}},[x,i]);return e.useEffect(()=>{if(t&&b.length>0){const e=b.find(e=>e.code===t);e&&o(e)}},[t,b,o]),s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(v,{position:"top-center",toastOptions:{className:"bg-white backdrop-blur-xl border border-neutral-200 rounded-2xl px-6 py-4 shadow-lg",duration:3e3,style:{color:"#1e293b",fontSize:"14px",fontWeight:"500"}}}),s.jsx("header",{children:s.jsx(U,{onOrdersClick:P,onProfileClick:I})}),s.jsx("nav",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-xl border-b border-neutral-200",children:s.jsx(J,{selectedCategory:r.selectedCategory,onSelect:T})}),s.jsxs("main",{className:"pb-24",children:[s.jsx("div",{className:"p-4 pt-2 pb-2",children:s.jsx(R,{slides:N,loading:S,onSelect:E})}),s.jsx(z,{products:b,productsLoading:y,selectedCategory:r.selectedCategory,totalPages:w,loadMore:g,onProductSelect:E,checkAuthAndProceed:d,updateFilters:j,setPage:f,setSelectedCategory:n})]}),s.jsx(H,{onFavoritesClick:F,onCartClick:q}),s.jsx(Z,{onOrderCreated:V,checkAuthAndProceed:d,openModal:l}),s.jsx(D,{uiState:r,userInfo:h,isLoading:u,onCloseModal:$,onPhoneVerification:B,onLocationUpdate:X,onProductSelect:E,checkAuthAndProceed:d})]})};K.propTypes={productCode:w.string};const Y=({productCode:e})=>s.jsx(I,{children:s.jsx(P,{children:s.jsx(K,{productCode:e})})});Y.propTypes={productCode:w.string};export{Y as default};
