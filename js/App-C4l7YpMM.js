import{r as e,j as s,a6 as t,a8 as a,P as r,a5 as l,a9 as i,a as n,C as o,R as c,S as d,h as x,V as m,I as h,L as u,ae as p,o as y,g,ar as b,aC as j,aa as f,aD as v,aE as w}from"./vendor-react-Cigj1nJ7.js";import{A as N,c as k,C,b as S,d as T,e as I,f as P,g as A,h as O,u as L,i as F}from"./hooks-DR5HsQt1.js";import{P as q,B as M,a as z,F as H,M as D}from"./components-DNCjEtpa.js";const E=()=>s.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",className:"absolute inset-0 w-full h-full opacity-10",children:[s.jsx("defs",{children:s.jsxs("pattern",{id:"premium-pattern",x:"0",y:"0",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:[s.jsx("circle",{cx:"5",cy:"5",r:"0.5",fill:"currentColor"}),s.jsx("circle",{cx:"0",cy:"0",r:"0.3",fill:"currentColor"}),s.jsx("circle",{cx:"10",cy:"10",r:"0.3",fill:"currentColor"})]})}),s.jsx("rect",{width:"100%",height:"100%",fill:"url(#premium-pattern)"})]}),V=({icon:a,onClick:r,isActive:i,label:n})=>{const[o,c]=e.useState(!1);return s.jsxs(t.button,{onHoverStart:()=>c(!0),onHoverEnd:()=>c(!1),onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative p-3 rounded-2xl overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white via-primary-50/50 to-white \r\n                     backdrop-blur-xl transition-all duration-300"}),s.jsx("div",{className:"absolute inset-0 text-primary-500/10",children:s.jsx(E,{})}),s.jsx(t.div,{className:"absolute inset-0 opacity-0 group-hover:opacity-100",animate:{background:o?["linear-gradient(45deg, rgba(59, 130, 246, 0.15) 0%, transparent 100%)","linear-gradient(45deg, transparent 0%, rgba(245, 158, 11, 0.15) 100%)"]:"none"},transition:{duration:2.5,repeat:1/0,repeatType:"reverse"}}),s.jsx(t.div,{className:"absolute inset-0 opacity-0 group-hover:opacity-100 rounded-2xl",animate:{boxShadow:o?["inset 0 0 0 1px rgba(59, 130, 246, 0.3), 0 4px 12px rgba(59, 130, 246, 0.1)","inset 0 0 0 1px rgba(245, 158, 11, 0.3), 0 4px 12px rgba(245, 158, 11, 0.1)"]:"none"},transition:{duration:1.8,repeat:1/0,repeatType:"reverse"}}),s.jsx(t.div,{animate:{scale:o?1.15:1,rotate:o?[0,8,-8,0]:0,y:o?-2:0},transition:{scale:{duration:.3,ease:"easeOut"},rotate:{duration:.6,ease:"easeInOut"},y:{duration:.2}},className:"relative",children:s.jsx(a,{className:"w-6 h-6 transition-all duration-300\n                       "+(o?"text-primary-600 filter drop-shadow-lg":"text-primary-700")})}),n&&s.jsx(l,{children:o&&s.jsx(t.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 \r\n                         text-xs font-medium text-primary-600 whitespace-nowrap",children:n})})]})},$=()=>s.jsx(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative px-4",children:s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:"/logo.png",alt:"Shozati Logo",className:"h-10 w-auto"}),s.jsx(t.div,{className:"absolute -inset-2 bg-gradient-to-r from-primary-500/20 via-secondary-400/20 to-primary-500/20 \r\n                   blur-xl opacity-0 rounded-full",animate:{opacity:[0,.6,0],scale:[.9,1.1,.9],rotate:[0,5,0]},transition:{duration:4,repeat:1/0,repeatType:"reverse"}})]})}),U=({onOrdersClick:l,onProfileClick:n})=>{const{isAuthenticated:o,login:c}=e.useContext(N),[d,x]=e.useState(!1),[m,h]=e.useState(!1),u=async e=>{o?"orders"===e?l():"profile"===e&&n():x(!0)};return s.jsxs(t.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"sticky top-0 z-40",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-50/95 via-white/90 to-secondary-50/95 \r\n                    backdrop-blur-lg shadow-lg shadow-primary-100/50"}),s.jsx("div",{className:"relative px-4 py-2",children:s.jsxs("div",{className:"flex justify-between items-center max-w-6xl mx-auto",children:[s.jsx(V,{icon:a,onClick:()=>u("profile"),label:"Profile"}),s.jsx($,{}),s.jsx(V,{icon:r,onClick:()=>u("orders"),label:"Orders"})]})}),s.jsx(q,{isOpen:d,onClose:()=>x(!1),onVerified:async e=>{h(!0);try{await c(e.phone_number)&&x(!1)}catch(s){throw i.error(s.message||"Login failed"),s}finally{h(!1)}},loading:m,isLogin:!0})]})},R=({onSelect:a})=>{const{slides:r,loading:i,error:c,fetchSlides:d}=k(),[x,m]=e.useState(0),[h,u]=e.useState(!1),[p,y]=e.useState(null),g=e.useRef({start:0,end:0}),b=e.useRef(null),j=e.useRef(null),f=e.useCallback(e=>{let s=e;e<0?s=r?.length-1:e>=r?.length&&(s=0),m(s)},[r?.length]),v=e.useCallback(e=>{y(e),f("right"===e?x-1:x+1),setTimeout(()=>y(null),300)},[x,f]);return e.useEffect(()=>{if(!(!r?.length||r.length<=1||h))return b.current=setInterval(()=>{v("left")},5e3),()=>b.current&&clearInterval(b.current)},[r,h,v]),i?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-primary-50",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(n,{className:"w-8 h-8 text-primary-500 animate-spin"})})}):c?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-primary-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(o,{className:"w-12 h-12 text-rose-500 mx-auto mb-4"}),s.jsx("p",{className:"text-slate-700 mb-4",children:"فشل في تحميل المحتوى"}),s.jsx("button",{onClick:d,className:"btn-primary",children:"إعادة المحاولة"})]})}):r?.length?s.jsx("div",{className:"relative h-48 md:h-96 rounded-xl overflow-hidden bg-gray-50 shadow-md",children:s.jsxs("div",{ref:j,className:"absolute inset-0 transition-transform duration-300",dir:"rtl",onTouchStart:e=>{u(!0),g.current={start:e.touches[0].clientX,startTime:Date.now(),end:e.touches[0].clientX}},onTouchMove:e=>{g.current.end=e.touches[0].clientX;const s=g.current.start-g.current.end,t=j.current;t&&(t.style.transform=`translateX(${.5*-s}px)`)},onTouchEnd:()=>{u(!1);const e=j.current;e&&(e.style.transform="");const{start:s,end:t,startTime:a}=g.current,r=s-t,l=Date.now()-a,i=Math.abs(r/l);(Math.abs(r)>50||i>.5)&&v(r>0?"left":"right"),g.current={start:0,end:0}},children:[s.jsx(l,{initial:!1,mode:"wait",children:r.map((e,r)=>s.jsx(t.div,{initial:{opacity:0,x:"left"===p?100:-100},animate:{opacity:r===x?1:0,x:r===x?0:"left"===p?-100:100,transition:{duration:.3}},exit:{opacity:0,x:"left"===p?-100:100},className:"absolute inset-0 cursor-pointer",onClick:()=>a?.(e.product),children:s.jsxs("div",{className:"relative h-full",children:[s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover",loading:0===r?"eager":"lazy"}),s.jsx("div",{className:"absolute"}),s.jsxs("div",{className:"absolute bottom-0 right-0 p-6 text-right max-w-2xl",children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-2 drop-shadow-lg",children:e.title}),s.jsx("p",{className:"text-sm text-gray-100 drop-shadow-md",children:e.description})]})]})},e.id))}),s.jsx("div",{className:"absolute bottom-2 inset-x-0 flex justify-center gap-2 z-20",children:r.map((e,a)=>s.jsx("button",{onClick:e=>{e.stopPropagation(),f(a)},className:"group","aria-label":`الانتقال إلى الشريحة ${a+1}`,children:s.jsx(t.div,{animate:{width:x===a?24:8,opacity:x===a?1:.7},className:"h-2 bg-white rounded-full transition-all duration-300 \r\n                         shadow-sm group-hover:opacity-90"})},a))})]})}):null},B=e=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),X=c.memo(({item:a,onRemove:i,onUpdateQuantity:n})=>{const[c,d]=e.useState(!1),[m,h]=e.useState(!1),u=e.useCallback(e=>{d(!0),e<1?h(!0):(n(a.cartItemId,e),setTimeout(()=>d(!1),300))},[a.cartItemId,n]),p=e.useCallback(()=>{m?(i(a.cartItemId),h(!1)):h(!0)},[m,a.cartItemId,i]);return s.jsxs("div",{className:"group relative card p-3 sm:p-4 \r\n                transition-all duration-200",dir:"rtl",children:[m&&s.jsx("div",{className:"absolute inset-0 z-20 rounded-2xl \r\n                    bg-white/95 backdrop-blur-sm\r\n                    flex items-center justify-center\r\n                    transition-opacity duration-200",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 p-4 text-center",children:[s.jsx(o,{className:"w-8 h-8 text-red-500"}),s.jsx("p",{className:"text-slate-800 font-medium",children:"هل تريد حذف هذا المنتج؟"}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsx("button",{onClick:p,className:"px-4 py-2 bg-rose-500 text-white rounded-xl\r\n                          font-medium hover:bg-rose-600 \r\n                          transition-colors duration-200",children:"تأكيد الحذف"}),s.jsx("button",{onClick:()=>h(!1),className:"btn-secondary",children:"إلغاء"})]})]})}),s.jsx(l,{children:c&&s.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-10 rounded-2xl bg-sky-50/30 \r\n                      flex items-center justify-center",children:s.jsx("div",{className:"bg-white/90 p-2 rounded-full shadow-lg",children:s.jsx(x,{className:"w-5 h-5 text-sky-500"})})})}),s.jsxs("div",{className:"relative flex gap-3 sm:gap-4",children:[s.jsx("div",{className:"relative flex-none w-20 sm:w-28 aspect-square",children:s.jsxs("div",{className:"relative h-full rounded-xl overflow-hidden \r\n                         bg-gradient-to-b from-gray-50 to-white\r\n                         ring-1 ring-gray-100 group-hover:ring-sky-100\r\n                         transition-all duration-300",children:[s.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover transform transition-all \r\n                         duration-500 group-hover:scale-105"}),s.jsxs(t.div,{layout:!0,className:"absolute bottom-1.5 left-1.5 \r\n                         bg-white/95 backdrop-blur-sm\r\n                         px-2 py-0.5 text-xs font-semibold\r\n                         text-sky-600 rounded-full shadow-md\r\n                         ring-1 ring-sky-100",children:["×",a.quantity]})]})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>!c&&h(!0),className:" absolute left-0 top-0 z-10 flex-left p-2 sm:p-2.5 rounded-xl\r\n                     bg-red-50 text-red-500 hover:bg-red-100\r\n                     transition-all duration-300\r\n                     disabled:opacity-50",disabled:c,"aria-label":"حذف المنتج",children:s.jsx(y,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between gap-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"font-bold text-gray-900 \r\n                          group-hover:text-sky-600 \r\n                          transition-colors duration-300\r\n                          text-sm sm:text-base truncate",children:a.name}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(r,{className:"w-3.5 h-3.5 text-gray-400"}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:[a.size," - ",a.colorName]})]}),s.jsxs("div",{className:"flex items-baseline gap-1.5",children:[s.jsx(t.span,{layout:!0,className:"text-base sm:text-lg font-bold \r\n                           bg-gradient-to-l from-sky-600 to-sky-500 \r\n                           bg-clip-text text-transparent",children:B(a.price)}),s.jsx("span",{className:"text-xs sm:text-sm text-gray-400",children:"/ القطعة"})]})]}),s.jsxs("div",{className:"flex justify-between items-end \r\n                         pt-2 sm:pt-3 mt-1 sm:mt-2\r\n                         border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-1 p-1 \r\n                           bg-gray-50 rounded-lg \r\n                           group-hover:bg-sky-50/50",children:[s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u(a.quantity+1),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md bg-white \r\n                           text-gray-600 flex items-center justify-center \r\n                           shadow-sm hover:bg-sky-50 hover:text-sky-600",disabled:c,children:s.jsx(g,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),s.jsx(t.div,{layout:!0,className:"w-8 sm:w-10 text-center",children:s.jsx("span",{className:"text-gray-800 font-semibold \r\n                                text-sm sm:text-base",children:a.quantity})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u(a.quantity-1),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md bg-white \r\n                           text-gray-600 flex items-center justify-center \r\n                           shadow-sm hover:bg-sky-50 hover:text-sky-600\r\n                           disabled:opacity-50 disabled:cursor-not-allowed",disabled:a.quantity<=1||c,children:s.jsx(b,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]}),s.jsxs("div",{className:"text-right ",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:"الإجمالي"}),s.jsx(t.div,{layout:!0,className:"text-base sm:text-lg font-bold \r\n                           bg-gradient-to-l from-sky-600 to-sky-500 \r\n                           bg-clip-text text-transparent",children:B(a.price*a.quantity)})]})]})]})]})]})}),Q=({isProcessing:a,onApplyCoupon:r})=>{const[i,n]=e.useState(""),c=e.useRef(null),{cartTotal:d}=e.useContext(C),{validateCoupon:x,currentCoupon:h,validatingCoupon:p,error:y,clearError:g,calculateDiscount:b,clearCoupon:j}=T();e.useEffect(()=>()=>{j()},[j]);const f=e.useCallback(async e=>{if(e?.preventDefault(),!i.trim()||p||a)return;const s=await x(i,d);if(s){const e=b(d);r({...s,discount:e})}},[i,p,a,x,d,b,r]),v=e.useCallback(e=>{const s=e.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");n(s),y&&g()},[y,g]),w=e.useCallback(()=>{n(""),j(),r(null)},[j,r]);return s.jsxs("div",{className:"space-y-3",dir:"rtl",children:[s.jsxs("form",{onSubmit:f,className:"relative group",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:c,type:"text",value:i,onChange:v,placeholder:"أدخل كود الخصم",maxLength:8,className:"w-full px-4 py-3 rounded-xl bg-white border border-sky-100\r\n                     focus:border-sky-500 focus:ring-2 focus:ring-sky-200\r\n                     transition-all duration-300 text-gray-800\r\n                     placeholder:text-gray-400 tracking-wide\r\n                     disabled:opacity-60 disabled:cursor-not-allowed\r\n                     group-hover:border-sky-200",disabled:a||p}),i&&s.jsxs(t.span,{initial:{opacity:0},animate:{opacity:1},className:"absolute left-28 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:[i.length,"/8"]}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:!i.trim()||a||p,className:"absolute left-2 top-2 px-4 py-1.5 bg-sky-500 text-white rounded-lg\r\n                     font-medium hover:bg-sky-600 transition-all duration-300\r\n                     disabled:opacity-50 disabled:cursor-not-allowed\r\n                     hover:shadow-md hover:shadow-sky-100\r\n                     flex items-center gap-2",children:[p?s.jsx(u,{className:"w-4 h-4 animate-spin"}):s.jsx(m,{className:"w-4 h-4"}),s.jsx("span",{children:"تطبيق"})]})]}),s.jsx(t.p,{initial:!1,animate:{opacity:i?0:.7},className:"absolute -bottom-6 right-2 text-xs text-gray-500 pointer-events-none",children:"ادخل كود الخصم الخاص بك للحصول على خصم إضافي"})]}),s.jsxs(l,{mode:"wait",children:[y&&s.jsxs(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-red-600 bg-red-50/80 \r\n                     backdrop-blur-sm px-4 py-3 rounded-xl text-sm\r\n                     border border-red-100 shadow-sm",children:[s.jsx(o,{className:"w-4 h-4"}),s.jsx("span",{children:y})]}),h&&s.jsxs(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center justify-between gap-2 \r\n                     bg-emerald-50/80 backdrop-blur-sm px-4 py-3 rounded-xl\r\n                     border border-emerald-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-emerald-100 p-2 rounded-lg",children:s.jsx(m,{className:"w-5 h-5 text-emerald-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-emerald-700",children:"percentage"===h.discountType?`خصم ${h.discountValue}%`:`خصم ${B(h.discountValue)}`}),s.jsx("p",{className:"text-sm text-emerald-600",children:"تم تطبيق كود الخصم بنجاح"})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"font-bold text-emerald-600",children:B(b(d))}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:w,className:"text-xs text-emerald-600 hover:text-emerald-700\r\n                         underline underline-offset-2",children:"إزالة"})]})]})]})]})},W=({orderDetails:a,handleConfirmOrder:r,onBack:l,isLoading:i})=>{const{cartTotal:n,cart:o}=e.useContext(C),{currentCoupon:c}=T(),[d,y]=e.useState(null),{shippingCost:g,discount:b,finalTotal:j,itemsWithDiscount:f}=e.useMemo(()=>{const e=n>500?0:25,s=d||c,t=s?"percentage"===s.discountType?n*s.discountValue/100:s.discountValue:0,a=o.map(e=>{const a=e.price*e.quantity,r=s?"percentage"===s.discountType?a*s.discountValue/100:a/n*t:0;return{...e,originalTotal:a,discountAmount:Math.round(100*r)/100,finalTotal:Math.round(100*(a-r))/100}});return{shippingCost:e,discount:Math.round(100*t)/100,finalTotal:Math.round(100*(n+e-t))/100,itemsWithDiscount:a}},[o,n,c,d]),v=e.useCallback(()=>{r(d?.code||"")},[r,d,n,g,b,j,f]);return s.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4 font-arabic",children:[s.jsxs("div",{className:"bg-gradient-to-br from-white to-sky-50 rounded-3xl p-6 space-y-6\r\n                    border border-sky-100 shadow-sm relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-5 bg-repeat"}),s.jsxs("div",{className:"relative space-y-2",dir:"rtl",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-sky-100 rounded-full p-2",children:s.jsx(m,{className:"w-5 h-5 text-sky-600"})}),s.jsx("h4",{className:"font-bold text-xl text-gray-800",children:"كوبون الخصم"})]})}),s.jsx(Q,{onApplyCoupon:y,isProcessing:i})]}),s.jsxs("div",{className:"relative space-y-2 pt-4 border-t border-sky-100",dir:"rtl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-sky-100 rounded-full p-2",children:s.jsx(h,{className:"w-5 h-5 text-sky-600"})}),s.jsx("h4",{className:"font-bold text-xl text-gray-800",children:"عنوان التوصيل"})]}),s.jsxs(t.div,{className:"bg-white rounded-2xl p-5 space-y-3 border border-sky-100 shadow-sm\r\n                         hover:shadow-md transition-shadow duration-300",whileHover:{scale:1.01},children:[s.jsx("p",{className:"text-gray-800 text-lg leading-relaxed",children:a.address.details}),s.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[s.jsx("span",{children:a.address.governorate}),s.jsx("span",{className:"text-sky-500",children:"•"}),s.jsx("span",{children:a.address.district})]})]})]}),s.jsx("div",{className:"relative space-y-4 pt-6 border-t border-sky-100",dir:"rtl",children:s.jsxs("div",{className:"space-y-4 bg-white rounded-2xl p-5 border border-sky-100",children:[f.map((e,a)=>s.jsxs("div",{className:"flex justify-between items-start pb-4 border-b border-gray-100 last:border-0 last:pb-0",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-800",children:e.name}),s.jsxs("span",{className:"text-gray-500",children:["×",e.quantity]})]}),e.discountAmount>0&&s.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-emerald-600",children:["وفرت ",B(e.discountAmount)]})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-gray-800",children:B(e.originalTotal)}),e.discountAmount>0&&s.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-emerald-600 font-bold",children:B(e.finalTotal)})]})]},a)),s.jsxs("div",{className:"space-y-3 pt-4 border-t border-sky-100",children:[s.jsxs("div",{className:"flex justify-between text-gray-600",children:[s.jsx("span",{children:"المجموع الفرعي"}),s.jsx("span",{className:"font-bold",children:B(n)})]}),s.jsxs("div",{className:"flex justify-between text-gray-600",children:[s.jsx("span",{children:"رسوم التوصيل"}),s.jsx("span",{className:"font-bold "+(0===g?"text-emerald-600":""),children:0===g?"مجاناً":B(g)})]}),b>0&&s.jsxs("div",{className:"flex justify-between text-emerald-600",children:[s.jsx("span",{children:"الخصم"}),s.jsxs("span",{className:"font-bold",children:["- ",B(b)]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",dir:"ltr",children:[s.jsx("span",{className:"text-xl font-bold text-sky-600",children:B(j)}),s.jsx("span",{className:"text-lg text-gray-800",children:"المجموع الكلي"})]})]})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},disabled:i,onClick:v,className:"w-full bg-gradient-to-r from-sky-500 to-sky-600 \r\n                   text-white rounded-xl py-4 font-bold text-lg\r\n                   disabled:opacity-50 flex items-center justify-center gap-3",children:i?s.jsx(u,{className:"w-6 h-6 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(x,{className:"w-6 h-6"}),s.jsx("span",{children:"تأكيد الطلب"})]})}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:l,className:"w-full bg-gray-100 text-gray-700 rounded-xl py-4 \r\n                   font-bold text-lg flex items-center justify-center gap-3",children:[s.jsx(p,{className:"w-6 h-6"}),s.jsx("span",{children:"العودة للسلة"})]})]})]})},G=({orderId:e,onViewOrders:a,emptyCart:r})=>s.jsxs(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 space-y-6",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-emerald-100 to-emerald-50 mx-auto flex items-center justify-center shadow-md",children:s.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},children:s.jsx(x,{className:"w-12 h-12 text-emerald-500"})})}),s.jsx("div",{className:"space-y-4",children:s.jsx("h3",{className:"text-xl font-bold text-gray-800 p-2",children:"تم تأكيد طلبك بنجاح"})}),s.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{r(),a()},className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white rounded-xl px-8 py-3 font-bold hover:shadow-lg hover:brightness-105 transition-all duration-300",children:"متابعة الطلب"})]}),_=()=>s.jsxs("div",{className:"text-center py-12 space-y-4 bg-sky-50 rounded-xl",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-sky-100 mx-auto flex items-center justify-center",children:s.jsx(d,{className:"w-12 h-12 text-sky-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"السلة فارغة"}),s.jsx("p",{className:"text-gray-600",children:"لم تقم بإضافة أي منتجات للسلة بعد"})]}),Z=({onOrderCreated:a,checkAuthAndProceed:r})=>{const{cart:n,isCartOpen:o,setIsCartOpen:c,removeFromCart:x,updateQuantity:m,emptyCart:h}=e.useContext(C),{userInfo:u}=e.useContext(N),{createOrder:p}=S(),[y,g]=e.useState({isProcessing:!1,confirmation:{show:!1,orderId:null,success:!1,total:0},error:null}),b=e.useCallback(()=>{r({requiresAuth:!0,requiresAddress:!0,onSuccess:()=>{g(e=>({...e,confirmation:{show:!0,orderId:null,success:!1,total:0}}))}})},[r]),j=e.useCallback(async e=>{try{g(e=>({...e,isProcessing:!0,error:null}));const s={items:n.map(e=>({variant_id:e.variantId,size:e.size,quantity:e.quantity})),addressId:u.addresses[0].id,coupon:e||0},t=await p(s);t.success?(g(e=>({...e,isProcessing:!1,confirmation:{show:!0,orderId:t.order.id,success:!0,total:t.order.total,coupon:t.order.coupon}})),i.success("تم إنشاء طلبك بنجاح",{style:{background:"#EFF6FF",color:"#1E40AF"}})):(g(e=>({...e,isProcessing:!1,error:t.error})),i.error(t.error))}catch(s){g(e=>({...e,isProcessing:!1,error:s.message})),i.error(s.message)}},[n,u?.addresses,p]),f=e.useCallback(()=>{g(e=>({...e,confirmation:{show:!1,orderId:null,success:!1,total:0}}))},[]),v=e.useCallback(()=>{c(!1),g({isProcessing:!1,confirmation:{show:!1,orderId:null,success:!1,total:0},error:null}),a(y.confirmation.orderId)},[y.confirmation.orderId,a,c]);return s.jsx(M,{isOpen:o,onClose:()=>c(!1),title:"سلة التسوق",className:"bg-white",children:s.jsx("div",{className:"p-4",children:s.jsx(l,{mode:"wait",children:y.confirmation.success?s.jsx(G,{orderId:y.confirmation.orderId,onViewOrders:v,emptyCart:h,className:"bg-white shadow-lg rounded-xl p-6"}):y.confirmation.show?s.jsx(W,{orderDetails:{address:u.addresses[0],items:n,error:y.error},handleConfirmOrder:j,onBack:f,isLoading:y.isProcessing,className:"bg-white shadow-lg rounded-xl p-6"}):0===n.length?s.jsx(_,{}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"space-y-4",children:n.map(e=>s.jsx(X,{item:e,onRemove:x,onUpdateQuantity:m},`${e.id}-${e.variantId}-${e.size}`))}),s.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:b,className:"w-full bg-gradient-to-r from-sky-500 to-sky-600 text-white rounded-xl py-4 font-bold hover:shadow-lg hover:brightness-105 transition-all duration-300 flex items-center justify-center gap-2",children:[s.jsx(d,{className:"w-5 h-5"}),s.jsx("span",{children:"متابعة الشراء"})]})]})})})})},J=e.memo(({selectedCategory:t,onSelect:a})=>{const r=e.useMemo(()=>[{id:"all",name:"الكل",icon:d,locked:!1,comingSoon:!1},{id:"women",name:"حريمي",icon:d,locked:!1,comingSoon:!1},{id:"men",name:"رجالي",icon:d,locked:!1,comingSoon:!1},{id:"bags",name:"شنط",icon:d,locked:!0,comingSoon:!0},{id:"accessories",name:"إكسسوارات",icon:d,locked:!0,comingSoon:!0}],[]);return s.jsxs("div",{className:"relative",dir:"rtl",children:[s.jsx("div",{className:"px-4 pt-3 pb-1",children:s.jsx("div",{className:"overflow-x-auto hide-scrollbar",children:s.jsx("div",{className:"flex gap-2 pb-2",children:r.map(e=>s.jsxs("button",{onClick:()=>!e.locked&&a(e.id),className:`relative min-w-max flex items-center gap-2 px-4 py-2.5 rounded-full \n                          text-sm font-medium transition-all duration-200 ${e.locked?"bg-primary-50/30 text-primary-600/50 opacity-80":t===e.id?"bg-gradient-primary text-white shadow-lg":"bg-gray-50 text-slate-700 hover:bg-gray-100 hover:shadow-sm"} ${e.locked?"":"hover:scale-102 active:scale-98"}`,disabled:e.locked,children:[s.jsx(e.icon,{className:"w-4 h-4 "+(e.locked?"text-primary-400/70":t===e.id?"text-white":"text-primary-600")}),s.jsx("span",{children:e.name}),e.comingSoon&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(j,{className:"w-3.5 h-3.5 text-primary-400"}),s.jsx("span",{className:"text-xs text-primary-400",children:"قريباً"})]}),t===e.id&&!e.locked&&s.jsx("div",{className:"absolute -right-1 -top-1",children:s.jsx(f,{className:"w-4 h-4 text-white"})})]},e.id))})})}),s.jsx("div",{className:"absolute top-0 right-0 w-12 h-full bg-gradient-to-l from-white to-transparent pointer-events-none"}),s.jsx("div",{className:"absolute top-0 left-0 w-12 h-full bg-gradient-to-r from-white to-transparent pointer-events-none"})]})});J.displayName="HorizontalCategoryScroller";const K=({productCode:t})=>{const{setIsCartOpen:a}=e.useContext(C),{uiState:r,closeModal:l,openModal:i,selectCategory:n,selectProduct:o,setOrderId:c}=A({selectedCategory:"all"}),{checkAuthAndProceed:d,handlePhoneVerification:x,handleLocationUpdate:m,isLoading:h,isAuthenticated:u,userInfo:p}=O(),{products:y,loading:g,loadMore:b,updateFilters:j,setPage:f,totalPages:w}=L({}),{slides:N,loading:S}=k(),{handleCategorySelect:T}=F({updateFilters:j,setPage:f,selectCategory:n}),I=e.useCallback(()=>{i("showProfile")},[i]),P=e.useCallback(()=>{u?d({requiresAuth:!0,requiresAddress:!0,onSuccess:()=>i("showOrders"),onNoAddress:()=>i("showLocation")}):i("showLogin")},[d,u,i]),q=e.useCallback(()=>{i(u?"showFavorites":"showLogin")},[u,i]),M=e.useCallback(()=>{a(!0)},[a]),E=e.useCallback(e=>{o(e)},[o]),V=e.useCallback(e=>{c(e)},[c]),$=e.useCallback(e=>{l(e)},[l]),B=e.useCallback(async e=>{try{(await x(e)).success&&l("showLogin")}catch{}},[x,l]),X=e.useCallback(async e=>{try{(await m(e)).success&&l("showLocation")}catch{}},[m,l]);return e.useEffect(()=>{if(t&&y.length>0){const e=y.find(e=>e.code===t);e&&o(e)}},[t,y,o]),s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(v,{position:"top-center",toastOptions:{className:"bg-white backdrop-blur-xl border border-gray-200 rounded-2xl px-6 py-4 shadow-lg",duration:3e3,style:{color:"#1e293b",fontSize:"14px",fontWeight:"500"}}}),s.jsx("header",{children:s.jsx(U,{onOrdersClick:P,onProfileClick:I})}),s.jsx("nav",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-xl border-b border-gray-200",children:s.jsx(J,{selectedCategory:r.selectedCategory,onSelect:T})}),s.jsxs("main",{className:"pb-24",children:[s.jsx("div",{className:"p-4 pt-2 pb-2",children:s.jsx(R,{slides:N,loading:S,onSelect:E})}),s.jsx(z,{products:y,productsLoading:g,selectedCategory:r.selectedCategory,totalPages:w,loadMore:b,onProductSelect:E,checkAuthAndProceed:d,updateFilters:j,setPage:f,setSelectedCategory:n})]}),s.jsx(H,{onFavoritesClick:q,onCartClick:M}),s.jsx(Z,{onOrderCreated:V,checkAuthAndProceed:d}),s.jsx(D,{uiState:r,userInfo:p,isLoading:h,onCloseModal:$,onPhoneVerification:B,onLocationUpdate:X,onProductSelect:E,checkAuthAndProceed:d})]})};K.propTypes={productCode:w.string};const Y=({productCode:e})=>s.jsx(I,{children:s.jsx(P,{children:s.jsx(K,{productCode:e})})});Y.propTypes={productCode:w.string};export{Y as default};
