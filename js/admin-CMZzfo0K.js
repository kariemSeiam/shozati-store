import{j as e,r as t,R as a,C as r,a as l,W as s,P as n,S as i,U as o,b as d,c,d as u,e as m,T as h,L as g,X as b,f as p,g as x,B as f,h as v,G as y,i as N,k as w,l as C,A as k,m as S,n as P,o as j,p as E,q as $,s as D,t as U,u as z,M as L,v as F,w as O,x as I,y as R,z as T,D as A,Y as G,E as B,F as q,H as _,I as M,J as V,K as J,N as W,O as K,Q,V as Y,Z as X,_ as H,$ as Z,a0 as ee,a1 as te,a2 as ae,a3 as re}from"./vendor-react-2emUoSyi.js";const le=e.jsx,se=e.jsxs,ne=e.Fragment,ie="https://shozati.pythonanywhere.com/api",oe=()=>{const[e,a]=t.useState(localStorage.getItem("adminToken")),[r,l]=t.useState(!1),[s,n]=t.useState(!1),[i,o]=t.useState(!1),[d,c]=t.useState(null),[u,m]=t.useState(null);t.useRef(null);const h=async()=>{o(!0),m(null);try{const e=await fetch(`${ie}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:"0000000000"})});if(!e.ok)throw new Error("Authentication failed");const t=await e.json();return a(t.token),localStorage.setItem("adminToken",t.token),t}catch(e){throw m(e.message),e}finally{o(!1)}},g=t.useCallback(()=>{localStorage.removeItem("adminToken"),a(null),l(!1)},[]);t.useEffect(()=>{(async()=>{if(!e&&!r)try{await h()}catch(t){}l(!0)})()},[e,r]);const b=t.useCallback(async(t,a={})=>{const r=async e=>{let r={Authorization:`Bearer ${e}`,...a.headers};a.body instanceof FormData||(r["Content-Type"]="application/json");const l=await fetch(`${ie}${t}`,{...a,headers:r}),s=l.headers.get("content-type");return s&&s.includes("application/json")?await l.json():await l.text()};try{return await r(e)}catch(l){if("AbortError"===l.name)return null;if(l.message.includes("Token"))try{const e=await h();return await r(e.token)}catch(s){throw new Error("Re-authentication failed")}throw l}},[e]);return{token:e,isInitialized:r,loading:s,isAuthenticating:i,error:d,authError:u,setLoading:n,setError:c,login:h,logout:g,apiCall:b}},de=(e={})=>{const[a,r]=t.useState([]),[l,s]=t.useState(null),[n,i]=t.useState(0),[o,d]=t.useState(0),[c,u]=t.useState({}),[m,h]=t.useState(1),[g]=t.useState(e.perPage||150),[b,p]=t.useState({category:"all",search:"",minPrice:null,maxPrice:null,size:"",color:"",code:e.initialFilters?.code||"",sort:""}),[x,f]=t.useState({isLoading:!1,isCreating:!1,isUpdating:!1,isDeleting:!1,isUploadingImages:!1}),[v,y]=t.useState({fetchError:null,createError:null,updateError:null,deleteError:null,uploadError:null}),{apiCall:N}=oe(),w=t.useRef(null),C=t.useRef(new Map);t.useRef([]);const k=t.useCallback((e,t)=>{f(a=>({...a,[e]:t}))},[]),S=t.useCallback((e,t)=>{y(a=>({...a,[e]:t}))},[]),P=t.useCallback(()=>{C.current.clear()},[]),j=t.useCallback(async(e=m,t=b)=>{w.current&&w.current.abort(),w.current=new AbortController,k("isLoading",!0),S("fetchError",null);const a=JSON.stringify({page:e,...t});try{if(C.current.has(a)){const e=C.current.get(a);return r(e.products),i(e.total),d(e.pages),e}const l=new URLSearchParams({page:e,perPage:g,..."all"!==t.category&&{category:t.category},...t.search&&{search:t.search},...t.minPrice&&{minPrice:t.minPrice},...t.maxPrice&&{maxPrice:t.maxPrice},...t.size&&{size:t.size},...t.color&&{color:t.color},...t.code&&{code:t.code},sort:t.sort}),n=await N(`/admin/products?${l}`,{signal:w.current.signal});if(n)return r(n.products),i(n.total),d(n.pages),C.current.set(a,n),n;t.code&&1===n.products.length&&s(n.products[0])}catch(l){if("AbortError"===l.name)return;return S("fetchError",l.message),null}finally{k("isLoading",!1)}},[N,b,m,g,S,k]),E=t.useCallback(async(e,t,a,r)=>{k("isUploadingImages",!0),S("uploadError",null);try{const l=[];for(let s=0;s<a.length;s++){const n=new FormData;n.append("productCode",e),n.append("colorName",t),n.append("image",a[s]);const i=await N("/admin/products/upload-images",{method:"POST",body:n,headers:{},onUploadProgress:e=>{const t=e.loaded/e.total*100;r?.(s/a.length*100+t/a.length)}});i?.imageUrls?.[0]&&l.push(i.imageUrls[0])}return l}catch(l){return S("uploadError",l.message),[]}finally{k("isUploadingImages",!1)}},[N,S,k]),$=t.useCallback(async(e,t)=>{k("isCreating",!0),S("createError",null);try{const a=await N("/admin/products",{method:"POST",body:JSON.stringify({...e,variants:e.variants.map(e=>({...e,images:[]}))})});if(!a)throw new Error("Failed to create product");const r=await Promise.all(e.variants.map(async(e,r)=>{if(!t[r]?.length)return e;const l=await E(a.code,e.colorName,t[r],e=>{u(t=>({...t,[`${r}`]:e}))});return{...e,images:l}})),l=await N(`/admin/products/${a.id}`,{method:"PUT",body:JSON.stringify({...e,variants:r})});return C.current.clear(),await j(),l}catch(a){return S("createError",a.message),null}finally{k("isCreating",!1),u({})}},[N,j,S,k,E]),D=t.useCallback(async(e,t,a)=>{k("isUpdating",!0),S("updateError",null);try{const r=await Promise.all(t.variants.map(async(e,r)=>{if(!a[r]?.length)return e;const l=await E(t.code,e.colorName,a[r],e=>{u(t=>({...t,[`${r}`]:e}))});return{...e,images:[...e.images,...l]}})),l=await N(`/admin/products/${e}`,{method:"PUT",body:JSON.stringify({...t,variants:r})});return l&&(C.current.clear(),await j()),l}catch(r){return S("updateError",r.message),null}finally{k("isUpdating",!1),u({})}},[N,j,S,k,E]),U=t.useCallback(async e=>{k("isDeleting",!0),S("deleteError",null);try{const t=await N(`/admin/products/${e}`,{method:"DELETE"});return t&&(P(),await j()),t}catch(t){return S("deleteError",t.message),null}finally{k("isDeleting",!1)}},[N,P,j,S,k]),z=t.useCallback(async(e,t)=>{k("isUpdating",!0),S("updateError",null);try{const a=await N(`/admin/products/${e}/inventory`,{method:"PUT",body:JSON.stringify(t)});return a&&(P(),await j()),a}catch(a){return S("updateError",a.message),null}finally{k("isUpdating",!1)}},[N,P,j,S,k]),L=t.useCallback(e=>{p(t=>{const a={...t,...e};return JSON.stringify(t)!==JSON.stringify(a)&&h(1),a})},[]),F=t.useCallback(()=>{m<o&&h(e=>e+1)},[m,o]),O=t.useCallback(()=>{m>1&&h(e=>e-1)},[m]);return t.useEffect(()=>(j(),()=>{w.current&&w.current.abort()}),[j,m,b]),t.useEffect(()=>()=>{P(),w.current&&w.current.abort()},[P]),{products:a,selectedProduct:l,totalProducts:n,totalPages:o,page:m,perPage:g,filters:b,...x,...v,setSelectedProduct:s,setPage:h,updateFilters:L,fetchProducts:j,createProduct:$,updateProduct:D,deleteProduct:U,updateInventory:z,uploadProgress:c,uploadProductImages:E,nextPage:F,previousPage:O,clearCache:P}},ce=({children:e,className:t="",variant:a="default",padding:r="lg",hover:l=!0,...s})=>le("div",{className:`\n        relative overflow-hidden rounded-xl md:rounded-2xl border\n        backdrop-blur-xl transition-all duration-300\n        ${{default:"bg-neutral-850/50 border-neutral-700/50",elevated:"bg-neutral-850/70 border-neutral-700/70 shadow-xl shadow-black/20",outline:"bg-transparent border-neutral-700/50",glass:"bg-neutral-850/30 border-neutral-700/30 backdrop-blur-xl"}[a]}\n        ${{sm:"p-3",md:"p-4",lg:"p-4 md:p-6",xl:"p-6 md:p-8"}[r]}\n        ${l?"hover:bg-neutral-850/70 hover:border-neutral-600/50 hover:shadow-xl hover:shadow-black/10":""}\n        ${t}\n      `,...s,children:e}),ue=({children:e,variant:t="primary",size:a="md",fullWidth:r=!1,disabled:l=!1,loading:s=!1,className:n="",...i})=>se("button",{className:`\n        inline-flex items-center justify-center gap-2 rounded-xl\n        border font-medium transition-all duration-300\n        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-neutral-900\n        disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-current\n        ${{primary:"\n      bg-primary-500 text-white border-primary-500\n      hover:bg-primary-600 hover:border-primary-600\n      focus:ring-primary-500/50\n    ",secondary:"\n      bg-neutral-800/50 text-neutral-300 border-neutral-700/50\n      hover:bg-neutral-700/50 hover:border-neutral-600/50 hover:text-white\n      focus:ring-neutral-500/50\n    ",success:"\n      bg-success-500 text-white border-success-500\n      hover:bg-success-600 hover:border-success-600\n      focus:ring-success-500/50\n    ",warning:"\n      bg-warning-500 text-white border-warning-500\n      hover:bg-warning-600 hover:border-warning-600\n      focus:ring-warning-500/50\n    ",danger:"\n      bg-danger-500 text-white border-danger-500\n      hover:bg-danger-600 hover:border-danger-600\n      focus:ring-danger-500/50\n    ",ghost:"\n      bg-transparent text-neutral-400 border-transparent\n      hover:bg-neutral-800/50 hover:text-white hover:border-neutral-700/50\n      focus:ring-neutral-500/50\n    ",outline:"\n      bg-transparent text-primary-400 border-primary-500/50\n      hover:bg-primary-500/10 hover:border-primary-500 hover:text-primary-300\n      focus:ring-primary-500/50\n    "}[t]}\n        ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"}[a]}\n        ${r?"w-full":""}\n        ${n}\n      `,disabled:l||s,...i,children:[s&&le("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),e]}),me=a.forwardRef(({label:e,error:t,hint:a,type:l="text",size:s="md",fullWidth:n=!0,className:i="",...o},d)=>se("div",{className:"space-y-2 "+(n?"w-full":""),children:[e&&le("label",{className:"block text-sm font-medium text-neutral-300",children:e}),le("input",{ref:d,type:l,className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300\n          !bg-neutral-800/70 !text-white placeholder:text-neutral-400\n          ${t?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${{sm:"h-10 px-3 text-sm",md:"h-12 px-4 text-sm",lg:"h-14 px-5 text-base"}[s]}\n          ${"color"===l?"p-1 !bg-transparent":""}\n          ${i}\n        `,dir:"rtl",...o}),a&&!t&&le("p",{className:"text-xs text-neutral-500",children:a}),t&&se("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[le(r,{className:"w-4 h-4 flex-shrink-0"}),le("span",{children:t})]})]}));me.displayName="AdminInput";const he=({label:e,error:t,hint:a,options:l=[],size:s="md",fullWidth:n=!0,className:i="",placeholder:o="اختر...",...d})=>se("div",{className:"space-y-2 "+(n?"w-full":""),children:[e&&le("label",{className:"block text-sm font-medium text-neutral-300",children:e}),se("select",{className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300\n          !bg-neutral-800/70 !text-white\n          ${t?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${{sm:"h-10 px-3 text-sm",md:"h-12 px-4 text-sm",lg:"h-14 px-5 text-base"}[s]}\n          ${i}\n        `,dir:"rtl",...d,children:[le("option",{value:"",children:o}),l.map(({value:e,label:t})=>le("option",{value:e,children:t},e))]}),a&&!t&&le("p",{className:"text-xs text-neutral-500",children:a}),t&&se("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[le(r,{className:"w-4 h-4 flex-shrink-0"}),le("span",{children:t})]})]}),ge=({label:e,error:t,hint:a,rows:l=4,fullWidth:s=!0,className:n="",...i})=>se("div",{className:"space-y-2 "+(s?"w-full":""),children:[e&&le("label",{className:"block text-sm font-medium text-neutral-300",children:e}),le("textarea",{rows:l,className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300 resize-none\n          !bg-neutral-800/70 !text-white placeholder:text-neutral-400 p-4\n          ${t?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${n}\n        `,dir:"rtl",...i}),a&&!t&&le("p",{className:"text-xs text-neutral-500",children:a}),t&&se("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[le(r,{className:"w-4 h-4 flex-shrink-0"}),le("span",{children:t})]})]}),be=({title:e,value:t,icon:a,color:r="primary",trend:l,subtitle:s})=>{const n={primary:{bg:"bg-primary-500/10",text:"text-primary-400",border:"border-primary-500/20",iconBg:"bg-primary-500/20"},success:{bg:"bg-success-500/10",text:"text-success-400",border:"border-success-500/20",iconBg:"bg-success-500/20"},warning:{bg:"bg-warning-500/10",text:"text-warning-400",border:"border-warning-500/20",iconBg:"bg-warning-500/20"},danger:{bg:"bg-danger-500/10",text:"text-danger-400",border:"border-danger-500/20",iconBg:"bg-danger-500/20"},neutral:{bg:"bg-neutral-500/10",text:"text-neutral-400",border:"border-neutral-500/20",iconBg:"bg-neutral-500/20"}}[r];return le(ce,{className:`${n.border} ${n.bg}`,variant:"glass",padding:"lg",children:se("div",{className:"flex items-start justify-between",children:[se("div",{className:"flex-1",dir:"rtl",children:[le("h3",{className:"text-xs md:text-sm font-medium text-neutral-400 mb-2 leading-tight",children:e}),se("div",{className:"flex items-baseline gap-2",children:[le("span",{className:`text-lg md:text-3xl font-bold ${n.text} leading-none`,children:t}),s&&le("span",{className:"text-xs text-neutral-500",children:s})]}),void 0!==l&&se("div",{className:"mt-3 inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium\n                          "+(l>=0?"bg-success-500/10 border border-success-500/20 text-success-400":"bg-danger-500/10 border border-danger-500/20 text-danger-400"),children:[le("span",{children:l>=0?"↗":"↘"}),se("span",{children:[Math.abs(l).toFixed(1),"%"]})]})]}),le("div",{className:`w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center ${n.iconBg} flex-shrink-0`,children:le(a,{className:`w-5 h-5 md:w-6 md:h-6 ${n.text}`})})]})})},pe=()=>{const{analytics:e,isLoading:a,isRefreshing:r,error:g,refreshAnalytics:b}=(()=>{const[e,a]=t.useState({totalSales:0,orderCount:0,topProducts:[],revenueChart:[]}),[r,l]=t.useState("week"),[s,n]=t.useState({startDate:null,endDate:null}),[i,o]=t.useState(!1),[d,c]=t.useState(!1),[u,m]=t.useState(null),{apiCall:h}=oe(),g=t.useRef(null),b=t.useRef(!0),p=t.useCallback(async(e=r)=>{o(!0),m(null);try{const t=new URLSearchParams({period:e,...s.startDate&&{startDate:s.startDate.toISOString()},...s.endDate&&{endDate:s.endDate.toISOString()}}).toString(),r=await h(`/admin/analytics/dashboard?${t}`);return r&&a(r),r}catch(t){return m(t.message),null}finally{o(!1)}},[h,r,s]),x=t.useCallback(async()=>{if(!d){c(!0);try{await p()}finally{c(!1)}}},[p,d]),f=t.useCallback(e=>{b.current=e,!e&&g.current?(clearInterval(g.current),g.current=null):e&&!g.current&&(g.current=setInterval(x,3e5))},[x]),v=t.useCallback((e,t=null)=>{l(e),t&&n(t)},[]);return t.useEffect(()=>(b.current&&(g.current=setInterval(x,3e5)),p(),()=>{g.current&&clearInterval(g.current)}),[p,x]),t.useEffect(()=>{g.current&&clearInterval(g.current),b.current&&(g.current=setInterval(x,3e5))},[r,x]),{analytics:e,period:r,customDateRange:s,isLoading:i,isRefreshing:d,error:u,loadAnalytics:p,refreshAnalytics:x,toggleAutoRefresh:f,updatePeriod:v,setCustomDateRange:n}})(),p=t.useMemo(()=>{if(!e)return null;const t=(e,t)=>0===t?0:(e-t)/t*100;return{revenue:{current:e.totalSales,growth:t(e.revenueChart?.[e.revenueChart.length-1]?.revenue||0,e.revenueChart?.[e.revenueChart.length-2]?.revenue||0),color:"emerald"},orders:{current:e.orderCount,growth:t(e.orderCount,e.previousOrderCount||0),color:"blue"},avgOrderValue:{current:e.totalSales/e.orderCount,growth:t(e.totalSales/e.orderCount,e.previousAvgOrderValue||0),color:"amber"},customerRetention:{current:e.retention?.rate||0,growth:t(e.retention?.rate||0,e.retention?.previousRate||0),color:"purple"}}},[e]),x=t.useMemo(()=>{if(!e?.ordersByStatus)return[];const t={pending:"#FCD34D",processing:"#60A5FA",delivered:"#34D399",cancelled:"#F87171"};return Object.entries(e.ordersByStatus).map(([e,a])=>({status:e,count:a,color:t[e]}))},[e?.ordersByStatus]);return se("div",{className:"min-h-screen bg-neutral-950 p-4 space-y-6",dir:"rtl",children:[se("div",{className:"flex items-center justify-between mb-6",children:[le("h1",{className:"text-2xl font-bold text-white md:hidden",children:"التحليلات"}),se(ue,{onClick:b,disabled:r,variant:"outline",loading:r,children:[le(l,{className:"w-5 h-5"}),le("span",{className:"text-sm",children:"تحديث"})]})]}),a?le(ye,{}):g?le(Ne,{error:g,onRetry:b}):se("div",{className:"space-y-6",children:[se("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6",children:[le(be,{title:"إجمالي المبيعات",value:`${p.revenue.current?.toLocaleString("ar-EG")} ج.م`,icon:s,color:"success",trend:p.revenue.growth}),le(be,{title:"عدد الطلبات",value:p.orders.current,icon:n,color:"primary",trend:p.orders.growth}),le(be,{title:"متوسط قيمة الطلب",value:`${p.avgOrderValue.current?.toLocaleString("ar-EG")} ج.م`,icon:i,color:"warning",trend:p.avgOrderValue.growth}),le(be,{title:"معدل الاحتفاظ بالعملاء",value:`${p.customerRetention.current?.toFixed(1)}%`,icon:o,color:"neutral",trend:p.customerRetention.growth})]}),le(fe,{products:e.topProducts}),le("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:le(xe,{title:"توزيع حالات الطلبات",chart:le("div",{className:"flex items-center justify-center h-[250px] md:h-[300px] bg-gray-800/30 rounded-xl",children:le(d,{width:"100%",height:"100%",children:se(c,{children:[le(u,{data:x,dataKey:"count",nameKey:"status",cx:"50%",cy:"50%",outerRadius:window.innerWidth<768?80:100,innerRadius:window.innerWidth<768?50:60,paddingAngle:5,children:x.map((e,t)=>le(m,{fill:e.color},t))}),le(h,{content:le(ve,{})})]})})}),footer:le("div",{className:"grid grid-cols-2 gap-3 mt-4",children:x.map(({status:e,count:t,color:a})=>se("div",{className:"flex items-center gap-2",children:[le("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:a}}),le("span",{className:"text-xs md:text-sm text-gray-400 truncate",children:we(e)}),le("span",{className:"text-xs md:text-sm font-bold text-white ml-auto",children:t})]},e))})})})]})]})},xe=({title:e,chart:t,footer:a})=>se("div",{className:"bg-gray-800/50 backdrop-blur-xl rounded-2xl p-6 border border-gray-700/50 hover:border-gray-600/50 transition-all duration-300 hover:shadow-xl hover:shadow-black/20",children:[se("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[le("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),e]}),t,a]}),fe=({products:e})=>se(ce,{variant:"glass",padding:"lg",children:[se("h3",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-3",dir:"rtl",children:[le("div",{className:"w-2 h-2 rounded-full bg-success-400"}),"أفضل المنتجات مبيعاً"]}),le("div",{className:"space-y-3 md:space-y-4",children:e?.map((e,t)=>le(ce,{variant:"default",padding:"md",className:"hover:border-primary-500/30",children:se("div",{className:"flex items-center gap-3 md:gap-4",children:[le("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-gradient-to-br from-primary-500 to-primary-600 \r flex items-center justify-center flex-shrink-0",children:se("span",{className:"text-sm md:text-lg font-bold text-white",children:["#",t+1]})}),se("div",{className:"flex-1 min-w-0",dir:"rtl",children:[le("h4",{className:"font-bold text-white truncate mb-1 text-sm md:text-base",children:e.name}),se("div",{className:"flex justify-between items-center",children:[se("div",{className:"flex items-center gap-2",children:[le(n,{className:"w-3 h-3 md:w-4 md:h-4 text-neutral-400"}),se("span",{className:"text-xs md:text-sm text-neutral-400",children:[e.quantity," قطعة"]})]}),se("span",{className:"text-primary-400 font-bold text-sm md:text-base",children:[e.revenue.toLocaleString("ar-EG")," جنيه"]})]})]})]})},e.id))})]}),ve=({active:e,payload:t,label:a})=>e&&t?.length?se("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-3",children:[a&&le("p",{className:"text-gray-400 mb-2",children:a}),t.map((e,t)=>se("p",{className:"text-white",children:["number"==typeof e.value?e.value.toLocaleString("ar-EG"):e.value,"revenue"===e.name?" جنيه":""]},t))]}):null,ye=()=>le("div",{className:"flex items-center justify-center py-12",children:se("div",{className:"text-center space-y-4 p-6 rounded-2xl bg-gray-800/50 backdrop-blur-xl border border-gray-700/50",children:[se("div",{className:"relative",children:[le(g,{className:"w-12 h-12 text-blue-400 animate-spin mx-auto"}),le("div",{className:"absolute inset-0 rounded-full bg-blue-500/20 animate-ping"})]}),le("p",{className:"text-gray-300 font-medium",children:"جاري تحميل البيانات..."})]})}),Ne=({error:e,onRetry:t})=>le("div",{className:"text-center py-12",children:se("div",{className:"inline-block p-6 rounded-2xl bg-gray-800/50 backdrop-blur-xl border border-gray-700/50 max-w-md",children:[se("div",{className:"relative mb-4",children:[le(r,{className:"w-16 h-16 text-red-400 mx-auto"}),le("div",{className:"absolute inset-0 rounded-full bg-red-500/20 animate-pulse"})]}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"عذراً، حدث خطأ ما"}),le("p",{className:"text-gray-400 mb-6 leading-relaxed",children:e}),le("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl",children:"إعادة المحاولة"})]})}),we=e=>{switch(e){case"pending":return"معلق";case"processing":return"قيد التنفيذ";case"delivered":return"تم التسليم";case"cancelled":return"ملغي";default:return"غير معروف"}},Ce=({variant:e,variantIndex:t,onImageUpload:a,onImageRemove:l,isUploading:s,uploadProgress:n,error:i})=>{const o=n[t]||0;return se("div",{className:"space-y-2",children:[se("div",{className:"flex justify-between items-center",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الصور"}),s&&o>0&&se("span",{className:"text-sm text-blue-500",children:[Math.round(o),"% تم الرفع"]})]}),se("div",{className:"flex gap-4 overflow-x-auto hide-scrollbar pb-2",children:[e.images.map((a,r)=>se("div",{className:"relative flex-shrink-0 w-24 h-24 rounded-xl overflow-hidden group",children:[le("img",{src:a,alt:`${e.colorName} - ${r+1}`,className:"w-full h-full object-cover transition-transform \r group-hover:scale-105"}),le("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 \r to-transparent opacity-0 group-hover:opacity-100 \r transition-opacity"}),le("button",{type:"button",onClick:()=>l(t,r),className:"absolute top-1 right-1 p-1.5 bg-black/50 rounded-lg\r opacity-0 group-hover:opacity-100 transition-opacity\r hover:bg-red-500/20",children:le(b,{className:"w-4 h-4 text-white group-hover:text-red-500"})})]},r)),se("label",{className:"relative flex-shrink-0 w-24 h-24 flex items-center \n                    justify-center rounded-xl cursor-pointer group \n                    transition-all duration-300 border-2 border-dashed\n                    "+(s?"bg-blue-500/10 border-blue-500/30":"bg-gray-800/50 border-gray-700 hover:border-blue-500"),children:[le("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async e=>{const r=Array.from(e.target.files);if(r?.length){try{await a(t,r)}catch(l){}e.target.value=""}},disabled:s}),s&&o>0?le("div",{className:"absolute inset-0 flex items-center justify-center",children:le("svg",{className:"w-12 h-12",viewBox:"0 0 36 36",children:le("path",{d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${o}, 100`,className:"text-blue-500"})})}):le(p,{className:"w-6 h-6 transition-colors duration-300\n                      "+(s?"text-blue-500 animate-pulse":"text-gray-400 group-hover:text-blue-500")})]})]}),i&&se("div",{className:"flex items-center gap-2 text-sm text-red-500",children:[le(r,{className:"w-4 h-4"}),le("p",{children:i})]})]})},ke=[{label:"أسود",value:"black",code:"#000000"},{label:"أبيض",value:"white",code:"#FFFFFF"},{label:"أحمر",value:"red",code:"#FF0000"},{label:"أخضر",value:"green",code:"#008000"},{label:"أزرق",value:"blue",code:"#0000FF"},{label:"أصفر",value:"yellow",code:"#FFFF00"},{label:"برتقالي",value:"orange",code:"#FFA500"},{label:"بنفسجي",value:"purple",code:"#800080"},{label:"وردي",value:"pink",code:"#FFC0CB"},{label:"رمادي",value:"gray",code:"#808080"},{label:"بني",value:"brown",code:"#A52A2A"},{label:"ذهبي",value:"gold",code:"#FFD700"},{label:"فضي",value:"silver",code:"#C0C0C0"}],Se=()=>{const{products:e,filters:r,isLoading:l,isDeleting:s,error:n,deleteError:i,fetchProducts:o,createProduct:d,updateProduct:c,deleteProduct:u,uploadProductImages:m,updateFilters:h}=de(),[g,p]=t.useState("list"),[C,k]=t.useState(null),[S,P]=t.useState(!1),[j,E]=t.useState(!1),[$,D]=t.useState(!1),U=a.useMemo(()=>e?.length?e.reduce((e,t)=>(e.total++,"active"===t.status&&e.active++,t.variants.some(e=>e.sizes.every(e=>!e.inStock))&&e.outOfStock++,e.revenue+=t.salesCount*t.basePrice,e),{total:0,active:0,outOfStock:0,revenue:0}):{total:0,active:0,outOfStock:0,revenue:0},[e]),z=e=>{h({search:e})};return se("div",{className:"min-h-screen bg-neutral-950 pb-20",dir:"rtl",children:[se("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[le("h1",{className:"text-xl font-bold text-white",children:"المنتجات"}),le(ue,{onClick:()=>P(!0),variant:"primary",size:"sm",children:le(x,{className:"w-5 h-5"})})]}),se("div",{className:"p-4 md:p-6 grid grid-cols-2 gap-3 md:gap-6",children:[le(be,{title:"إجمالي المنتجات",value:U.total,icon:f,color:"primary"}),le(be,{title:"منتجات نشطة",value:U.active,icon:v,color:"success"})]}),se("div",{className:"sticky top-0 md:top-16 z-30 bg-neutral-950/95 backdrop-blur-xl p-4 md:p-6 \r space-y-4 md:space-y-6 border-b border-neutral-800/50 shadow-2xl shadow-black/20",children:[se("div",{className:"hidden md:flex items-center justify-between gap-4",children:[se(ue,{onClick:()=>P(!0),variant:"primary",children:[le(x,{className:"w-5 h-5"}),le("span",{children:"إضافة منتج"})]}),se("div",{className:"flex items-center gap-2",children:[le(ue,{onClick:()=>p("grid"),variant:"grid"===g?"primary":"secondary",size:"sm",children:le(y,{className:"w-5 h-5"})}),le(ue,{onClick:()=>p("list"),variant:"list"===g?"primary":"secondary",size:"sm",children:le(N,{className:"w-5 h-5"})})]})]}),se("div",{className:"relative",children:[le(me,{value:r.search,onChange:e=>z(e.target.value),placeholder:"ابحث عن منتج..."}),le(w,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400 pointer-events-none"}),r.search&&le("button",{onClick:()=>z(""),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r hover:bg-neutral-700/50 transition-colors",children:le(b,{className:"w-4 h-4 text-neutral-400"})})]}),le("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",children:Ie.map(e=>se(ue,{onClick:()=>(e=>{h({category:e})})(e.id),variant:r.category===e.id?"primary":"ghost",size:"sm",className:"whitespace-nowrap",children:[le(e.icon,{className:"w-4 h-4"}),le("span",{children:e.label})]},e.id))}),se("div",{className:"md:hidden flex items-center justify-between",children:[se("span",{className:"text-sm text-neutral-400",children:[e.length," منتج"]}),se("div",{className:"flex items-center gap-2",children:[le(ue,{onClick:()=>p("grid"),variant:"grid"===g?"primary":"secondary",size:"sm",children:le(y,{className:"w-5 h-5"})}),le(ue,{onClick:()=>p("list"),variant:"list"===g?"primary":"secondary",size:"sm",children:le(N,{className:"w-5 h-5"})})]})]})]}),le("div",{className:"p-4 "+("grid"===g?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4":"space-y-3 md:space-y-4"),children:l?le(Le,{}):n?le(Fe,{message:n}):0===e.length?le(Oe,{}):e.map(e=>le("grid"===g?Ue:je,{product:e,onEdit:()=>{k(e),E(!0)},onDelete:()=>{k(e),D(!0)}},e.id))}),S&&le(Pe,{onClose:()=>P(!1),onSubmit:async(e,t)=>{try{await d(e,t)&&(P(!1),await o())}catch(a){}},uploadImages:m,ediState:j}),j&&C&&le(Pe,{product:C,onClose:()=>{E(!1),k(null)},onSubmit:(e,t)=>(async(e,t,a)=>{try{await c(e,t,a)&&(E(!1),k(null),await o())}catch(r){}})(C.id,e,t),uploadImages:m,editeState:j}),$&&C&&le(ze,{product:C,onClose:()=>{D(!1),k(null)},onConfirm:()=>(async e=>{await u(e)&&(D(!1),k(null),await o())})(C.id),isDeleting:s,error:i})]})},Pe=({product:e,onClose:a,onSubmit:l,uploadImages:s,ediState:n=!0})=>{const[i,o]=t.useState({id:"",name:"",code:"",category:"",description:"",basePrice:"",discountPrice:"",status:"active",features:[],tag:"",tagColor:"",variants:[{id:"",product_id:"",colorName:"",colorCode:"#000000",images:[],sizes:[{size:"",quantity:0}]}],_imageFiles:{}}),[d,c]=t.useState({}),[u,m]=t.useState(!1),{handleFormImageUpload:h,clearImageFiles:g,uploadErrors:p,isUploading:f,uploadProgress:y}=(e=>{const[a,r]=t.useState({}),[l,s]=t.useState(!1),[n,i]=t.useState({});return{handleFormImageUpload:t.useCallback(async(t,a,l)=>{if(!l?.length)return a;s(!0),r({}),i(e=>({...e,[t]:0}));try{const r=a.variants[t].colorName;if(!r.trim())throw new Error("يجب إدخال اسم اللون قبل رفع الصور");if(!a.code)return{...a,_imageFiles:{...a._imageFiles,[t]:l}};const s=await e(a.code,r,l,e=>{i(a=>({...a,[t]:e}))});return{...a,variants:a.variants.map((e,a)=>a===t?{...e,images:[...e.images,...s]}:e)}}catch(n){throw r(e=>({...e,[t]:n.message})),n}finally{s(!1),i(e=>({...e,[t]:0}))}},[e]),clearImageFiles:t.useCallback(e=>{const{_imageFiles:t,...a}=e;return{cleanData:a,imageFiles:t||{}}},[]),uploadErrors:a,isUploading:l,uploadProgress:n,setUploadErrors:r,setUploadProgress:i}})(s);t.useEffect(()=>{e&&o({id:e.id||"",name:e.name,code:e.code,category:e.category,description:e.description||"",basePrice:e.basePrice.toString(),discountPrice:e.discountPrice?.toString()||"",status:e.status,tag:e.tag,_imageFiles:{},tagColor:e.tagColor,features:e.features,variants:e.variants.map(t=>({product_id:e.id,id:t.id,colorName:t.colorName,colorCode:t.colorCode,images:t.images,sizes:t.sizes.map(e=>({size:e.size,quantity:e.quantity}))}))})},[e]);const N=e=>{const{name:t,value:a}=e.target;o(e=>({...e,[t]:a})),c(e=>({...e,[t]:""}))},w=(e,t,a)=>{o(r=>({...r,variants:r.variants.map((r,l)=>l===e?{...r,[t]:a}:r)}))},C=(e,t,a,r)=>{o(l=>({...l,variants:l.variants.map((l,s)=>s===e?{...l,sizes:l.sizes.map((e,l)=>l===t?{...e,[a]:r}:e)}:l)}))},k=async(e,t)=>{try{const a=await h(e,i,t);o(a)}catch(a){}},S=(e,t)=>{o(a=>({...a,variants:a.variants.map((a,r)=>r===e?{...a,images:a.images.filter((e,a)=>a!==t)}:a)}))};return se("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4",children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),le("div",{className:"relative bg-neutral-900 rounded-xl md:rounded-2xl w-full max-w-full md:max-w-3xl \r h-full md:max-h-[95vh] overflow-y-auto hide-scrollbar border border-neutral-700/50 backdrop-blur-xl",children:se("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return i.name.trim()||(e.name="اسم المنتج مطلوب"),i.category||(e.category="الفئة مطلوبة"),i.basePrice||(e.basePrice="السعر الأساسي مطلوب"),isNaN(parseFloat(i.basePrice))&&(e.basePrice="السعر يجب أن يكون رقماً"),i.discountPrice&&isNaN(parseFloat(i.discountPrice))&&(e.discountPrice="سعر الخصم يجب أن يكون رقماً"),i.variants.forEach((t,a)=>{t.colorName||(e[`variant${a}Color`]="اللون مطلوب"),t.sizes.forEach((t,r)=>{t.size||(e[`variant${a}Size${r}`]="المقاس مطلوب"),isNaN(parseInt(t.quantity))&&(e[`variant${a}Quantity${r}`]="الكمية يجب أن تكون رقماً")})}),c(e),0===Object.keys(e).length})()){m(!0);try{const{cleanData:e,imageFiles:t}=g(i),r={...e,id:e.id,name:e.name,code:e.code,category:e.category,description:e.description||"",basePrice:e.basePrice.toString(),discountPrice:e.discountPrice?.toString()||"",status:e.status,tag:e.tag,imageFiles:e.imageFiles,tagColor:e.tagColor,...e.features?.length?{features:e.features}:{},variants:e.variants.map(t=>({id:t.id,product_id:e.id,colorName:t.colorName,colorCode:t.colorCode,images:t.images,sizes:t.sizes.map(e=>({size:e.size,quantity:parseInt(e.quantity)}))}))};await l(r,t),m(!1),a()}catch(t){c(e=>({...e,submit:t.message}))}finally{m(!1)}}},className:"space-y-4 md:space-y-6 p-4 md:p-6",children:[se("div",{className:"flex justify-between items-center sticky top-0 bg-neutral-900 py-2 -mx-4 md:-mx-6 px-4 md:px-6 border-b border-neutral-800/50",dir:"ltr",children:[le("button",{type:"button",onClick:a,className:"p-2 hover:bg-neutral-800/50 rounded-xl transition-colors",children:le(b,{className:"w-6 h-6 text-neutral-400"})}),le("h2",{className:"text-lg md:text-xl font-bold text-white",dir:"rtl",children:e?"تعديل منتج":"إضافة منتج"})]}),se("div",{className:"space-y-4",children:[le(Ee,{label:"اسم المنتج",name:"name",value:i.name,onChange:N,error:d.name}),le(De,{label:"الفئة",name:"category",value:i.category,onChange:N,error:d.category,options:[{value:"men",label:"رجالي"},{value:"women",label:"حريمي"},{value:"bags",label:"حقائب"}]}),le($e,{label:"الوصف",name:"description",value:i.description,onChange:N,error:d.description}),se("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[le(Ee,{label:"السعر الأساسي",name:"basePrice",type:"number",value:i.basePrice,onChange:N,error:d.basePrice}),le(Ee,{label:"سعر الخصم (اختياري)",name:"discountPrice",type:"number",value:i.discountPrice,onChange:N,error:d.discountPrice})]}),le(De,{label:"الحالة",name:"status",value:i.status,onChange:N,error:d.status,options:[{value:"active",label:"نشط"},{value:"inactive",label:"غير نشط"}]})]}),le("div",{children:se("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[le(Ee,{label:"العلامة (اختياري)",name:"tag",type:"text",value:i.tag,onChange:e=>o({...i,tag:e.target.value}),error:d.discountPrice}),le(De,{label:"لون العلامة",name:"tagColor",value:i.tagColor,onChange:e=>o({...i,tagColor:e.target.value}),error:d.status,options:[{label:"أزرق",value:"#3B82F6"},{label:"أخضر",value:"#10B981"},{label:"أحمر",value:"#EF4444"},{label:"أصفر",value:"#F59E0B"},{label:"بنفسجي",value:"#8B5CF6"},{label:"رمادي",value:"#64748B"},{label:"وردي",value:"#EC4899"},{label:"سماوي",value:"#0EA5E9"}]})]})}),se("div",{className:"space-y-4",children:[se("div",{className:"flex justify-between items-center",children:[le("h3",{className:"text-lg font-bold text-white",children:"المميزات (اختياري)"}),le("button",{type:"button",onClick:()=>o(e=>({...e,features:[...e.features,""]})),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r hover:bg-blue-500/20 transition-colors",children:le(x,{className:"w-5 h-5"})})]}),i.features?.map((e,t)=>se("div",{className:"flex gap-2",children:[le(Ee,{value:e,onChange:e=>((e,t)=>{o(a=>({...a,features:a.features.map((a,r)=>r===e?t:a)}))})(t,e.target.value),placeholder:"أدخل ميزة المنتج..."}),le("button",{type:"button",onClick:()=>(e=>o(t=>({...t,features:t.features.filter((t,a)=>a!==e)})))(t),className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r hover:bg-red-500/20 transition-colors",children:le(j,{className:"w-5 h-5"})})]},t))]}),se("div",{className:"space-y-6",children:[se("div",{className:"flex justify-between items-center",children:[le("h3",{className:"text-lg font-bold text-white",children:"الألوان والمقاسات"}),le("button",{type:"button",onClick:()=>o(e=>({...e,variants:[...e.variants,{id:"",product_id:"",colorName:"",colorCode:"#000000",images:[],sizes:[{size:"",quantity:0}]}]})),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r hover:bg-blue-500/20 transition-colors",children:le(x,{className:"w-5 h-5"})})]}),i.variants.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-4 space-y-4",children:[se("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4 pb-4",children:[se("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1",children:[le(De,{label:"اللون",value:e.colorName,onChange:e=>{const a=ke.find(t=>t.value===e.target.value);w(t,"colorName",e.target.value),w(t,"colorCode",a?.code||"#000000")},error:d[`variant${t}Color`],options:ke}),le(Ee,{label:"كود اللون",type:"color",value:e.colorCode,onChange:e=>w(t,"colorCode",e.target.value)})]}),i.variants.length>1&&le("button",{type:"button",onClick:()=>{return e=t,o(t=>({...t,variants:t.variants.filter((t,a)=>a!==e)}));var e},className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r hover:bg-red-500/20 transition-colors md:mr-4 self-start",children:le(j,{className:"w-5 h-5"})})]}),n&&le(Ce,{variant:e,variantIndex:t,onImageUpload:k,onImageRemove:S,isUploading:f,uploadProgress:y,error:p[t]}),se("div",{className:"space-y-4",children:[se("div",{className:"flex justify-between items-center",children:[le("h4",{className:"font-medium text-white",children:"المقاسات"}),le("button",{type:"button",onClick:()=>(e=>o(t=>({...t,variants:t.variants.map((t,a)=>a===e?{...t,sizes:[...t.sizes,{size:"",quantity:0}]}:t)})))(t),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r hover:bg-blue-500/20 transition-colors",children:le(x,{className:"w-5 h-5"})})]}),le("div",{className:"space-y-3",children:e.sizes.map((a,r)=>se("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[le("div",{className:"flex-1",children:le(Ee,{placeholder:"المقاس",value:a.size,onChange:e=>C(t,r,"size",e.target.value),error:d[`variant${t}Size${r}`]})}),le("div",{className:"flex-1",children:le(Ee,{type:"number",placeholder:"الكمية",value:a.quantity,onChange:e=>C(t,r,"quantity",e.target.value),error:d[`variant${t}Quantity${r}`]})}),e.sizes.length>1&&le("button",{type:"button",onClick:()=>((e,t)=>o(a=>({...a,variants:a.variants.map((a,r)=>r===e?{...a,sizes:a.sizes.filter((e,a)=>a!==t)}:a)})))(t,r),className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r hover:bg-red-500/20 transition-colors self-start",children:le(j,{className:"w-5 h-5"})})]},r))})]})]},t))]}),d.submit&&se("div",{className:"bg-red-500/10 text-red-500 p-4 rounded-xl flex items-center gap-2",children:[le(r,{className:"w-5 h-5"}),le("p",{children:d.submit})]}),se("div",{className:"sticky bottom-0 left-0 right-0 bg-neutral-900 border-t border-neutral-800/50 \r -mx-4 md:-mx-6 px-4 md:px-6 py-4 flex gap-3 md:gap-4",children:[le(ue,{type:"button",onClick:a,variant:"secondary",className:"flex-1 md:flex-none",children:"إلغاء"}),le(ue,{type:"submit",disabled:u||f,variant:"primary",loading:u,className:"flex-1 md:flex-none",children:u?le("span",{children:"جاري الحفظ..."}):se(ne,{children:[le(v,{className:"w-5 h-5"}),le("span",{children:"حفظ"})]})})]})]})})]})},je=({product:e,onEdit:t,onDelete:a})=>{e.variants[0]?.images[0];const r=e.variants.reduce((e,t)=>e+t.sizes.reduce((e,t)=>e+t.quantity,0),0),l=e.variants.length,s=e.variants.reduce((e,t)=>e+t.sizes.length,0);return se("div",{className:"group bg-gray-800/30 rounded-2xl p-4 \r border border-gray-700/50 hover:border-blue-500/30\r transition-all duration-300",dir:"ltr",children:[se("div",{className:"flex gap-4",dir:"rtl",children:[se("div",{className:"flex-1 min-w-0",children:[se("div",{className:"flex justify-between items-start gap-4",dir:"ltr",children:[le("div",{className:"px-2 py-1 rounded-full text-xs font-medium\n                         "+("active"===e.status?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"),children:"active"===e.status?"نشط":"غير نشط"}),se("div",{className:"text-right",children:[le("h3",{className:"font-bold text-white group-hover:text-blue-500 \r transition-colors",children:e.name}),se("p",{className:"text-sm text-gray-400",dir:"rtl",children:["كود: ",e.code]})]})]}),se("div",{className:"mt-2 flex flex-wrap items-center gap-x-6 gap-y-2",children:[se("div",{className:"flex items-center gap-2",children:[le(E,{className:"w-4 h-4 text-blue-500"}),se("span",{className:"text-blue-500 font-bold",children:[e.basePrice.toLocaleString("ar-EG")," جنيه"]}),e.discountPrice&&se("span",{className:"text-sm text-gray-500 line-through",children:[e.discountPrice.toLocaleString("ar-EG")," جنيه"]})]}),se("div",{className:"flex items-center gap-2",children:[le(n,{className:"w-4 h-4 text-gray-400"}),se("span",{className:"text-gray-400",children:["المخزون: ",r]})]}),se("div",{className:"flex items-center gap-2",children:[le("div",{className:"w-4 h-4 rounded-full border-2 border-amber-500",style:{backgroundColor:e.variants[0]?.colorCode}}),se("span",{className:"text-gray-400",children:[l," لون, ",s," مقاس"]})]})]}),e.features?.length>0&&se("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.features.slice(0,3).map((e,t)=>le("span",{className:"px-2 py-1 rounded-lg bg-gray-800 text-gray-400 \r text-sm",children:e},t)),e.features.length>3&&se("span",{className:"px-2 py-1 rounded-lg bg-gray-800 text-gray-400 \r text-sm",children:["+",e.features.length-3]})]})]}),se("div",{className:"flex flex-col gap-2",children:[le("button",{onClick:t,className:"p-2 rounded-xl bg-blue-500/10 text-blue-500\r hover:bg-blue-500/20 transition-colors",children:le(P,{className:"w-5 h-5"})}),le("button",{onClick:a,className:"p-2 rounded-xl bg-red-500/10 text-red-500\r hover:bg-red-500/20 transition-colors",children:le(j,{className:"w-5 h-5"})})]})]}),le("div",{className:"mt-4 pt-4 border-t border-gray-700/50",children:le("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar pb-2",children:e.variants.map((e,t)=>se("div",{className:"flex-shrink-0 group/variant cursor-pointer",children:[se("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:[le("img",{src:e.images[0],alt:e.colorName,className:"w-full h-full object-cover transform transition-transform\r duration-500 group-hover/variant:scale-110"}),le("div",{className:"absolute inset-0 bg-gradient-to-t \r from-black/50 to-transparent"}),le("div",{className:"absolute bottom-1 right-1 w-3 h-3 rounded-full",style:{backgroundColor:e.colorCode}})]}),se("div",{className:"mt-1 text-center",children:[le("p",{className:"text-sm text-gray-400",children:e.colorName}),se("p",{className:"text-xs text-gray-500",children:[e.sizes.length," مقاس"]})]})]},t))})})]})},Ee=a.forwardRef(({label:e,error:t,type:a="text",className:r="",...l},s)=>le(me,{ref:s,label:e,error:t,type:a,className:r,...l}));Ee.displayName="Input";const $e=({label:e,error:t,className:a="",...r})=>le(ge,{label:e,error:t,className:a,...r}),De=({label:e,error:t,options:a=[],className:r="",...l})=>le(he,{label:e,error:t,options:a,className:r,...l}),Ue=({product:e,onEdit:t,onDelete:a})=>{const r=e.variants[0]?.images[0],l=e.variants.reduce((e,t)=>e+t.sizes.reduce((e,t)=>e+t.quantity,0),0);return se(ce,{variant:"default",padding:"md",className:"border-neutral-700/50 hover:border-primary-500/30 group space-y-3 md:space-y-4",children:[se("div",{className:"relative aspect-square rounded-lg md:rounded-xl overflow-hidden",children:[le("img",{src:r,alt:e.name,className:"w-full h-full object-cover transform transition-transform\r duration-500 group-hover:scale-110"}),le("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),le("div",{className:"absolute top-1 md:top-2 right-1 md:right-2",children:le("span",{className:"px-2 py-1 rounded-full text-xs font-medium\n                        "+("active"===e.status?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"),children:"active"===e.status?"نشط":"غير نشط"})}),se("div",{className:"absolute bottom-1 md:bottom-2 left-1 md:left-2 flex gap-1 md:gap-2 \r opacity-0 group-hover:opacity-100 transition-opacity",children:[le("button",{onClick:t,className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-blue-500/20 text-blue-500\r hover:bg-blue-500/30 transition-colors",children:le(P,{className:"w-4 h-4 md:w-5 md:h-5"})}),le("button",{onClick:a,className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-red-500/20 text-red-500\r hover:bg-red-500/30 transition-colors",children:le(j,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),se("div",{className:"space-y-2",children:[le("h3",{className:"font-bold text-white text-sm md:text-base truncate",children:e.name}),se("div",{className:"flex items-center justify-between",children:[se("span",{className:"text-xs md:text-sm text-neutral-400",children:["المخزون: ",l]}),se("span",{className:"text-primary-500 font-bold text-sm md:text-base",children:[e.basePrice.toLocaleString("ar-EG")," جنيه"]})]})]})]})},ze=({product:e,onClose:t,onConfirm:a})=>se("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),le(ce,{variant:"elevated",padding:"lg",className:"w-full max-w-md space-y-4",children:se("div",{className:"text-center space-y-4",children:[le("div",{className:"w-16 h-16 mx-auto rounded-full bg-danger-500/10 flex items-center justify-center",children:le(r,{className:"w-8 h-8 text-danger-500"})}),le("h2",{className:"text-xl font-bold text-white",dir:"rtl",children:"تأكيد الحذف"}),se("p",{className:"text-neutral-400",dir:"rtl",children:['هل أنت متأكد من حذف المنتج "',e.name,'"؟',le("br",{}),"لا يمكن التراجع عن هذا الإجراء."]}),se("div",{className:"flex gap-4 pt-2",children:[le(ue,{onClick:t,variant:"secondary",className:"flex-1",children:"إلغاء"}),le(ue,{onClick:a,variant:"danger",className:"flex-1",children:"حذف"})]})]})})]}),Le=()=>le("div",{className:"col-span-full flex items-center justify-center py-12",children:se("div",{className:"space-y-4 text-center",children:[le("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 \r border-t-transparent rounded-full mx-auto"}),le("p",{className:"text-gray-400",children:"جاري تحميل المنتجات..."})]})}),Fe=({message:e})=>se("div",{className:"col-span-full text-center py-12",children:[le(r,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),le("p",{className:"text-gray-400",children:e})]}),Oe=()=>se("div",{className:"col-span-full text-center py-12",children:[le(S,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد منتجات"}),le("p",{className:"text-gray-400",children:"لم يتم العثور على منتجات تطابق معايير البحث"})]}),Ie=[{id:"all",label:"الكل",icon:f},{id:"men",label:"رجالي",icon:C},{id:"women",label:"حريمي",icon:k}],Re=()=>{const{orders:e,selectedOrder:a,page:r,totalPages:l,filters:i,isLoading:o,error:d,setSelectedOrder:c,updateFilters:u,updateOrderStatus:m,nextPage:h,previousPage:g}=(()=>{const[e,a]=t.useState([]),[r,l]=t.useState(0),[s,n]=t.useState(null),[i,o]=t.useState(1),[d,c]=t.useState(0),[u,m]=t.useState(20),[h,g]=t.useState({status:"all",startDate:null,endDate:null,search:""}),[b,p]=t.useState(!1),[x,f]=t.useState(!1),[v,y]=t.useState(null),[N,w]=t.useState(null),{apiCall:C}=oe(),k=t.useRef([]),S=t.useCallback(async(e=i,t=h)=>{p(!0),y(null);try{const r=new URLSearchParams({page:e,perPage:u,...t,...t.startDate&&{startDate:t.startDate.toISOString()},...t.endDate&&{endDate:t.endDate.toISOString()}}).toString(),s=await C(`/admin/orders?${r}`);return s?.orders&&(a(s.orders),l(s.total),c(s.pages),k.current=s.orders),s}catch(r){return y(r.message),null}finally{p(!1)}},[C,i,u,h]),P=t.useCallback(async(t,r)=>{f(!0),w(null);const l=[...e];try{a(e.map(e=>e.id===t?{...e,status:r}:e));const s=await C(`/admin/orders/${t}/status`,{method:"PUT",body:JSON.stringify({status:r})});if(!s)throw a(l),new Error("Failed to update order status");return await S(),s}catch(s){return w(s.message),a(l),null}finally{f(!1)}},[C,e,S]),j=t.useCallback(e=>{g(t=>({...t,...e})),o(1)},[]),E=t.useCallback(()=>{i<d&&o(e=>e+1)},[i,d]),$=t.useCallback(()=>{i>1&&o(e=>e-1)},[i]);return t.useEffect(()=>{S()},[i,h,S]),{orders:e,totalOrders:r,selectedOrder:s,page:i,totalPages:d,perPage:u,filters:h,isLoading:b,isUpdatingStatus:x,error:v,updateStatusError:N,setSelectedOrder:n,setPage:o,setPerPage:m,updateFilters:j,loadOrders:S,updateOrderStatus:P,nextPage:E,previousPage:$}})(),[b,p]=t.useState(!1),x=t.useMemo(()=>{if(!e.length)return null;const t=e.reduce((e,t)=>e+t.total,0),a=e.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),r=t/e.length;return{totalRevenue:t,totalOrders:e.length,pendingOrders:a.pending||0,processingOrders:a.processing||0,avgOrderValue:r}},[e]);return se("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[se("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[le("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"الطلبات"}),se("span",{className:"text-sm text-neutral-400",children:[x?.totalOrders||0," طلب"]})]}),se("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[le(Te,{title:"إجمالي المبيعات",value:(x?.totalRevenue?.toLocaleString("ar-EG")||0)+" جنيه",icon:s,color:"emerald"}),le(Te,{title:"عدد الطلبات",value:x?.totalOrders||0,icon:n,color:"blue"}),le(Te,{title:"متوسط قيمة الطلب",value:(x?.avgOrderValue?.toLocaleString("ar-EG")||0)+" جنيه",icon:$,color:"amber"}),le(Te,{title:"طلبات معلقة",value:x?.pendingOrders||0,icon:D,color:"red"})]}),se("div",{className:"sticky top-0 md:top-16 z-30 bg-neutral-950/95 backdrop-blur-xl p-4 space-y-4 \r border-b border-neutral-800/50",children:[le(Ae,{value:i.search,onChange:e=>u({search:e})}),le(Ge,{activeStatus:i.status,onStatusChange:e=>u({status:e})})]}),le("div",{className:"p-4 space-y-3 md:space-y-4",children:o?le(Ve,{}):d?le(Je,{message:d}):0===e.length?le(We,{}):e.map(e=>le(Be,{order:e,onClick:()=>{c(e),p(!0)}},e.id))}),a&&le(qe,{order:a,isOpen:b,onClose:()=>{p(!1),c(null)},onUpdateStatus:m}),l>1&&le(Ke,{page:r,totalPages:l,onNext:h,onPrevious:g})]})},Te=({title:e,value:t,icon:a,color:r})=>{const l={emerald:{bg:"bg-emerald-500/10",text:"text-emerald-500",border:"border-emerald-500/20"},blue:{bg:"bg-blue-500/10",text:"text-blue-500",border:"border-blue-500/20"},amber:{bg:"bg-amber-500/10",text:"text-amber-500",border:"border-amber-500/20"},red:{bg:"bg-red-500/10",text:"text-red-500",border:"border-red-500/20"}}[r];return se("div",{className:`relative overflow-hidden rounded-xl md:rounded-2xl p-3 md:p-4 \n                        ${l.bg} border ${l.border}`,dir:"rtl",children:[le("div",{className:"absolute top-2 md:top-4 left-2 md:left-4",children:le(a,{className:`w-5 h-5 md:w-6 md:h-6 ${l.text}`})}),se("div",{className:"mt-5 md:mt-6",children:[le("h3",{className:"text-xs md:text-sm font-medium text-gray-400 leading-tight",children:e}),le("div",{className:"mt-1 md:mt-2",children:le("span",{className:`text-lg md:text-2xl font-bold ${l.text}`,children:t})})]})]})},Ae=({value:e,onChange:t})=>se("div",{className:"relative",children:[le("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"ابحث برقم الطلب أو رقم الهاتف...",className:"w-full h-12 bg-gray-800/50 rounded-xl px-12 text-white text-right\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50\r placeholder:text-gray-500",dir:"rtl"}),le(w,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e&&le("button",{onClick:()=>t(""),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r hover:bg-gray-700/50 transition-colors",children:le(b,{className:"w-4 h-4 text-gray-400"})})]}),Ge=({activeStatus:e,onStatusChange:t})=>le("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",dir:"rtl",children:[{id:"all",label:"الكل",icon:n},{id:"pending",label:"معلق",icon:D},{id:"processing",label:"قيد التنفيذ",icon:l},{id:"delivered",label:"تم التسليم",icon:U},{id:"cancelled",label:"ملغي",icon:z}].map(({id:a,label:r,icon:l})=>se("button",{onClick:()=>t(a),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm\n                     whitespace-nowrap transition-colors\n                     "+(e===a?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[le(l,{className:"w-4 h-4"}),le("span",{children:r})]},a))}),Be=({order:e,onClick:t})=>{const a={pending:{icon:D,color:"text-yellow-500",bgColor:"bg-yellow-500/10",label:"معلق"},processing:{icon:l,color:"text-blue-500",bgColor:"bg-blue-500/10",label:"قيد التنفيذ"},delivered:{icon:U,color:"text-green-500",bgColor:"bg-green-500/10",label:"تم التسليم"},cancelled:{icon:z,color:"text-red-500",bgColor:"bg-red-500/10",label:"ملغي"}}[e.status]||{icon:n,color:"text-gray-500",bgColor:"bg-gray-500/10",label:"غير معروف"},r=a.icon,s=e.userPhone||e.user?.phone_number,i=e.userName||e.user?.name,o=e.total||0,d=e.createdAt||e.created_at;return se("div",{onClick:t,className:"group bg-gray-800/30 rounded-xl md:rounded-2xl p-3 md:p-4 space-y-3 md:space-y-4 cursor-pointer\r border border-gray-700/50 hover:border-blue-500/30\r transition-all duration-300 relative overflow-hidden",children:[le("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800/0 to-gray-800/50 opacity-0 \r group-hover:opacity-100 transition-opacity duration-500"}),se("div",{className:"relative",children:[se("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-3 md:gap-4",children:[se("div",{className:`flex items-center gap-2 px-2 md:px-3 py-1.5 rounded-full self-start\n                          ${a.color} ${a.bgColor} border border-transparent\n                          transition-all duration-300 group-hover:border-current/20`,children:[le(r,{className:"w-3 h-3 md:w-4 md:h-4 "+("processing"===e.status?"group-hover:animate-spin":"")}),le("span",{className:"text-xs md:text-sm font-medium",children:a.label})]}),se("div",{className:"text-right flex-1 min-w-0",children:[i&&le("h3",{className:"font-bold text-white text-sm md:text-base truncate group-hover:text-blue-500\r transition-colors duration-300",children:i}),s&&le("p",{className:"text-xs md:text-sm text-gray-400 mt-0.5",dir:"ltr",children:s}),d&&le("p",{className:"text-xs text-gray-500 mt-1",children:new Date(d).toLocaleString("ar-EG",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})})]})]}),se("div",{className:"flex items-center justify-between pt-3 md:pt-4 border-t border-gray-700/50 mt-3 md:mt-4",children:[le("div",{className:"flex gap-1 md:gap-2",children:s&&se(ne,{children:[le("button",{onClick:e=>{e.stopPropagation(),s&&window.open(`https://wa.me/${s}`,"_blank")},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-green-500/10\r border border-transparent hover:border-green-500/30\r transition-all duration-300 group/btn",title:"واتساب",children:le(L,{className:"w-4 h-4 md:w-5 md:h-5 text-green-500 transition-transform duration-300\r group-hover/btn:scale-110"})}),le("button",{onClick:e=>{e.stopPropagation(),s&&window.open(`tel:${s}`,"_blank")},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300 group/btn",title:"اتصال",children:le(F,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500 transition-transform duration-300\r group-hover/btn:scale-110"})}),le("button",{onClick:async e=>{if(e.stopPropagation(),s)try{await navigator.clipboard.writeText(s)}catch(t){}},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300 group/btn",title:"نسخ رقم الهاتف",children:le(O,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500 transition-transform duration-300\r group-hover/btn:scale-110"})})]})}),se("div",{className:"flex items-center gap-2",children:[se("div",{className:"text-right",children:[se("span",{className:"block font-bold text-blue-500 text-sm md:text-lg",children:[o.toLocaleString("ar-EG")," جنيه"]}),e.items?.length>0&&se("span",{className:"text-xs text-gray-400",children:[e.items.length," منتج"]})]}),le(n,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 group-hover:text-blue-500\r transition-colors duration-300"})]})]})]})]})},qe=({order:e,isOpen:t,onClose:a,onUpdateStatus:r})=>{if(!e)return null;const s=e.userPhone||e.user?.phone_number,n=e.items||[],i=e.total||0,o=e.subtotal||0,d=e.tracking||[];return se("div",{className:"fixed inset-0 z-50 transition-opacity duration-300\n                      "+(t?"opacity-100":"opacity-0 pointer-events-none"),children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),le("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500 \n                        "+(t?"translate-y-0":"translate-y-full"),children:le("div",{className:"bg-gradient-to-b from-neutral-950/95 to-neutral-950 backdrop-blur-xl\r rounded-t-[2.5rem] border-t border-neutral-800/50 shadow-2xl\r max-h-[90vh] overflow-y-auto hide-scrollbar",children:se("div",{className:"px-4 md:px-6 py-6 md:py-8 space-y-4 md:space-y-6",children:[se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-neutral-850/50 transition-colors",children:le(I,{className:"w-6 h-6 text-neutral-400"})}),le("div",{className:"text-center flex-1",children:se("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm\r bg-neutral-850/50",children:[le(_e,{status:e.status,className:"w-4 h-4"}),le("span",{children:Me(e.status)})]})}),le("button",{onClick:async()=>{const t=`\n  طلب من: ${s}\n  المنتجات:\n  ${n.map(e=>`• ${e.productName||e.name}\n     ${e.quantity}× - المقاس: ${e.size} - اللون: ${e.variant}\n     السعر: ${(e.price*e.quantity).toLocaleString("ar-EG")} جنيه`).join("\n")}\n  \n  الإجمالي: ${i.toLocaleString("ar-EG")} جنيه\n  التاريخ: ${new Date(e.createdAt).toLocaleString("ar-EG")}`.trim();try{navigator.share?await navigator.share({text:t}):await navigator.clipboard.writeText(t)}catch(a){a.name}},className:"p-2 -m-2 rounded-full hover:bg-neutral-850/50 transition-colors",children:le(R,{className:"w-6 h-6 text-neutral-400"})})]}),se("div",{className:"bg-neutral-850/30 rounded-xl md:rounded-2xl p-3 md:p-4 border border-neutral-700/30",children:[se("div",{className:"flex items-center justify-between",children:[le("h4",{className:"text-base md:text-lg font-bold text-white",children:"معلومات العميل"}),le("span",{className:"text-xs md:text-sm text-gray-400",dir:"ltr",children:s})]}),se("div",{className:"flex gap-2 mt-3 md:mt-4",children:[se("button",{onClick:()=>window.open(`https://wa.me/${s}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-2.5 md:p-3 rounded-lg md:rounded-xl\r bg-gray-800/50 hover:bg-green-500/10 border border-transparent\r hover:border-green-500/30 transition-all duration-300",children:[le(L,{className:"w-4 h-4 md:w-5 md:h-5 text-green-500"}),le("span",{className:"text-xs md:text-sm text-gray-400",children:"واتساب"})]}),se("button",{onClick:()=>window.open(`tel:${s}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-2.5 md:p-3 rounded-lg md:rounded-xl\r bg-gray-800/50 hover:bg-blue-500/10 border border-transparent\r hover:border-blue-500/30 transition-all duration-300",children:[le(F,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500"}),le("span",{className:"text-xs md:text-sm text-gray-400",children:"اتصال"})]})]})]}),se("div",{className:"space-y-4",children:[se("div",{className:"flex items-center justify-between",dir:"rtl",children:[le("h4",{className:"text-lg font-bold text-white",children:"المنتجات"}),se("span",{className:"text-sm text-gray-400",children:[n.length," منتج"]})]}),le("div",{className:"space-y-3",children:n.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-3 flex gap-3",children:[se("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden hide-scrollbar group",children:[le("img",{src:e.image,alt:e.productName,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"}),le("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),se("span",{className:"absolute bottom-1 right-1 text-xs bg-black/50 text-white\r px-1.5 py-0.5 rounded-full",children:[e.quantity,"×"]})]}),se("div",{className:"flex-1 min-w-0",children:[se("div",{className:"flex justify-between items-start gap-2",children:[se("span",{className:"text-blue-500 font-bold whitespace-nowrap",children:[(e.price*e.quantity).toLocaleString("ar-EG")," جنيه"]}),le("h4",{className:"font-medium text-white text-right truncate",children:e.productName||e.name})]}),se("div",{className:"mt-1 flex justify-end items-center gap-3",children:[se("span",{className:"text-sm text-gray-400",children:["المقاس: ",e.size]}),se("span",{className:"text-sm text-gray-400",children:["اللون: ",e.variant]})]})]})]},t))})]}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-3",children:[se("div",{className:"flex justify-between items-center",children:[se("span",{className:"text-blue-500 font-bold",children:[o.toLocaleString("ar-EG")," جنيه"]}),le("span",{className:"text-gray-400",children:"المجموع"})]}),0!=e.shipping&&se("div",{className:"flex justify-between items-center",children:[se("span",{className:"text-green-500 font-bold",children:[e.shipping.toLocaleString("ar-EG")," جنيه"]}),le("span",{className:"text-gray-400",children:"الشحن"})]}),le("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),se("div",{className:"flex justify-between items-center",children:[se("span",{className:"text-xl font-bold text-white",children:[i.toLocaleString("ar-EG")," جنيه"]}),le("span",{className:"text-lg font-bold text-white",children:"الإجمالي"})]})]}),d.length>0&&se("div",{className:"space-y-4",children:[le("h4",{className:"text-lg font-bold text-white",dir:"rtl",children:"تتبع الطلب"}),le("div",{className:"relative space-y-4",children:d.map((e,t)=>se("div",{className:"flex items-start gap-4",children:[t!==d.length-1&&le("div",{className:"absolute top-8 bottom-0 left-4 w-px \r bg-gradient-to-b from-gray-700 to-transparent"}),le("div",{className:"relative z-10 w-8 h-8 rounded-full flex items-center justify-center\n                                      "+(e.completed?"bg-blue-500":"bg-gray-700"),children:le(_e,{status:e.status,className:"w-4 h-4 text-white"})}),se("div",{className:"flex-1",children:[se("div",{className:"flex justify-between items-center",children:[le("span",{className:"text-sm text-gray-400",children:new Date(e.timestamp).toLocaleString("ar-EG")}),le("span",{className:"font-medium text-white",children:Me(e.status)})]}),e.description&&le("p",{className:"text-sm text-gray-500 mt-1",children:e.description})]})]},t))})]}),le("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[{status:"pending",label:"تعليق",icon:D,color:"yellow"},{status:"processing",label:"معالجة",icon:l,color:"blue"},{status:"delivered",label:"تسليم",icon:U,color:"green"},{status:"cancelled",label:"إلغاء",icon:z,color:"red"}].map(({status:t,label:a,icon:l,color:s})=>{const n={yellow:{text:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/30"},blue:{text:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"},green:{text:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/30"},red:{text:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"}}[s];return se("button",{onClick:()=>r(e.id,t),disabled:e.status===t,className:"flex items-center justify-center gap-1.5 md:gap-2 p-2.5 md:p-3 \n                                               rounded-lg md:rounded-xl font-medium transition-all duration-300 group\n                                               "+(e.status===t?"bg-gray-800/50 text-gray-500 cursor-not-allowed":`bg-gray-800/30 hover:${n.bg} \n                                                  border border-transparent hover:${n.border}`),children:[le(l,{className:"w-4 h-4 md:w-5 md:h-5 "+(e.status===t?"text-gray-500":`${n.text} \n                                              ${"processing"===t?"group-hover:animate-spin":""}`)}),le("span",{className:"text-xs md:text-sm "+(e.status===t?"text-gray-500":`text-gray-400 group-hover:${n.text}`),children:a})]},t)})})]})})})]})},_e=({status:e})=>le({pending:D,processing:l,delivered:U,cancelled:z}[e]||n,{className:"w-5 h-5"}),Me=e=>({pending:"معلق",processing:"قيد التنفيذ",delivered:"تم التسليم",cancelled:"ملغي"}[e]||"غير معروف"),Ve=()=>le("div",{className:"flex items-center justify-center py-12",children:le("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 \r border-t-transparent rounded-full"})}),Je=({message:e})=>se("div",{className:"text-center py-12",children:[le(r,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),le("p",{className:"text-gray-400",children:e})]}),We=()=>se("div",{className:"text-center py-12",children:[le(n,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد طلبات"}),le("p",{className:"text-gray-400",children:"لم يتم العثور على طلبات تطابق معايير البحث"})]}),Ke=({page:e,totalPages:t,onNext:a,onPrevious:r})=>le("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r border-t border-gray-800/50 p-4",children:se("div",{className:"flex justify-between items-center max-w-lg mx-auto",children:[le("button",{onClick:r,disabled:e<=1,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed\r hover:bg-gray-700/50 transition-colors",children:"السابق"}),se("span",{className:"text-gray-400",children:["صفحة ",e," من ",t]}),le("button",{onClick:a,disabled:e>=t,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed\r hover:bg-gray-700/50 transition-colors",children:"التالي"})]})}),Qe=()=>{const{customers:e,totalCustomers:a,selectedCustomer:r,page:l,totalPages:i,search:g,isLoading:b,setSelectedCustomer:p,setSearch:x,nextPage:f,previousPage:v}=(()=>{const[e,a]=t.useState([]),[r,l]=t.useState(0),[s,n]=t.useState(null),[i,o]=t.useState(1),[d,c]=t.useState(0),[u,m]=t.useState(20),[h,g]=t.useState(""),[b,p]=t.useState(""),[x,f]=t.useState(!1),[v,y]=t.useState(!1),[N,w]=t.useState(null),[C,k]=t.useState(null),{apiCall:S}=oe(),P=t.useRef(null);t.useEffect(()=>(P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{p(h),o(1)},300),()=>{P.current&&clearTimeout(P.current)}),[h]);const j=t.useCallback(async(e=i,t=b)=>{f(!0),w(null);try{const r=new URLSearchParams({page:e,perPage:u,search:t}).toString(),s=await S(`/admin/customers?${r}`);return s?.customers&&(a(s.customers),l(s.total),c(s.pages)),s}catch(r){return w(r.message),null}finally{f(!1)}},[S,i,u,b]),E=t.useCallback(async e=>{y(!0),k(null);try{const t=await S(`/admin/customers/${e}`);return t&&n(t),t}catch(t){return k(t.message),null}finally{y(!1)}},[S]),$=t.useCallback(()=>{i<d&&o(e=>e+1)},[i,d]),D=t.useCallback(()=>{i>1&&o(e=>e-1)},[i]);return t.useEffect(()=>{j()},[i,b,j]),{customers:e,totalCustomers:r,selectedCustomer:s,page:i,totalPages:d,perPage:u,search:h,isLoading:x,isLoadingDetails:v,error:N,detailsError:C,setSelectedCustomer:n,setPage:o,setPerPage:m,setSearch:g,loadCustomers:j,loadCustomerDetails:E,nextPage:$,previousPage:D}})(),[y,N]=t.useState(!1),[C,k]=t.useState({spendingRange:[],orderCount:[],location:[],dateRange:[]});C.spendingRange;const S=t.useMemo(()=>{if(!e.length)return null;const t={low:{min:0,max:1e3,count:0,total:0},medium:{min:1001,max:5e3,count:0,total:0},high:{min:5001,max:1/0,count:0,total:0}},a={},r={new:{min:0,max:1,count:0},regular:{min:2,max:5,count:0},loyal:{min:6,max:1/0,count:0}},l={};return e.forEach(e=>{const s=e.totalSpent||0;if(s<=t.low.max?(t.low.count++,t.low.total+=s):s<=t.medium.max?(t.medium.count++,t.medium.total+=s):(t.high.count++,t.high.total+=s),e.addresses?.[0]?.governorate){const t=e.addresses[0].governorate;a[t]=(a[t]||0)+1}const n=e.orderCount||0;n<=r.new.max?r.new.count++:n<=r.regular.max?r.regular.count++:r.loyal.count++;const i=Math.floor((new Date-new Date(e.createdAt))/2592e6),o=3*Math.floor(i/3);l[o]=(l[o]||0)+1}),{spendingRanges:t,locationData:Object.entries(a).map(([e,t])=>({name:e,value:t})),orderFrequency:r,customerAges:Object.entries(l).map(([e,t])=>({months:`${e}-${parseInt(e)+3} شهور`,count:t})).sort((e,t)=>parseInt(e.months)-parseInt(t.months))}},[e]),P=t.useMemo(()=>e.length?e.filter(e=>{const t=0===C.spendingRange.length||C.spendingRange.some(t=>{switch(t){case"low":return e.totalSpent<=1e3;case"medium":return e.totalSpent>1e3&&e.totalSpent<=5e3;case"high":return e.totalSpent>5e3;default:return!0}}),a=0===C.orderCount.length||C.orderCount.some(t=>{switch(t){case"new":return e.orderCount<=1;case"regular":return e.orderCount>1&&e.orderCount<=5;case"loyal":return e.orderCount>5;default:return!0}}),r=0===C.location.length||C.location.includes(e.addresses?.[0]?.governorate),l=0===C.dateRange.length||C.dateRange.some(t=>"recent"!==t||(new Date-new Date(e.createdAt))/864e5<=30);return t&&a&&r&&l}):[],[e,C]);return se("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[se("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[le("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"العملاء"}),se("span",{className:"text-sm text-neutral-400",children:[a," عميل"]})]}),se("div",{className:"p-4 space-y-6 pt-0",children:[se("div",{className:"grid grid-cols-2 gap-4",children:[le(be,{title:"إجمالي العملاء",value:a,icon:o,color:"primary"}),le(be,{title:"عملاء جدد",value:S?.orderFrequency.new.count||0,subtitle:"آخر 30 يوم",icon:o,color:"success"})]}),S&&se("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[se("div",{className:"bg-gray-800/30 rounded-2xl p-4 border border-gray-700/50",children:[le("h3",{className:"text-lg font-bold text-white mb-4",children:"تصنيف العملاء"}),le("div",{className:"h-64",children:le(d,{width:"100%",height:"100%",children:se(c,{children:[se(u,{data:[{name:"عملاء جدد",value:S.orderFrequency.new.count},{name:"عملاء منتظمون",value:S.orderFrequency.regular.count},{name:"عملاء مخلصون",value:S.orderFrequency.loyal.count}],cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",children:[le(m,{fill:"#10B981"}),le(m,{fill:"#3B82F6"}),le(m,{fill:"#F59E0B"})]}),le(h,{})]})})})]}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4 border border-gray-700/50",children:[le("h3",{className:"text-lg font-bold text-white mb-4",children:"التوزيع الجغرافي"}),le("div",{className:"h-64",children:le(d,{width:"100%",height:"100%",children:se(T,{data:S.locationData,children:[le(A,{dataKey:"name"}),le(G,{}),le(h,{}),le(B,{dataKey:"value",fill:"#3B82F6"})]})})})]})]})]}),se("div",{className:"sticky top-0 z-30 bg-neutral-950/95 backdrop-blur-sm p-4 space-y-4 border-b border-neutral-800/50",children:[se("div",{className:"relative",children:[le(me,{type:"text",value:g,onChange:e=>x(e.target.value),placeholder:"ابحث برقم الهاتف أو العنوان...",className:"pr-12"}),le(w,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),se("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar",children:[le(He,{label:"مستوى الإنفاق",options:[{value:"low",label:"منخفض (≤ 1000)"},{value:"medium",label:"(1000-5000)"},{value:"high",label:"مرتفع (> 5000)"}],values:C.spendingRange,onChange:e=>k(t=>({...t,spendingRange:e})),icon:s}),le(He,{label:"عدد الطلبات",options:[{value:"new",label:"جديد (≤ 1)"},{value:"regular",label:"منتظم (2-5)"},{value:"loyal",label:"مخلص (> 5)"}],values:C.orderCount,onChange:e=>k(t=>({...t,orderCount:e})),icon:n}),S&&le(He,{label:"المنطقة",options:[...S.locationData.map(e=>({value:e.name,label:e.name}))],values:C.location,onChange:e=>k(t=>({...t,location:e})),icon:q}),le(He,{label:"تاريخ التسجيل",options:[{value:"recent",label:"آخر 30 يوم"}],values:C.dateRange,onChange:e=>k(t=>({...t,dateRange:e})),icon:_})]})]}),le("div",{className:"p-4 space-y-4",dir:"rtl",children:b?le(tt,{}):0===P.length?le(at,{}):P.map(e=>le(Xe,{customer:e,onClick:()=>{p(e),N(!0)}},e.id))}),r&&le(Ze,{customer:r,isOpen:y,onClose:()=>{N(!1),p(null)},analytics:S}),i>1&&le(et,{page:l,totalPages:i,onNext:f,onPrevious:v})]})},Ye=({title:e,value:t,icon:a,trend:r,subtitle:l,color:s="emerald"})=>se("div",{className:`relative overflow-hidden rounded-2xl border p-4 ${{emerald:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20",blue:"bg-blue-500/10 text-blue-500 border-blue-500/20",amber:"bg-amber-500/10 text-amber-500 border-amber-500/20"}[s]}`,dir:"rtl",children:[le("div",{className:"absolute top-4 left-4",children:le(a,{className:"w-6 h-6"})}),se("div",{className:"mt-6",children:[le("h3",{className:"text-sm font-medium text-gray-400",children:e}),se("div",{className:"mt-2 flex items-baseline gap-2",children:[le("span",{className:"text-2xl font-bold",children:t}),l&&le("span",{className:"text-sm text-gray-400",children:l})]}),r&&se("div",{className:"mt-2 flex items-center gap-1",children:[le(W,{className:"w-4 h-4"}),se("span",{className:"text-sm",children:[r,"% زيادة"]})]})]})]}),Xe=({customer:e,onClick:t})=>{const a=(()=>{const t=e.orderCount||0;return t>5?{label:"عميل مخلص",color:"text-amber-500"}:t>1?{label:"عميل منتظم",color:"text-blue-500"}:{label:"عميل جديد",color:"text-emerald-500"}})();return se("div",{onClick:t,className:"bg-gradient-to-br from-gray-800/40 to-gray-800/20 \r rounded-2xl p-4 border border-gray-700/50 space-y-4 \r hover:border-blue-500/30 transition-all duration-300 cursor-pointer",dir:"ltr",children:[se("div",{className:"flex justify-between items-start",children:[se("div",{className:"flex gap-2",children:[le("button",{onClick:t=>{t.stopPropagation(),window.open(`https://wa.me/${e.phone}`,"_blank")},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-green-500/10\r border border-transparent hover:border-green-500/30\r transition-all duration-300",children:le(L,{className:"w-5 h-5 text-green-500"})}),le("a",{href:`tel:${e.phone}`,onClick:e=>e.stopPropagation(),className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300",children:le(F,{className:"w-5 h-5 text-blue-500"})}),le("button",{onClick:async t=>{t.stopPropagation();try{await navigator.clipboard.writeText(e.phone)}catch(a){}},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300",children:le(O,{className:"w-5 h-5 text-blue-500"})})]}),se("div",{className:"text-right",children:[se("div",{className:"flex items-center justify-end gap-2",children:[le("h3",{className:"text-lg font-bold text-white",dir:"ltr",children:e.phone}),le("span",{className:`text-sm ${a.color}`,children:a.label})]}),le("p",{className:"text-sm text-gray-400",children:new Date(e.createdAt).toLocaleDateString("ar-EG")})]})]}),e.addresses?.[0]&&se("div",{className:"flex items-start gap-3",dir:"rtl",children:[le(M,{className:"w-5 h-5 text-blue-500 mt-0.5"}),se("div",{className:"flex-1 text-right",children:[le("p",{className:"text-white",children:e.addresses[0].governorate}),le("p",{className:"text-sm text-gray-400",children:e.addresses[0].district}),e.addresses[0].details&&le("p",{className:"text-sm text-gray-500",children:e.addresses[0].details})]})]}),se("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-700/50",children:[se("div",{className:"space-y-1",dir:"rtl",children:[se("div",{className:"flex items-center gap-2",dir:"rtl",children:[le(n,{className:"w-4 h-4 text-blue-500"}),le("span",{className:"text-sm text-gray-400",children:"الطلبات"})]}),le("p",{className:"text-lg font-bold text-white pr-4",children:e.orderCount||0})]}),se("div",{className:"space-y-1 text-right",children:[se("div",{className:"flex items-center justify-end gap-2",children:[le("span",{className:"text-sm text-gray-400",children:"إجمالي المشتريات"}),le(E,{className:"w-4 h-4 text-blue-500"})]}),se("p",{className:"text-lg font-bold text-blue-500 pr-4",children:[(e.totalSpent||0).toLocaleString("ar-EG")," جنيه"]})]})]})]})},He=({label:e,options:a,values:r=[],onChange:l,icon:s})=>{const[n,i]=t.useState(!1),o=t.useRef(null);t.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const d=e=>{const t=r.includes(e)?r.filter(t=>t!==e):[...r,e];l(t)},c=()=>{l([]),i(!1)},u=e=>le("div",{className:"w-5 h-5 rounded border flex items-center justify-center\n                      transition-colors duration-200\n                      "+(e?"border-blue-500 bg-blue-500":"border-gray-600"),children:e&&le("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:le("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})});return se("div",{className:"relative",ref:o,children:[se("button",{onClick:()=>i(!n),className:"flex items-center gap-2 px-4 py-2 rounded-xl\n                     transition-all duration-200 whitespace-nowrap\n                     "+(n?"bg-blue-500/20 text-blue-500 border border-blue-500/30":r.length>0?"bg-blue-500/10 text-blue-500 border border-blue-500/20":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[s&&le(s,{className:"w-4 h-4"}),se("div",{className:"flex items-center gap-2",children:[le("span",{children:e}),0===r.length?null:le("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-500/20 border border-blue-500/20",children:r.length})]})]}),se("div",{className:"fixed inset-0 z-50 md:hidden transition-opacity duration-300\n                      "+(n?"opacity-100":"opacity-0 pointer-events-none"),children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>i(!1)}),le("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500 ease-out\n                        "+(n?"translate-y-0":"translate-y-full"),children:se("div",{className:"bg-gradient-to-b from-gray-900/95 to-gray-900 backdrop-blur-xl\r rounded-t-[2.5rem] border-t border-gray-800/50 shadow-2xl\r max-h-[80vh] overflow-y-auto",children:[le("div",{className:"absolute inset-x-0 top-0 h-7 flex justify-center items-start",children:le("div",{className:"w-12 h-1 rounded-full bg-gray-700/50 mt-3"})}),se("div",{className:"px-6 pt-8 pb-6",children:[le("h3",{className:"text-lg font-bold text-white mb-4",children:e}),le("div",{className:"grid grid-cols-1 gap-2",children:a.map(e=>se("button",{onClick:()=>d(e.value),className:"flex items-center gap-3 p-4 rounded-xl\n                               transition-all duration-200\n                               "+(r.includes(e.value)?"bg-blue-500/20 text-blue-500 border border-blue-500/30":"bg-gray-800/30 text-gray-400 hover:bg-gray-700/50"),children:[u(r.includes(e.value)),le("span",{className:"flex-1 text-right",children:e.label})]},e.value))}),se("div",{className:"mt-4 flex gap-2",children:[le("button",{onClick:c,className:"flex-1 py-3 rounded-xl bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors",children:"إعادة تعيين"}),le("button",{onClick:()=>i(!1),className:"flex-1 py-3 rounded-xl bg-blue-500 text-white\r hover:bg-blue-600 transition-colors",children:"تطبيق"})]})]})]})})]}),n&&se("div",{className:"absolute top-full left-0 mt-2 w-64 bg-gray-800\r rounded-xl shadow-xl border border-gray-700/50 \r hidden md:block",children:[le("div",{className:"py-2",children:a.map(e=>se("button",{onClick:()=>d(e.value),className:"w-full flex items-center gap-3 px-4 py-3\n                           transition-colors\n                           "+(r.includes(e.value)?"text-blue-500 bg-blue-500/10":"text-gray-400 hover:bg-gray-700/50"),children:[u(r.includes(e.value)),le("span",{className:"flex-1 text-right",children:e.label})]},e.value))}),se("div",{className:"border-t border-gray-700/50 p-2 flex gap-2",children:[le("button",{onClick:c,className:"flex-1 py-2 rounded-lg bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors text-sm",children:"إعادة تعيين"}),le("button",{onClick:()=>i(!1),className:"flex-1 py-2 rounded-lg bg-blue-500 text-white\r hover:bg-blue-600 transition-colors text-sm",children:"تطبيق"})]})]})]})},Ze=({customer:e,isOpen:t,onClose:a,analytics:r})=>e?se("div",{className:"fixed inset-0 z-50 transition-opacity duration-300\n                  "+(t?"opacity-100":"opacity-0 pointer-events-none"),children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),le("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500\n                    "+(t?"translate-y-0":"translate-y-full"),children:le("div",{className:"bg-gradient-to-b from-gray-900/95 to-gray-900 backdrop-blur-xl\r rounded-t-[2.5rem] border-t border-gray-800/50 shadow-2xl\r max-h-[90vh] overflow-y-auto",dir:"rtl",children:se("div",{className:"px-6 py-8 space-y-6",children:[se("div",{className:"flex justify-between items-start",dir:"ltr",children:[le("button",{onClick:a,className:"p-2 rounded-full hover:bg-gray-800/50 transition-colors",children:"×"}),se("div",{className:"text-right",children:[le("h2",{className:"text-xl font-bold text-white",children:"تفاصيل العميل"}),se("p",{className:"text-sm text-gray-400",children:["عميل منذ ",(()=>{const t=Math.floor((new Date-new Date(e.createdAt))/2592e6);if(t<1)return"أقل من شهر";if(1===t)return"شهر واحد";if(t<12)return`${t} أشهر`;const a=Math.floor(t/12);return`${a} ${1===a?"سنة":"سنوات"}`})()]})]})]}),se("div",{className:"grid grid-cols-2 gap-4",children:[le(Ye,{title:"إجمالي الطلبات",value:e.orderCount||0,icon:n,color:"blue"}),le(Ye,{title:"إجمالي المشتريات",value:`${(e.totalSpent||0).toLocaleString("ar-EG")} جنيه`,icon:E,color:"emerald"})]}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[le("h3",{className:"font-bold text-white",children:"معلومات الاتصال"}),se("div",{className:"flex items-center gap-3",children:[le(F,{className:"w-5 h-5 text-blue-500"}),le("span",{className:"text-white",dir:"ltr",children:e.phone})]}),se("div",{className:"flex gap-2",children:[se("button",{onClick:()=>window.open(`https://wa.me/${e.phone}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r bg-green-500/10 text-green-500 hover:bg-green-500/20\r transition-colors",children:[le(L,{className:"w-5 h-5"}),le("span",{children:"واتساب"})]}),se("button",{onClick:()=>window.open(`tel:${e.phone}`),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r bg-blue-500/10 text-blue-500 hover:bg-blue-500/20\r transition-colors",children:[le(F,{className:"w-5 h-5"}),le("span",{children:"اتصال"})]})]})]}),e.addresses?.length>0&&se("div",{className:"space-y-4",children:[le("h3",{className:"font-bold text-white",children:"العناوين"}),e.addresses.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-4 space-y-2",children:[le("p",{className:"text-white",children:e.governorate}),le("p",{className:"text-gray-400",children:e.district}),e.details&&le("p",{className:"text-sm text-gray-500",children:e.details})]},t))]})]})})})]}):null,et=({page:e,totalPages:t,onNext:a,onPrevious:r})=>le("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r border-t border-gray-800/50 p-4",children:se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:r,disabled:1===e,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed",children:le(V,{className:"w-5 h-5"})}),se("span",{className:"text-gray-400",children:["صفحة ",e," من ",t]}),le("button",{onClick:a,disabled:e===t,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed",children:le(J,{className:"w-5 h-5"})})]})}),tt=()=>le("div",{className:"flex items-center justify-center py-12",children:le(g,{className:"w-8 h-8 text-blue-500 animate-spin"})}),at=()=>se("div",{className:"text-center py-12",children:[le(o,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"لا يوجد عملاء"}),le("p",{className:"text-gray-400",children:"لم يتم العثور على عملاء يطابقون معايير البحث"})]}),rt=()=>{const{slides:e,loading:a,errors:r,createSlide:l,updateSlide:s,deleteSlide:n,toggleSlideStatus:i,resetError:o}=(()=>{const[e,a]=t.useState([]),[r,l]=t.useState(null),[s,n]=t.useState({slides:!1,create:!1,update:!1,delete:!1,status:!1}),[i,o]=t.useState({slides:null,create:null,update:null,delete:null}),{apiCall:d}=oe(),c=t.useRef([]),u=t.useCallback(e=>{o(t=>({...t,[e]:null}))},[]),m=t.useCallback(e=>{const t=["title","productId"].filter(t=>!e[t]);return t.length>0?{isValid:!1,error:`Missing required fields: ${t.join(", ")}`}:{isValid:!0}},[]),h=t.useCallback(e=>{const t=new FormData;return Object.entries(e).forEach(([e,a])=>{null!=a&&("image"===e&&a instanceof File?t.append("image",a):"image"!==e&&t.append(e,a))}),t},[]),g=t.useCallback(async()=>{n(e=>({...e,slides:!0})),u("slides");try{const e=await d("/admin/slides");return e&&(a(e),c.current=e),e}catch(e){return o(t=>({...t,slides:e.message})),null}finally{n(e=>({...e,slides:!1}))}},[d,u]),b=t.useCallback(async e=>{n(e=>({...e,create:!0})),u("create");const t=m(e);if(!t.isValid)return o(e=>({...e,create:t.error})),n(e=>({...e,create:!1})),null;try{const t=h(e),a=await d("/admin/slides",{method:"POST",body:t});return a&&await g(),a}catch(a){return o(e=>({...e,create:a.message})),null}finally{n(e=>({...e,create:!1}))}},[d,g,m,h,u]),p=t.useCallback(async(t,r)=>{n(e=>({...e,update:!0})),u("update");const l=[...e],s=e.findIndex(e=>e.id===t);try{let n,i={};if(r.image instanceof File?n=h(r):(n=JSON.stringify(r),i={"Content-Type":"application/json"}),-1!==s&&!(r.image instanceof File)){const t={...e[s],...r},l=[...e];l[s]=t,a(l)}const o=await d(`/admin/slides/${t}`,{method:"PUT",headers:i,body:n});return o?(await g(),o):(a(l),null)}catch(i){return a(l),o(e=>({...e,update:i.message})),null}finally{n(e=>({...e,update:!1}))}},[d,e,g,h,u]),x=t.useCallback(async t=>{n(e=>({...e,delete:!0})),u("delete");const r=[...e];try{a(e.filter(e=>e.id!==t));const l=await d(`/admin/slides/${t}`,{method:"DELETE"});if(!l)throw a(r),new Error("Failed to delete slide");return l}catch(l){return a(r),o(e=>({...e,delete:l.message})),null}finally{n(e=>({...e,delete:!1}))}},[d,e,u]),f=t.useCallback(async t=>{n(e=>({...e,status:!0})),u("update");const r=e.findIndex(e=>e.id===t);if(-1===r)return;const l=e[r],s="active"===l.status?"inactive":"active",i=[...e];try{const n=[...e];n[r]={...l,status:s},a(n);const o=await d(`/admin/slides/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});if(!o)throw a(i),new Error("Failed to update slide status");return o}catch(c){return a(i),o(e=>({...e,update:c.message})),null}finally{n(e=>({...e,status:!1}))}},[d,e,u]);return t.useEffect(()=>{g()},[g]),{slides:e,selectedSlide:r,loading:s,errors:i,setSelectedSlide:l,loadSlides:g,createSlide:b,updateSlide:p,deleteSlide:x,toggleSlideStatus:f,resetError:u}})(),{products:d,loading:c}=de(),[u,m]=t.useState(!1);return se("div",{className:"min-h-screen bg-secondary-900 p-4 pt-0 pb-20",dir:"rtl",children:[le("div",{className:"sticky top-0 z-30 -mx-4 bg-secondary-900/95 backdrop-blur-xl px-4 py-3 \r border-b border-secondary-800/50 pt-0",children:se("div",{className:"flex items-center justify-between",children:[le("h1",{className:"text-xl font-bold text-white",children:"إدارة العروض"}),se("button",{onClick:()=>{m(!0),o("create")},className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-500 \r hover:bg-blue-600 transition-colors text-white",children:[le(x,{className:"w-5 h-5"}),le("span",{children:"إضافة عرض"})]})]})}),a.slides?le(ct,{}):r.slides?le(ut,{message:r.slides}):0===e.length?le(mt,{}):le("div",{className:"space-y-4 mt-6",children:e.map(e=>le(st,{slide:e,onDelete:n,onUpdate:s,onToggleStatus:i,products:d,loading:a,errors:r,resetError:o},e.id))}),u&&le(nt,{onClose:()=>{m(!1),o("create")},onCreate:async e=>{await l(e)&&m(!1)},products:d,isLoading:a.create||c,error:r.create})]})},lt=({checked:e,onChange:t,disabled:a})=>se("button",{onClick:t,disabled:a,className:"relative inline-flex items-center gap-3",children:[le("div",{className:`\n        w-10 h-5 rounded-full transition-colors duration-200 ml-[-48px]\n        ${e?"bg-blue-500":"bg-gray-700"}\n        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n      `,children:le("div",{className:`\n          absolute w-5 h-5 ml-6 bg-white rounded-full shadow transition-transform duration-200 transform\n          ${e?"translate-x-4 rtl:-translate-x-6":"translate-x-1 rtl:-translate-x-1"}\n          ${a?"cursor-not-allowed":"cursor-pointer"}\n        `,children:a&&le("div",{className:"absolute inset-0 flex items-center justify-center",children:le(g,{className:"w-3 h-3 text-blue-500 animate-spin"})})})}),le("span",{className:`\n        text-sm transition-colors duration-200\n        ${e?"text-blue-500":"text-gray-400"}\n        ${a?"opacity-50":""}\n      `,children:e?"نشط":"غير نشط"})]}),st=({slide:e,onDelete:a,onUpdate:r,onToggleStatus:l,products:s,loading:i,errors:o,resetError:d})=>{const[c,u]=t.useState(!1),[m,h]=t.useState(!1),g=s.find(t=>t.id===e.productId);return se("div",{className:"bg-gray-800/30 rounded-2xl border border-gray-700/50 overflow-hidden",children:[le("div",{className:"p-4",children:se("div",{className:"flex items-start gap-4",children:[le("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden group",children:le("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover transition-transform duration-300\r group-hover:scale-110"})}),se("div",{className:"flex-1 min-w-0",children:[le("h3",{className:"font-bold text-white text-lg truncate",children:e.title}),g&&se("div",{className:"flex items-center gap-2 mt-1",children:[le(n,{className:"w-4 h-4 text-blue-500"}),le("span",{className:"text-sm text-gray-400",children:g.name})]}),le("div",{className:"mt-6",dir:"ltr",children:le(lt,{checked:"active"===e.status,onChange:()=>l(e.id),disabled:i.status})})]}),le("button",{onClick:()=>u(!c),className:"p-2 rounded-xl hover:bg-gray-700/50 transition-colors",children:le(c?Q:I,{className:"w-5 h-5 text-gray-400"})})]})}),c&&se("div",{className:"border-t border-gray-700/50 p-4 space-y-4",children:[e.description&&le("p",{className:"text-gray-400 text-sm",children:e.description}),se("div",{className:"flex gap-2",children:[le("button",{onClick:()=>{h(!0),d("update")},className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r bg-blue-500/10 text-blue-500 hover:bg-blue-500/20\r transition-colors",children:"تعديل"}),le("button",{onClick:async()=>{await a(e.id)&&u(!1)},disabled:i.delete,className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r bg-red-500/10 text-red-500 hover:bg-red-500/20\r transition-colors disabled:opacity-50",children:i.delete?"جاري الحذف...":"حذف"})]}),o.delete&&le("p",{className:"text-sm text-red-500 text-center",children:o.delete})]}),m&&le(dt,{slide:e,onClose:()=>{h(!1),d("update")},onUpdate:async t=>{await r(e.id,t)&&h(!1)},products:s,isLoading:i.update,error:o.update})]})},nt=({onClose:e,onCreate:a,products:r,isLoading:l,error:s})=>{const[n,i]=t.useState({title:"",description:"",productId:"",image:null}),[o,d]=t.useState(null),[c,u]=t.useState("");return le("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",children:le("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-300",children:se("div",{className:"bg-gray-900/95 backdrop-blur-xl rounded-t-[2.5rem] border-t \r border-gray-800/50 p-6 max-h-[90vh] overflow-y-auto",children:[le("h2",{className:"text-xl font-bold text-white mb-6",children:"إضافة عرض جديد"}),(s||c)&&le("div",{className:"mb-4 p-3 rounded-xl bg-red-500/10 text-red-500",children:s||c}),se("form",{onSubmit:async t=>{t.preventDefault(),n.image?n.title.trim()&&n.productId?await a(n)&&e():u("Please fill in all required fields"):u("Please select an image")},className:"space-y-6",children:[se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الصورة"}),le(it,{imagePreview:o,onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void u("Please select a valid image file");if(t.size>5242880)return void u("Image size should be less than 5MB");i(e=>({...e,image:t})),d(URL.createObjectURL(t)),u("")}},inputId:"create-slide-image"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"العنوان"}),le("input",{type:"text",value:n.title,onChange:e=>i(t=>({...t,title:e.target.value})),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50",placeholder:"عنوان العرض"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الوصف"}),le("textarea",{value:n.description,onChange:e=>i(t=>({...t,description:e.target.value})),className:"w-full h-24 bg-gray-800/50 rounded-xl p-4 text-white\r border border-gray-700/50 focus:border-blue-500/50 resize-none",placeholder:"وصف العرض"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"المنتج"}),le(ot,{value:n.productId,onChange:e=>i(t=>({...t,productId:e})),products:r})]}),se("div",{className:"flex gap-3 pt-4",children:[le("button",{type:"button",onClick:e,className:"flex-1 h-12 rounded-xl bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors",children:"إلغاء"}),le("button",{type:"submit",disabled:l,className:"flex-1 h-12 rounded-xl bg-blue-500 text-white\r hover:bg-blue-600 transition-colors disabled:opacity-50",children:l?se("span",{className:"flex items-center justify-center gap-2",children:[le(g,{className:"w-5 h-5 animate-spin"}),"جاري الإنشاء..."]}):"إنشاء"})]})]})]})})})},it=({imagePreview:e,onChange:t,inputId:a})=>se("div",{className:"relative",children:[le("input",{type:"file",accept:"image/*",onChange:t,className:"hidden",id:a}),le("label",{htmlFor:a,className:"block w-full aspect-video rounded-xl border-2 border-dashed\r border-gray-700/50 hover:border-blue-500/50 transition-colors\r cursor-pointer overflow-hidden",children:e?le("img",{src:e,alt:"Preview",className:"w-full h-full object-cover"}):se("div",{className:"flex flex-col items-center justify-center h-full",children:[le(K,{className:"w-8 h-8 text-gray-400 mb-2"}),le("span",{className:"text-sm text-gray-400",children:"اختر صورة أو اسحبها هنا"})]})})]}),ot=({value:e,onChange:t,products:a})=>se("div",{className:"relative",children:[se("select",{value:e,onChange:e=>t(e.target.value),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r appearance-none",children:[le("option",{value:"",children:"اختر منتج"}),a.map(e=>le("option",{value:e.id,children:e.name},e.id))]}),le(I,{className:"absolute left-4 top-1/2 -translate-y-1/2 \r w-5 h-5 text-gray-400 pointer-events-none"})]}),dt=({slide:e,onClose:a,onUpdate:r,products:l,isLoading:s,error:n})=>{const[i,o]=t.useState({title:e.title,description:e.description||"",productId:e.productId,image:null}),[d,c]=t.useState(null),[u,m]=t.useState("");return le("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",children:le("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-300",children:se("div",{className:"bg-gray-900/95 backdrop-blur-xl rounded-t-[2.5rem] border-t \r border-gray-800/50 p-6 max-h-[90vh] overflow-y-auto",children:[le("h2",{className:"text-xl font-bold text-white mb-6",children:"تعديل العرض"}),(n||u)&&le("div",{className:"mb-4 p-3 rounded-xl bg-red-500/10 text-red-500",children:n||u}),se("form",{onSubmit:async e=>{e.preventDefault(),i.title.trim()&&i.productId?await r(i)&&a():m("Please fill in all required fields")},className:"space-y-6",children:[se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الصورة"}),le(it,{imagePreview:d||e.imageUrl,onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void m("Please select a valid image file");if(t.size>5242880)return void m("Image size should be less than 5MB");o(e=>({...e,image:t})),c(URL.createObjectURL(t)),m("")}},inputId:"edit-slide-image"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"العنوان"}),le("input",{type:"text",value:i.title,onChange:e=>o(t=>({...t,title:e.target.value})),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50",placeholder:"عنوان العرض"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الوصف"}),le("textarea",{value:i.description,onChange:e=>o(t=>({...t,description:e.target.value})),className:"w-full h-24 bg-gray-800/50 rounded-xl p-4 text-white\r border border-gray-700/50 focus:border-blue-500/50 resize-none",placeholder:"وصف العرض"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"المنتج"}),le(ot,{value:i.productId,onChange:e=>o(t=>({...t,productId:e})),products:l})]}),i.productId&&le("div",{className:"bg-gray-800/30 rounded-xl p-4",children:le(ht,{product:l.find(e=>e.id===i.productId)})}),se("div",{className:"flex gap-3 pt-4",children:[le("button",{type:"button",onClick:a,className:"flex-1 h-12 rounded-xl bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors",children:"إلغاء"}),le("button",{type:"submit",disabled:s,className:"flex-1 h-12 rounded-xl bg-blue-500 text-white\r hover:bg-blue-600 transition-colors disabled:opacity-50",children:s?se("span",{className:"flex items-center justify-center gap-2",children:[le(g,{className:"w-5 h-5 animate-spin"}),"جاري الحفظ..."]}):"حفظ"})]})]})]})})})},ct=()=>le("div",{className:"flex items-center justify-center py-12",children:se("div",{className:"text-center space-y-4",children:[le(g,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto"}),le("p",{className:"text-gray-400",children:"جاري تحميل العروض..."})]})}),ut=({message:e})=>se("div",{className:"text-center py-12",children:[le(r,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),le("p",{className:"text-gray-400",children:e})]}),mt=()=>se("div",{className:"text-center py-12",children:[le(K,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد عروض"}),le("p",{className:"text-gray-400",children:"ابدأ بإضافة عروض جديدة لعرضها للعملاء"})]}),ht=({product:e})=>{if(!e)return null;const t=e.variants[0],a=t?.images[0];return se("div",{className:"flex items-start gap-3",children:[a&&le("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:le("img",{src:a,alt:e.name,className:"w-full h-full object-cover"})}),se("div",{className:"flex-1 min-w-0",children:[le("h4",{className:"font-medium text-white truncate",children:e.name}),se("div",{className:"flex items-center gap-4 mt-1",children:[se("span",{className:"text-sm text-gray-400",children:[e.variants.length," ",1===e.variants.length?"لون":"ألوان"]}),se("span",{className:"text-sm text-gray-400",children:[e.variants.reduce((e,t)=>e+t.sizes.length,0)," مقاسات"]})]})]})]})},gt=()=>{const{coupons:e,totalCoupons:a,selectedCoupon:r,couponStats:l,page:n,totalPages:i,filters:d,isLoading:c,isCreating:u,isUpdating:m,isDeleting:h,isLoadingStats:g,error:p,setSelectedCoupon:f,updateFilters:v,createCoupon:y,updateCoupon:N,deleteCoupon:C,nextPage:k,previousPage:S}=(()=>{const[e,a]=t.useState([]),[r,l]=t.useState(0),[s,n]=t.useState(null),[i,o]=t.useState(null),[d,c]=t.useState(1),[u,m]=t.useState(0),[h,g]=t.useState(20),[b,p]=t.useState({status:"",search:"",type:"all",isSpecific:null}),x={ALL:"all",ACTIVE:"active",EXPIRED:"expired",PERCENTAGE:"percentage",FIXED:"fixed"},[f,v]=t.useState(!1),[y,N]=t.useState(!1),[w,C]=t.useState(!1),[k,S]=t.useState(!1),[P,j]=t.useState(!1),[E,$]=t.useState(null),[D,U]=t.useState(null),{apiCall:z}=oe(),L=t.useCallback(async(e=d)=>{v(!0),$(null);try{const t={...b,type:b.type===x.ALL?"":b.type},r=new URLSearchParams({page:e,perPage:h,...t}).toString(),s=await z(`/admin/coupons?${r}`);return s&&(a(s.coupons),l(s.total),m(s.pages)),s}catch(t){return $(t.message),null}finally{v(!1)}},[z,d,h,b]),F=async()=>{j(!0),U(null);try{const e=await z("/admin/coupons/stats");return e&&o(e),e}catch(e){return U(e.message),null}finally{j(!1)}},O=t.useCallback(e=>{p(t=>({...t,...e})),c(1)},[]),I=t.useCallback(()=>{d<u&&c(e=>e+1)},[d,u]),R=t.useCallback(()=>{d>1&&c(e=>e-1)},[d]);return t.useEffect(()=>{L()},[d,b,L]),t.useEffect(()=>{F();const e=setInterval(F,3e5);return()=>clearInterval(e)},[]),{coupons:e,totalCoupons:r,selectedCoupon:s,couponStats:i,COUPON_TYPES:x,page:d,totalPages:u,perPage:h,filters:b,isLoading:f,isCreating:y,isUpdating:w,isDeleting:k,isLoadingStats:P,error:E,statsError:D,setSelectedCoupon:n,setPage:c,setPerPage:g,updateFilters:O,loadCoupons:L,createCoupon:async e=>{N(!0),$(null);try{const t=await z("/admin/coupons",{method:"POST",body:JSON.stringify(e)});return await L(),t}catch(t){throw $(t.message),t}finally{N(!1)}},updateCoupon:async(e,t)=>{C(!0),$(null);try{const a=await z(`/admin/coupons/${e}`,{method:"PUT",body:JSON.stringify(t)});return await L(),a}catch(a){throw $(a.message),a}finally{C(!1)}},deleteCoupon:async e=>{S(!0),$(null);try{const t=await z(`/admin/coupons/${e}`,{method:"DELETE"});return await L(),t}catch(t){throw $(t.message),t}finally{S(!1)}},loadCouponStats:F,nextPage:I,previousPage:R}})(),[P,j]=t.useState(!1),[E,L]=t.useState(!1);return se("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[se("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[le("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"القسائم"}),se("span",{className:"text-sm text-neutral-400",children:[a," قسيمة"]})]}),l&&se("div",{className:"p-4 grid grid-cols-2 gap-4",children:[le(be,{title:"القسائم النشطة",value:l.activeCoupons,icon:Y,color:"success"}),le(be,{title:"إجمالي التوفير",value:`${l.totalDiscountGiven.toLocaleString("ar-EG")} جنيه`,icon:s,color:"primary"}),le(be,{title:"معدل الاستخدام",value:`${(l.totalUsedCoupons/l.totalCoupons*100).toFixed(1)}%`,icon:$,color:"warning"}),le(be,{title:"قسائم منتهية",value:l.expiredCoupons,icon:z,color:"danger"})]}),se("div",{className:"sticky top-0 z-30 bg-neutral-950/95 backdrop-blur-sm p-4 space-y-4 border-b border-neutral-800/50",children:[se("div",{className:"relative",children:[le("input",{type:"text",value:d.search,onChange:e=>v({search:e.target.value}),placeholder:"ابحث برمز القسيمة أو رقم الهاتف...",className:"w-full h-12 bg-gray-800/50 rounded-xl px-12 text-white text-right\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50\r placeholder:text-gray-500",dir:"rtl"}),le(w,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),d.search&&le("button",{onClick:()=>v({search:""}),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r hover:bg-gray-700/50 transition-colors",children:le(b,{className:"w-4 h-4 text-gray-400"})})]}),le("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",dir:"rtl",children:[{id:"all",label:"الكل",icon:Y},{id:"active",label:"نشط",icon:U},{id:"expired",label:"منتهي",icon:D},{id:"percentage",label:"نسبة مئوية",icon:X},{id:"fixed",label:"قيمة ثابتة",icon:H},{id:"specific",label:"مستخدمين محددين",icon:o}].map(({id:e,label:t,icon:a})=>se("button",{onClick:()=>v({type:e}),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm\n                       whitespace-nowrap transition-colors\n                       "+(d.type===e?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[le(a,{className:"w-4 h-4"}),le("span",{children:t})]},e))}),se("div",{className:"flex gap-2",children:[se("button",{onClick:()=>j(!0),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r bg-blue-500 text-white font-medium hover:bg-blue-600\r transition-colors",children:[le(x,{className:"w-5 h-5"}),le("span",{children:"إنشاء قسيمة"})]}),le("button",{onClick:()=>L(!0),className:"p-3 rounded-xl bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors",children:le(Z,{className:"w-5 h-5"})})]})]}),le("div",{className:"p-4 space-y-4",children:c?le(Nt,{}):p?le(wt,{message:p}):0===e.length?le(Ct,{}):e.map(e=>le(pt,{coupon:e,onClick:()=>f(e),onEdit:()=>{},onDelete:()=>C(e.id)},e.id))}),P&&le(xt,{isOpen:P,onClose:()=>j(!1),onCreate:y,isCreating:u}),r&&le(ft,{coupon:r,isOpen:!!r,onClose:()=>f(null),onUpdate:N,onDelete:C,isUpdating:m,isDeleting:h}),E&&le(vt,{stats:l,isOpen:E,onClose:()=>L(!1),isLoading:g}),i>1&&le("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r border-t border-gray-800/50 p-4",children:se("div",{className:"flex justify-between items-center max-w-lg mx-auto",children:[le("button",{onClick:S,disabled:n<=1,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed\r hover:bg-gray-700/50 transition-colors",children:"السابق"}),se("span",{className:"text-gray-400",children:["صفحة ",n," من ",i]}),le("button",{onClick:k,disabled:n>=i,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r disabled:opacity-50 disabled:cursor-not-allowed\r hover:bg-gray-700/50 transition-colors",children:"التالي"})]})})]})},bt=({title:e,value:t,icon:a,color:r})=>se("div",{className:`relative overflow-hidden rounded-2xl p-4 \n                 bg-${r}-500/10 border border-${r}-500/20`,children:[le("div",{className:"absolute top-4 right-4",children:le(a,{className:`w-6 h-6 text-${r}-500`})}),se("div",{className:"mt-6",children:[le("h3",{className:"text-sm font-medium text-gray-400",children:e}),le("div",{className:"mt-2",children:le("span",{className:`text-2xl font-bold text-${r}-500`,children:t})})]})]}),pt=({coupon:e,onClick:t,onEdit:a,onDelete:r})=>{const l=new Date(e.endDate)<new Date,s="active"===e.status&&!l;return se("div",{onClick:t,className:"group bg-gray-800/30 rounded-2xl p-4 space-y-4 cursor-pointer\r border border-gray-700/50 hover:border-blue-500/30\r transition-all duration-300",children:[se("div",{className:"flex justify-between items-start",children:[se("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm\n                      "+(s?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"),children:[le(s?U:D,{className:"w-4 h-4"}),le("span",{children:s?"نشط":"منتهي"})]}),se("div",{className:"text-right",children:[se("div",{className:"flex items-center gap-2",children:[le("button",{onClick:async t=>{t.stopPropagation();try{await navigator.clipboard.writeText(e.code)}catch(a){}},className:"p-1 rounded-lg bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300",children:le(O,{className:"w-4 h-4 text-blue-500"})}),le("h3",{className:"font-bold text-white group-hover:text-blue-500\r transition-colors",children:e.code})]}),le("p",{className:"text-sm text-gray-400 mt-1",children:new Date(e.endDate).toLocaleDateString("ar-EG")})]})]}),se("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700/50",children:[se("div",{className:"flex items-center gap-2",children:["percentage"===e.discountType?le(X,{className:"w-5 h-5 text-blue-500"}):le(H,{className:"w-5 h-5 text-blue-500"}),se("span",{className:"text-white font-medium",children:[e.discountValue,"percentage"===e.discountType?"%":" جنيه"]})]}),se("div",{className:"flex items-center gap-2 text-gray-400",children:[le(o,{className:"w-5 h-5"}),se("span",{children:[e.usedCount,"/",e.maxUses||"∞"]})]})]})]})},xt=({isOpen:e,onClose:a,onCreate:r,isCreating:l})=>{const[s,n]=t.useState({code:"",discountType:"percentage",discountValue:"",maxUses:"",startDate:(new Date).toISOString().split("T")[0],endDate:"",specificUsers:[]});return le(yt,{isOpen:e,onClose:a,children:se("div",{className:"p-6 space-y-6",children:[se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:le(I,{className:"w-6 h-6 text-gray-400"})}),le("h2",{className:"text-xl font-bold text-white",children:"إنشاء قسيمة جديدة"}),le("div",{className:"w-10"})]}),se("form",{onSubmit:async e=>{e.preventDefault();try{await r(s),a()}catch(t){}},className:"space-y-6",children:[se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"رمز القسيمة"}),le("input",{type:"text",value:s.code,onChange:e=>n({...s,code:e.target.value.toUpperCase()}),placeholder:"SALE2025",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50",dir:"ltr"}),le("p",{className:"text-xs text-gray-500",children:"اتركه فارغاً لإنشاء رمز تلقائي"})]}),se("div",{className:"grid grid-cols-2 gap-4",children:[se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"نوع الخصم"}),se("select",{value:s.discountType,onChange:e=>n({...s,discountType:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50",children:[le("option",{value:"percentage",children:"نسبة مئوية"}),le("option",{value:"fixed",children:"قيمة ثابتة"})]})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"قيمة الخصم"}),se("div",{className:"relative",children:[le("input",{type:"number",value:s.discountValue,onChange:e=>n({...s,discountValue:e.target.value}),placeholder:"percentage"===s.discountType?"10":"100",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50"}),le("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"percentage"===s.discountType?"%":"جنيه"})]})]})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"الحد الأقصى للاستخدام"}),le("input",{type:"number",value:s.maxUses,onChange:e=>n({...s,maxUses:e.target.value}),placeholder:"اتركه فارغاً للاستخدام غير المحدود",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50"})]}),se("div",{className:"grid grid-cols-2 gap-4",children:[se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"تاريخ البدء"}),le("input",{type:"date",value:s.startDate,onChange:e=>n({...s,startDate:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50"})]}),se("div",{className:"space-y-2",children:[le("label",{className:"block text-sm font-medium text-gray-400",children:"تاريخ الانتهاء"}),le("input",{type:"date",value:s.endDate,onChange:e=>n({...s,endDate:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50"})]})]}),se("div",{className:"space-y-4",children:[se("div",{className:"flex justify-between items-center",children:[le("h3",{className:"text-sm font-medium text-gray-400",children:"مستخدمين محددين"}),le("button",{type:"button",onClick:()=>n({...s,specificUsers:[...s.specificUsers,{phone:"",maxUses:""}]}),className:"text-sm text-blue-500 hover:text-blue-400 transition-colors",children:"إضافة مستخدم"})]}),s.specificUsers.map((e,t)=>se("div",{className:"flex gap-4",children:[le("input",{type:"tel",value:e.phone,onChange:e=>{const a=[...s.specificUsers];a[t].phone=e.target.value,n({...s,specificUsers:a})},placeholder:"رقم الهاتف",className:"flex-1 h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50",dir:"ltr"}),le("input",{type:"number",value:e.maxUses,onChange:e=>{const a=[...s.specificUsers];a[t].maxUses=e.target.value,n({...s,specificUsers:a})},placeholder:"عدد مرات الاستخدام",className:"w-32 h-12 bg-gray-800/50 rounded-xl px-4 text-white\r border border-gray-700/50 focus:border-blue-500/50\r focus:ring-2 focus:ring-blue-500/50"}),le("button",{type:"button",onClick:()=>{const e=s.specificUsers.filter((e,a)=>a!==t);n({...s,specificUsers:e})},className:"p-3 rounded-xl bg-red-500/10 text-red-500\r hover:bg-red-500/20 transition-colors",children:le(b,{className:"w-6 h-6"})})]},t))]}),le("button",{type:"submit",disabled:l,className:"w-full p-4 rounded-xl bg-blue-500 text-white font-medium\r hover:bg-blue-600 transition-colors disabled:opacity-50\r disabled:cursor-not-allowed",children:l?se("div",{className:"flex items-center justify-center gap-2",children:[le(g,{className:"w-5 h-5 animate-spin"}),le("span",{children:"جاري الإنشاء..."})]}):"إنشاء القسيمة"})]})]})})},ft=({coupon:e,isOpen:a,onClose:r,onUpdate:l,onDelete:s,isUpdating:n,isDeleting:i})=>{const[d,c]=t.useState(!1),[u,m]=t.useState(e);return le(yt,{isOpen:a,onClose:r,children:se("div",{className:"p-6 space-y-6",children:[se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:r,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:le(I,{className:"w-6 h-6 text-gray-400"})}),le("h2",{className:"text-xl font-bold text-white",children:"تفاصيل القسيمة"}),le("button",{onClick:()=>c(!d),className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:le(P,{className:"w-6 h-6 text-gray-400"})})]}),d?le("form",{onSubmit:async t=>{t.preventDefault();try{await l(e.id,u),c(!1)}catch(a){}},className:"space-y-6",children:se("div",{className:"flex gap-4",children:[le("button",{type:"submit",disabled:n,className:"flex-1 p-4 rounded-xl bg-blue-500 text-white font-medium\r hover:bg-blue-600 transition-colors disabled:opacity-50\r disabled:cursor-not-allowed",children:n?se("div",{className:"flex items-center justify-center gap-2",children:[le(g,{className:"w-5 h-5 animate-spin"}),le("span",{children:"جاري التحديث..."})]}):"حفظ التغييرات"}),le("button",{type:"button",onClick:()=>c(!1),className:"p-4 rounded-xl bg-gray-800/50 text-gray-400\r hover:bg-gray-700/50 transition-colors",children:"إلغاء"})]})}):se(ne,{children:[le("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:async()=>{try{await navigator.clipboard.writeText(e.code)}catch(t){}},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r border border-transparent hover:border-blue-500/30\r transition-all duration-300",children:le(O,{className:"w-5 h-5 text-blue-500"})}),se("div",{className:"text-right",children:[le("h3",{className:"text-2xl font-bold text-white",children:e.code}),le("p",{className:"text-sm text-gray-400 mt-1",children:"رمز القسيمة"})]})]})}),se("div",{className:"grid grid-cols-2 gap-4",children:[se("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:[se("div",{className:"flex items-center gap-2",children:["percentage"===e.discountType?le(X,{className:"w-5 h-5 text-blue-500"}):le(H,{className:"w-5 h-5 text-blue-500"}),se("span",{className:"text-lg font-bold text-white",children:[e.discountValue,"percentage"===e.discountType?"%":" جنيه"]})]}),le("p",{className:"text-sm text-gray-400 mt-1",children:"قيمة الخصم"})]}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:[se("div",{className:"flex items-center gap-2",children:[le(o,{className:"w-5 h-5 text-blue-500"}),se("span",{className:"text-lg font-bold text-white",children:[e.usedCount,"/",e.maxUses||"∞"]})]}),le("p",{className:"text-sm text-gray-400 mt-1",children:"عدد مرات الاستخدام"})]})]}),le("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:se("div",{className:"flex items-start gap-3",children:[le(_,{className:"w-5 h-5 text-blue-500 mt-1"}),se("div",{className:"flex-1",children:[le("h4",{className:"font-medium text-white",children:"المدة الزمنية"}),se("div",{className:"mt-2 space-y-2",children:[se("div",{className:"flex justify-between text-sm",children:[le("span",{className:"text-gray-400",children:"تاريخ البدء:"}),le("span",{className:"text-white",children:new Date(e.startDate).toLocaleDateString("ar-EG")})]}),se("div",{className:"flex justify-between text-sm",children:[le("span",{className:"text-gray-400",children:"تاريخ الانتهاء:"}),le("span",{className:"text-white",children:new Date(e.endDate).toLocaleDateString("ar-EG")})]})]})]})]})}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[le("h4",{className:"font-medium text-white",children:"إحصائيات الاستخدام"}),se("div",{className:"grid grid-cols-2 gap-4",children:[se("div",{className:"space-y-1",children:[le("p",{className:"text-sm text-gray-400",children:"إجمالي التوفير"}),se("p",{className:"text-lg font-bold text-blue-500",children:[e.totalDiscountGiven?.toLocaleString("ar-EG")," جنيه"]})]}),se("div",{className:"space-y-1",children:[le("p",{className:"text-sm text-gray-400",children:"متوسط التوفير"}),se("p",{className:"text-lg font-bold text-blue-500",children:[(e.totalDiscountGiven/e.usedCount||0).toLocaleString("ar-EG")," جنيه"]})]})]})]}),e.recentUsage?.length>0&&se("div",{className:"space-y-4",children:[le("h4",{className:"font-medium text-white",children:"آخر الاستخدامات"}),le("div",{className:"space-y-3",children:e.recentUsage.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[se("span",{className:"text-blue-500 font-medium",children:[e.discountAmount.toLocaleString("ar-EG")," جنيه"]}),se("div",{className:"text-right",children:[le("p",{className:"text-sm text-white",children:e.orderId}),le("p",{className:"text-xs text-gray-400",children:new Date(e.usedAt).toLocaleString("ar-EG")})]})]},t))})]}),e.specificUsers?.length>0&&se("div",{className:"space-y-4",children:[le("h4",{className:"font-medium text-white",children:"المستخدمون المحددون"}),le("div",{className:"space-y-3",children:e.specificUsers.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[se("div",{className:"flex items-center gap-2",children:[le(o,{className:"w-5 h-5 text-blue-500"}),se("span",{className:"text-white",children:[e.usedCount,"/",e.maxUses||"∞"]})]}),le("span",{className:"text-gray-400 dir-ltr",children:e.phone})]},t))})]}),le("button",{onClick:async()=>{if(window.confirm("هل أنت متأكد من حذف هذه القسيمة؟"))try{await s(e.id),r()}catch(t){}},disabled:i,className:"w-full p-4 rounded-xl bg-red-500/10 text-red-500\r hover:bg-red-500/20 transition-colors disabled:opacity-50\r disabled:cursor-not-allowed",children:i?se("div",{className:"flex items-center justify-center gap-2",children:[le(g,{className:"w-5 h-5 animate-spin"}),le("span",{children:"جاري الحذف..."})]}):"حذف القسيمة"})]})]})})},vt=({stats:e,isOpen:t,onClose:a,isLoading:r})=>e||r?le(yt,{isOpen:t,onClose:a,children:se("div",{className:"p-6 space-y-6",children:[se("div",{className:"flex justify-between items-center",children:[le("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:le(I,{className:"w-6 h-6 text-gray-400"})}),le("h2",{className:"text-xl font-bold text-white",children:"إحصائيات القسائم"}),le("div",{className:"w-10"})]}),r?le(Nt,{}):se(ne,{children:[se("div",{className:"grid grid-cols-2 gap-4",children:[le(bt,{title:"القسائم النشطة",value:e.activeCoupons,icon:U,color:"emerald"}),le(bt,{title:"إجمالي التوفير",value:`${e.totalDiscountGiven.toLocaleString("ar-EG")} جنيه`,icon:E,color:"blue"}),le(bt,{title:"معدل الاستخدام",value:`${(e.totalUsedCoupons/e.totalCoupons*100).toFixed(1)}%`,icon:$,color:"amber"}),le(bt,{title:"قسائم منتهية",value:e.expiredCoupons,icon:z,color:"red"})]}),se("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[le("h4",{className:"font-medium text-white",children:"توزيع أنواع القسائم"}),se("div",{className:"grid grid-cols-2 gap-4",children:[se("div",{className:"space-y-2",children:[se("div",{className:"flex justify-between items-center",children:[le("span",{className:"text-gray-400",children:"نسبة مئوية"}),le("span",{className:"text-white",children:e.couponsByType.percentage})]}),le("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:le("div",{className:"h-full bg-blue-500 rounded-full",style:{width:e.couponsByType.percentage/e.totalCoupons*100+"%"}})})]}),se("div",{className:"space-y-2",children:[se("div",{className:"flex justify-between items-center",children:[le("span",{className:"text-gray-400",children:"قيمة ثابتة"}),le("span",{className:"text-white",children:e.couponsByType.fixed})]}),le("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:le("div",{className:"h-full bg-green-500 rounded-full",style:{width:e.couponsByType.fixed/e.totalCoupons*100+"%"}})})]})]})]}),e.recentActivities?.length>0&&se("div",{className:"space-y-4",children:[le("h4",{className:"font-medium text-white",children:"آخر النشاطات"}),le("div",{className:"space-y-3",children:e.recentActivities.map((e,t)=>se("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[se("span",{className:"text-blue-500 font-medium",children:[e.discountAmount.toLocaleString("ar-EG")," جنيه"]}),se("div",{className:"text-right",children:[le("p",{className:"text-sm text-white",children:e.couponCode}),le("p",{className:"text-xs text-gray-400 dir-ltr",children:e.userPhone}),le("p",{className:"text-xs text-gray-500",children:new Date(e.usedAt).toLocaleString("ar-EG")})]})]},t))})]})]})]})}):null,yt=a.memo(({isOpen:e,onClose:a,children:r})=>(t.useEffect(()=>(document.body.style.overflow=e?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[e]),e?se("div",{className:"fixed inset-0 z-50",children:[le("div",{className:"absolute inset-0 bg-black/60",onClick:a,style:{backdropFilter:"blur(4px)"}}),le("div",{className:"fixed inset-x-0 bottom-0",style:{transform:"translateY(0)",willChange:"transform"},children:se("div",{className:"bg-gradient-to-b from-secondary-900/95 to-secondary-900 \r rounded-t-[2.5rem] border-t border-secondary-800/50 shadow-2xl\r max-h-[90vh] overflow-y-auto hide-scrollbar",children:[le("div",{className:"flex justify-center pt-3 pb-1",children:le("div",{className:"w-12 h-1 rounded-full bg-secondary-700/50"})}),r]})})]}):null)),Nt=()=>le("div",{className:"flex items-center justify-center py-12",children:se("div",{className:"space-y-4 text-center",children:[le(g,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto"}),le("p",{className:"text-gray-400",children:"جاري تحميل القسائم..."})]})}),wt=({message:e})=>se("div",{className:"text-center py-12",children:[le(r,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),le("p",{className:"text-gray-400",children:e})]}),Ct=()=>se("div",{className:"text-center py-12",children:[le(Y,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),le("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد قسائم"}),le("p",{className:"text-gray-400",children:"قم بإنشاء قسيمة جديدة للبدء"})]}),kt=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[e,a]=t.useState("analytics"),[l,s]=t.useState(!1),{token:n,isInitialized:i,loading:o,error:d,logout:c}=oe();if(!i||o)return le("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center",children:se("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50",children:[se("div",{className:"relative",children:[le(g,{className:"w-16 h-16 text-primary-500 animate-spin mx-auto"}),le("div",{className:"absolute inset-0 rounded-full bg-primary-500/20 animate-ping"})]}),le("p",{className:"text-neutral-300 text-lg font-medium",dir:"rtl",children:"جاري تحميل لوحة التحكم..."})]})});if(d)return le("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center p-4",children:se("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50 max-w-md",children:[se("div",{className:"relative",children:[le(r,{className:"w-20 h-20 text-danger-500 mx-auto"}),le("div",{className:"absolute inset-0 rounded-full bg-danger-500/20 animate-pulse"})]}),le("h1",{className:"text-2xl font-bold text-white",dir:"rtl",children:"عذراً، حدث خطأ ما"}),le("p",{className:"text-neutral-400 leading-relaxed",dir:"rtl",children:d})]})});if(!n)return le("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center p-4",children:se("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50 max-w-md",children:[le("div",{className:"w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center",children:le(ee,{className:"w-10 h-10 text-white"})}),le("h1",{className:"text-2xl font-bold text-white",dir:"rtl",children:"تسجيل الدخول مطلوب"}),le("p",{className:"text-neutral-400 leading-relaxed",dir:"rtl",children:"يرجى تسجيل الدخول للوصول إلى لوحة التحكم"})]})});const u=[{id:"analytics",icon:Z,label:"التحليلات"},{id:"products",icon:S,label:"المنتجات"},{id:"orders",icon:ae,label:"الطلبات"},{id:"customers",icon:re,label:"العملاء"},{id:"slides",icon:K,label:"العروض"},{id:"coupons",icon:Y,label:"كوبون"}];return se("div",{className:"min-h-screen bg-neutral-950 text-white",children:[le("header",{className:"md:hidden fixed top-0 inset-x-0 z-50 bg-neutral-950/95 backdrop-blur-xl \r border-b border-neutral-800/50 shadow-2xl",children:se("div",{className:"flex items-center justify-between px-4 py-3",children:[le("button",{onClick:()=>s(!0),className:"p-2 rounded-xl bg-neutral-850/50 hover:bg-neutral-800/50 transition-colors",children:le(te,{className:"w-6 h-6 text-neutral-400"})}),le("h1",{className:"text-lg font-bold text-white",dir:"rtl",children:u.find(t=>t.id===e)?.label||"لوحة التحكم"}),le("button",{onClick:c,className:"p-2 rounded-xl bg-neutral-850/50 hover:bg-danger-500/10 \r hover:border-danger-500/30 border border-transparent transition-all",children:le(ee,{className:"w-5 h-5 text-danger-500"})})]})}),se("aside",{className:"hidden md:flex fixed left-0 top-0 h-full w-64 bg-neutral-950/95 \r backdrop-blur-xl border-r border-neutral-800/50 flex-col z-40",children:[se("div",{className:"p-6 border-b border-neutral-800/50",children:[le("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"لوحة التحكم"}),le("p",{className:"text-sm text-neutral-400 mt-1",dir:"rtl",children:"إدارة المتجر"})]}),le("nav",{className:"flex-1 px-4 py-6 space-y-2",children:u.map(({id:t,icon:r,label:l})=>se("button",{onClick:()=>a(t),className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\n                       transition-all duration-300 group text-right\n                       "+(e===t?"text-primary-400 bg-primary-500/10 border border-primary-500/20":"text-neutral-400 hover:text-neutral-300 hover:bg-neutral-850/50"),dir:"rtl",children:[le(r,{className:"w-5 h-5 transition-all duration-300\n                            "+(e===t?"text-primary-400":"group-hover:scale-110")}),le("span",{className:"font-medium",children:l}),e===t&&le("div",{className:"ml-auto w-2 h-8 rounded-full bg-gradient-to-b \r from-primary-400 to-primary-600"})]},t))}),le("div",{className:"p-4 border-t border-neutral-800/50",children:se("button",{onClick:c,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\r text-danger-500 hover:bg-danger-500/10 border border-transparent\r hover:border-danger-500/30 transition-all duration-300",dir:"rtl",children:[le(ee,{className:"w-5 h-5"}),le("span",{className:"font-medium",children:"تسجيل الخروج"})]})})]}),l&&se("div",{className:"md:hidden fixed inset-0 z-50",children:[le("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>s(!1)}),se("nav",{className:"absolute right-0 top-0 h-full w-80 max-w-[85vw] \r bg-neutral-950/95 backdrop-blur-xl border-l border-neutral-800/50\r transform transition-transform duration-300",children:[se("div",{className:"flex items-center justify-between p-4 border-b border-neutral-800/50",children:[le("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-neutral-850/50 transition-colors",children:le(b,{className:"w-6 h-6 text-neutral-400"})}),le("h2",{className:"text-lg font-bold text-white",dir:"rtl",children:"القائمة"})]}),le("div",{className:"px-4 py-6 space-y-2",children:u.map(({id:t,icon:r,label:l})=>se("button",{onClick:()=>(a(t),void s(!1)),className:"w-full flex items-center gap-3 px-4 py-4 rounded-xl\n                           transition-all duration-300 text-right\n                           "+(e===t?"text-primary-400 bg-primary-500/10 border border-primary-500/20":"text-neutral-400 hover:text-neutral-300 hover:bg-neutral-850/50"),dir:"rtl",children:[le(r,{className:"w-6 h-6 "+(e===t?"text-primary-400":"")}),le("span",{className:"font-medium text-lg",children:l})]},t))}),le("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-neutral-800/50",children:se("button",{onClick:c,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\r text-danger-500 hover:bg-danger-500/10 border border-transparent\r hover:border-danger-500/30 transition-all duration-300",dir:"rtl",children:[le(ee,{className:"w-5 h-5"}),le("span",{className:"font-medium",children:"تسجيل الخروج"})]})})]})]}),le("nav",{className:"md:hidden fixed bottom-0 inset-x-0 z-40 bg-neutral-950/95 \r backdrop-blur-xl border-t border-neutral-800/50",children:le("div",{className:"flex justify-around py-2",children:u.slice(0,5).map(({id:t,icon:r,label:l})=>se("button",{onClick:()=>a(t),className:"flex flex-col items-center gap-1 py-2 px-2 rounded-xl\n                       transition-all duration-300 min-w-0 flex-1\n                       "+(e===t?"text-primary-400":"text-neutral-500 hover:text-neutral-400"),children:[le(r,{className:`w-5 h-5 ${e===t?"scale-110":""} transition-transform`}),le("span",{className:"text-xs font-medium truncate w-full text-center",children:l}),e===t&&le("div",{className:"w-6 h-0.5 rounded-full bg-primary-400 mt-1"})]},t))})}),le("main",{className:"md:ml-64 pt-16 md:pt-0 pb-20 md:pb-8 min-h-screen\r bg-gradient-to-b from-neutral-950 via-neutral-950 to-neutral-900",children:(()=>{switch(e){case"analytics":return le(pe,{});case"products":return le(Se,{});case"orders":return le(Re,{});case"customers":return le(Qe,{});case"slides":return le(rt,{});case"coupons":return le(gt,{});default:return le(Z,{})}})()})]})}},Symbol.toStringTag,{value:"Module"}));export{kt as A,ne as F,se as a,le as j};
