import{r as e,R as s,j as t,C as a,a as r,W as l,P as n,S as i,U as o,b as d,c,d as x,e as u,T as m,L as h,X as g,f as b,g as p,B as j,h as f,G as v,i as y,k as N,l as w,A as C,m as k,n as S,o as P,p as E,q as $,s as D,t as U,u as F,M as z,v as L,w as O,x as I,y as R,z as T,D as A,Y as G,E as B,F as q,H as _,I as M,J as V,K as J,N as W,O as K,Q,V as Y,Z as X,_ as H,$ as Z,a0 as ee,a1 as se,a2 as te,a3 as ae}from"./vendor-react-Cigj1nJ7.js";const re="https://shozati.pythonanywhere.com/api",le=()=>{const[s,t]=e.useState(localStorage.getItem("adminToken")),[a,r]=e.useState(!1),[l,n]=e.useState(!1),[i,o]=e.useState(!1),[d,c]=e.useState(null),[x,u]=e.useState(null);e.useRef(null);const m=async()=>{o(!0),u(null);try{const e=await fetch(`${re}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:"0000000000"})});if(!e.ok)throw new Error("Authentication failed");const s=await e.json();return t(s.token),localStorage.setItem("adminToken",s.token),s}catch(e){throw u(e.message),e}finally{o(!1)}},h=e.useCallback(()=>{localStorage.removeItem("adminToken"),t(null),r(!1)},[]);e.useEffect(()=>{(async()=>{if(!s&&!a)try{await m()}catch(e){}r(!0)})()},[s,a]);const g=e.useCallback(async(e,t={})=>{const a=async s=>{let a={Authorization:`Bearer ${s}`,...t.headers};t.body instanceof FormData||(a["Content-Type"]="application/json");const r=await fetch(`${re}${e}`,{...t,headers:a}),l=r.headers.get("content-type");return l&&l.includes("application/json")?await r.json():await r.text()};try{return await a(s)}catch(r){if("AbortError"===r.name)return null;if(r.message.includes("Token"))try{const e=await m();return await a(e.token)}catch(l){throw new Error("Re-authentication failed")}throw r}},[s]);return{token:s,isInitialized:a,loading:l,isAuthenticating:i,error:d,authError:x,setLoading:n,setError:c,login:m,logout:h,apiCall:g}},ne=(s={})=>{const[t,a]=e.useState([]),[r,l]=e.useState(null),[n,i]=e.useState(0),[o,d]=e.useState(0),[c,x]=e.useState({}),[u,m]=e.useState(1),[h]=e.useState(s.perPage||150),[g,b]=e.useState({category:"all",search:"",minPrice:null,maxPrice:null,size:"",color:"",code:s.initialFilters?.code||"",sort:""}),[p,j]=e.useState({isLoading:!1,isCreating:!1,isUpdating:!1,isDeleting:!1,isUploadingImages:!1}),[f,v]=e.useState({fetchError:null,createError:null,updateError:null,deleteError:null,uploadError:null}),{apiCall:y}=le(),N=e.useRef(null),w=e.useRef(new Map);e.useRef([]);const C=e.useCallback((e,s)=>{j(t=>({...t,[e]:s}))},[]),k=e.useCallback((e,s)=>{v(t=>({...t,[e]:s}))},[]),S=e.useCallback(()=>{w.current.clear()},[]),P=e.useCallback(async(e=u,s=g)=>{N.current&&N.current.abort(),N.current=new AbortController,C("isLoading",!0),k("fetchError",null);const t=JSON.stringify({page:e,...s});try{if(w.current.has(t)){const e=w.current.get(t);return a(e.products),i(e.total),d(e.pages),e}const r=new URLSearchParams({page:e,perPage:h,..."all"!==s.category&&{category:s.category},...s.search&&{search:s.search},...s.minPrice&&{minPrice:s.minPrice},...s.maxPrice&&{maxPrice:s.maxPrice},...s.size&&{size:s.size},...s.color&&{color:s.color},...s.code&&{code:s.code},sort:s.sort}),n=await y(`/admin/products?${r}`,{signal:N.current.signal});if(n)return a(n.products),i(n.total),d(n.pages),w.current.set(t,n),n;s.code&&1===n.products.length&&l(n.products[0])}catch(r){if("AbortError"===r.name)return;return k("fetchError",r.message),null}finally{C("isLoading",!1)}},[y,g,u,h,k,C]),E=e.useCallback(async(e,s,t,a)=>{C("isUploadingImages",!0),k("uploadError",null);try{const r=[];for(let l=0;l<t.length;l++){const n=new FormData;n.append("productCode",e),n.append("colorName",s),n.append("image",t[l]);const i=await y("/admin/products/upload-images",{method:"POST",body:n,headers:{},onUploadProgress:e=>{const s=e.loaded/e.total*100;a?.(l/t.length*100+s/t.length)}});i?.imageUrls?.[0]&&r.push(i.imageUrls[0])}return r}catch(r){return k("uploadError",r.message),[]}finally{C("isUploadingImages",!1)}},[y,k,C]),$=e.useCallback(async(e,s)=>{C("isCreating",!0),k("createError",null);try{const t=await y("/admin/products",{method:"POST",body:JSON.stringify({...e,variants:e.variants.map(e=>({...e,images:[]}))})});if(!t)throw new Error("Failed to create product");const a=await Promise.all(e.variants.map(async(e,a)=>{if(!s[a]?.length)return e;const r=await E(t.code,e.colorName,s[a],e=>{x(s=>({...s,[`${a}`]:e}))});return{...e,images:r}})),r=await y(`/admin/products/${t.id}`,{method:"PUT",body:JSON.stringify({...e,variants:a})});return w.current.clear(),await P(),r}catch(t){return k("createError",t.message),null}finally{C("isCreating",!1),x({})}},[y,P,k,C,E]),D=e.useCallback(async(e,s,t)=>{C("isUpdating",!0),k("updateError",null);try{const a=await Promise.all(s.variants.map(async(e,a)=>{if(!t[a]?.length)return e;const r=await E(s.code,e.colorName,t[a],e=>{x(s=>({...s,[`${a}`]:e}))});return{...e,images:[...e.images,...r]}})),r=await y(`/admin/products/${e}`,{method:"PUT",body:JSON.stringify({...s,variants:a})});return r&&(w.current.clear(),await P()),r}catch(a){return k("updateError",a.message),null}finally{C("isUpdating",!1),x({})}},[y,P,k,C,E]),U=e.useCallback(async e=>{C("isDeleting",!0),k("deleteError",null);try{const s=await y(`/admin/products/${e}`,{method:"DELETE"});return s&&(S(),await P()),s}catch(s){return k("deleteError",s.message),null}finally{C("isDeleting",!1)}},[y,S,P,k,C]),F=e.useCallback(async(e,s)=>{C("isUpdating",!0),k("updateError",null);try{const t=await y(`/admin/products/${e}/inventory`,{method:"PUT",body:JSON.stringify(s)});return t&&(S(),await P()),t}catch(t){return k("updateError",t.message),null}finally{C("isUpdating",!1)}},[y,S,P,k,C]),z=e.useCallback(e=>{b(s=>{const t={...s,...e};return JSON.stringify(s)!==JSON.stringify(t)&&m(1),t})},[]),L=e.useCallback(()=>{u<o&&m(e=>e+1)},[u,o]),O=e.useCallback(()=>{u>1&&m(e=>e-1)},[u]);return e.useEffect(()=>(P(),()=>{N.current&&N.current.abort()}),[P,u,g]),e.useEffect(()=>()=>{S(),N.current&&N.current.abort()},[S]),{products:t,selectedProduct:r,totalProducts:n,totalPages:o,page:u,perPage:h,filters:g,...p,...f,setSelectedProduct:l,setPage:m,updateFilters:z,fetchProducts:P,createProduct:$,updateProduct:D,deleteProduct:U,updateInventory:F,uploadProgress:c,uploadProductImages:E,nextPage:L,previousPage:O,clearCache:S}},ie=({children:e,className:s="",variant:a="default",padding:r="lg",hover:l=!0,...n})=>{const i=l?"hover:bg-neutral-850/70 hover:border-neutral-600/50 hover:shadow-xl hover:shadow-black/10":"";return t.jsx("div",{className:`\n        relative overflow-hidden rounded-xl md:rounded-2xl border\n        backdrop-blur-xl transition-all duration-300\n        ${{default:"bg-neutral-850/50 border-neutral-700/50",elevated:"bg-neutral-850/70 border-neutral-700/70 shadow-xl shadow-black/20",outline:"bg-transparent border-neutral-700/50",glass:"bg-neutral-850/30 border-neutral-700/30 backdrop-blur-xl"}[a]}\n        ${{sm:"p-3",md:"p-4",lg:"p-4 md:p-6",xl:"p-6 md:p-8"}[r]}\n        ${i}\n        ${s}\n      `,...n,children:e})},oe=({children:e,variant:s="primary",size:a="md",fullWidth:r=!1,disabled:l=!1,loading:n=!1,className:i="",...o})=>t.jsxs("button",{className:`\n        inline-flex items-center justify-center gap-2 rounded-xl\n        border font-medium transition-all duration-300\n        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-neutral-900\n        disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-current\n        ${{primary:"\n      bg-primary-500 text-white border-primary-500\n      hover:bg-primary-600 hover:border-primary-600\n      focus:ring-primary-500/50\n    ",secondary:"\n      bg-neutral-800/50 text-neutral-300 border-neutral-700/50\n      hover:bg-neutral-700/50 hover:border-neutral-600/50 hover:text-white\n      focus:ring-neutral-500/50\n    ",success:"\n      bg-success-500 text-white border-success-500\n      hover:bg-success-600 hover:border-success-600\n      focus:ring-success-500/50\n    ",warning:"\n      bg-warning-500 text-white border-warning-500\n      hover:bg-warning-600 hover:border-warning-600\n      focus:ring-warning-500/50\n    ",danger:"\n      bg-danger-500 text-white border-danger-500\n      hover:bg-danger-600 hover:border-danger-600\n      focus:ring-danger-500/50\n    ",ghost:"\n      bg-transparent text-neutral-400 border-transparent\n      hover:bg-neutral-800/50 hover:text-white hover:border-neutral-700/50\n      focus:ring-neutral-500/50\n    ",outline:"\n      bg-transparent text-primary-400 border-primary-500/50\n      hover:bg-primary-500/10 hover:border-primary-500 hover:text-primary-300\n      focus:ring-primary-500/50\n    "}[s]}\n        ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"}[a]}\n        ${r?"w-full":""}\n        ${i}\n      `,disabled:l||n,...o,children:[n&&t.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),e]}),de=s.forwardRef(({label:e,error:s,hint:r,type:l="text",size:n="md",fullWidth:i=!0,className:o="",...d},c)=>t.jsxs("div",{className:"space-y-2 "+(i?"w-full":""),children:[e&&t.jsx("label",{className:"block text-sm font-medium text-neutral-300",children:e}),t.jsx("input",{ref:c,type:l,className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300\n          !bg-neutral-800/70 !text-white placeholder:text-neutral-400\n          ${s?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${{sm:"h-10 px-3 text-sm",md:"h-12 px-4 text-sm",lg:"h-14 px-5 text-base"}[n]}\n          ${"color"===l?"p-1 !bg-transparent":""}\n          ${o}\n        `,dir:"rtl",...d}),r&&!s&&t.jsx("p",{className:"text-xs text-neutral-500",children:r}),s&&t.jsxs("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[t.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{children:s})]})]}));de.displayName="AdminInput";const ce=({label:e,error:s,hint:r,options:l=[],size:n="md",fullWidth:i=!0,className:o="",placeholder:d="اختر...",...c})=>t.jsxs("div",{className:"space-y-2 "+(i?"w-full":""),children:[e&&t.jsx("label",{className:"block text-sm font-medium text-neutral-300",children:e}),t.jsxs("select",{className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300\n          !bg-neutral-800/70 !text-white\n          ${s?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${{sm:"h-10 px-3 text-sm",md:"h-12 px-4 text-sm",lg:"h-14 px-5 text-base"}[n]}\n          ${o}\n        `,dir:"rtl",...c,children:[t.jsx("option",{value:"",children:d}),l.map(({value:e,label:s})=>t.jsx("option",{value:e,children:s},e))]}),r&&!s&&t.jsx("p",{className:"text-xs text-neutral-500",children:r}),s&&t.jsxs("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[t.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{children:s})]})]}),xe=({label:e,error:s,hint:r,rows:l=4,fullWidth:n=!0,className:i="",...o})=>t.jsxs("div",{className:"space-y-2 "+(n?"w-full":""),children:[e&&t.jsx("label",{className:"block text-sm font-medium text-neutral-300",children:e}),t.jsx("textarea",{rows:l,className:`\n          w-full rounded-xl border backdrop-blur-sm transition-all duration-300 resize-none\n          !bg-neutral-800/70 !text-white placeholder:text-neutral-400 p-4\n          ${s?"border-danger-500/50 focus:border-danger-500 focus:ring-danger-500/20":"border-neutral-700/50 focus:border-primary-500/50 focus:ring-primary-500/20"}\n          focus:outline-none focus:ring-2\n          ${i}\n        `,dir:"rtl",...o}),r&&!s&&t.jsx("p",{className:"text-xs text-neutral-500",children:r}),s&&t.jsxs("div",{className:"flex items-center gap-2 text-danger-400 text-sm",children:[t.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{children:s})]})]}),ue=({title:e,value:s,icon:a,color:r="primary",trend:l,subtitle:n})=>{const i={primary:{bg:"bg-primary-500/10",text:"text-primary-400",border:"border-primary-500/20",iconBg:"bg-primary-500/20"},success:{bg:"bg-success-500/10",text:"text-success-400",border:"border-success-500/20",iconBg:"bg-success-500/20"},warning:{bg:"bg-warning-500/10",text:"text-warning-400",border:"border-warning-500/20",iconBg:"bg-warning-500/20"},danger:{bg:"bg-danger-500/10",text:"text-danger-400",border:"border-danger-500/20",iconBg:"bg-danger-500/20"},neutral:{bg:"bg-neutral-500/10",text:"text-neutral-400",border:"border-neutral-500/20",iconBg:"bg-neutral-500/20"}}[r];return t.jsx(ie,{className:`${i.border} ${i.bg}`,variant:"glass",padding:"lg",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",dir:"rtl",children:[t.jsx("h3",{className:"text-xs md:text-sm font-medium text-neutral-400 mb-2 leading-tight",children:e}),t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("span",{className:`text-lg md:text-3xl font-bold ${i.text} leading-none`,children:s}),n&&t.jsx("span",{className:"text-xs text-neutral-500",children:n})]}),void 0!==l&&t.jsxs("div",{className:"mt-3 inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium\n                          "+(l>=0?"bg-success-500/10 border border-success-500/20 text-success-400":"bg-danger-500/10 border border-danger-500/20 text-danger-400"),children:[t.jsx("span",{children:l>=0?"↗":"↘"}),t.jsxs("span",{children:[Math.abs(l).toFixed(1),"%"]})]})]}),t.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center ${i.iconBg} flex-shrink-0`,children:t.jsx(a,{className:`w-5 h-5 md:w-6 md:h-6 ${i.text}`})})]})})},me=()=>{const{analytics:s,isLoading:a,isRefreshing:h,error:g,refreshAnalytics:b}=(()=>{const[s,t]=e.useState({totalSales:0,orderCount:0,topProducts:[],revenueChart:[]}),[a,r]=e.useState("week"),[l,n]=e.useState({startDate:null,endDate:null}),[i,o]=e.useState(!1),[d,c]=e.useState(!1),[x,u]=e.useState(null),{apiCall:m}=le(),h=e.useRef(null),g=e.useRef(!0),b=e.useCallback(async(e=a)=>{o(!0),u(null);try{const s=new URLSearchParams({period:e,...l.startDate&&{startDate:l.startDate.toISOString()},...l.endDate&&{endDate:l.endDate.toISOString()}}).toString(),a=await m(`/admin/analytics/dashboard?${s}`);return a&&t(a),a}catch(s){return u(s.message),null}finally{o(!1)}},[m,a,l]),p=e.useCallback(async()=>{if(!d){c(!0);try{await b()}finally{c(!1)}}},[b,d]),j=e.useCallback(e=>{g.current=e,!e&&h.current?(clearInterval(h.current),h.current=null):e&&!h.current&&(h.current=setInterval(p,3e5))},[p]),f=e.useCallback((e,s=null)=>{r(e),s&&n(s)},[]);return e.useEffect(()=>(g.current&&(h.current=setInterval(p,3e5)),b(),()=>{h.current&&clearInterval(h.current)}),[b,p]),e.useEffect(()=>{h.current&&clearInterval(h.current),g.current&&(h.current=setInterval(p,3e5))},[a,p]),{analytics:s,period:a,customDateRange:l,isLoading:i,isRefreshing:d,error:x,loadAnalytics:b,refreshAnalytics:p,toggleAutoRefresh:j,updatePeriod:f,setCustomDateRange:n}})(),p=e.useMemo(()=>{if(!s)return null;const e=(e,s)=>0===s?0:(e-s)/s*100;return{revenue:{current:s.totalSales,growth:e(s.revenueChart?.[s.revenueChart.length-1]?.revenue||0,s.revenueChart?.[s.revenueChart.length-2]?.revenue||0),color:"emerald"},orders:{current:s.orderCount,growth:e(s.orderCount,s.previousOrderCount||0),color:"blue"},avgOrderValue:{current:s.totalSales/s.orderCount,growth:e(s.totalSales/s.orderCount,s.previousAvgOrderValue||0),color:"amber"},customerRetention:{current:s.retention?.rate||0,growth:e(s.retention?.rate||0,s.retention?.previousRate||0),color:"purple"}}},[s]),j=e.useMemo(()=>{if(!s?.ordersByStatus)return[];const e={pending:"#FCD34D",processing:"#60A5FA",delivered:"#34D399",cancelled:"#F87171"};return Object.entries(s.ordersByStatus).map(([s,t])=>({status:s,count:t,color:e[s]}))},[s?.ordersByStatus]);return t.jsxs("div",{className:"min-h-screen bg-neutral-950 p-4 space-y-6",dir:"rtl",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-white md:hidden",children:"التحليلات"}),t.jsxs(oe,{onClick:b,disabled:h,variant:"outline",loading:h,children:[t.jsx(r,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm",children:"تحديث"})]})]}),a?t.jsx(pe,{}):g?t.jsx(je,{error:g,onRetry:b}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6",children:[t.jsx(ue,{title:"إجمالي المبيعات",value:`${p.revenue.current?.toLocaleString("ar-EG")} ج.م`,icon:l,color:"success",trend:p.revenue.growth}),t.jsx(ue,{title:"عدد الطلبات",value:p.orders.current,icon:n,color:"primary",trend:p.orders.growth}),t.jsx(ue,{title:"متوسط قيمة الطلب",value:`${p.avgOrderValue.current?.toLocaleString("ar-EG")} ج.م`,icon:i,color:"warning",trend:p.avgOrderValue.growth}),t.jsx(ue,{title:"معدل الاحتفاظ بالعملاء",value:`${p.customerRetention.current?.toFixed(1)}%`,icon:o,color:"neutral",trend:p.customerRetention.growth})]}),t.jsx(ge,{products:s.topProducts}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.jsx(he,{title:"توزيع حالات الطلبات",chart:t.jsx("div",{className:"flex items-center justify-center h-[250px] md:h-[300px] bg-gray-800/30 rounded-xl",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(c,{children:[t.jsx(x,{data:j,dataKey:"count",nameKey:"status",cx:"50%",cy:"50%",outerRadius:window.innerWidth<768?80:100,innerRadius:window.innerWidth<768?50:60,paddingAngle:5,children:j.map((e,s)=>t.jsx(u,{fill:e.color},s))}),t.jsx(m,{content:t.jsx(be,{})})]})})}),footer:t.jsx("div",{className:"grid grid-cols-2 gap-3 mt-4",children:j.map(({status:e,count:s,color:a})=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:a}}),t.jsx("span",{className:"text-xs md:text-sm text-gray-400 truncate",children:fe(e)}),t.jsx("span",{className:"text-xs md:text-sm font-bold text-white ml-auto",children:s})]},e))})})})]})]})},he=({title:e,chart:s,footer:a})=>t.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-xl rounded-2xl p-6 border border-gray-700/50 hover:border-gray-600/50 transition-all duration-300 hover:shadow-xl hover:shadow-black/20",children:[t.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),e]}),s,a]}),ge=({products:e})=>t.jsxs(ie,{variant:"glass",padding:"lg",children:[t.jsxs("h3",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-3",dir:"rtl",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-success-400"}),"أفضل المنتجات مبيعاً"]}),t.jsx("div",{className:"space-y-3 md:space-y-4",children:e?.map((e,s)=>t.jsx(ie,{variant:"default",padding:"md",className:"hover:border-primary-500/30",children:t.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[t.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-gradient-to-br from-primary-500 to-primary-600 \r\n                           flex items-center justify-center flex-shrink-0",children:t.jsxs("span",{className:"text-sm md:text-lg font-bold text-white",children:["#",s+1]})}),t.jsxs("div",{className:"flex-1 min-w-0",dir:"rtl",children:[t.jsx("h4",{className:"font-bold text-white truncate mb-1 text-sm md:text-base",children:e.name}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(n,{className:"w-3 h-3 md:w-4 md:h-4 text-neutral-400"}),t.jsxs("span",{className:"text-xs md:text-sm text-neutral-400",children:[e.quantity," قطعة"]})]}),t.jsxs("span",{className:"text-primary-400 font-bold text-sm md:text-base",children:[e.revenue.toLocaleString("ar-EG")," جنيه"]})]})]})]})},e.id))})]}),be=({active:e,payload:s,label:a})=>e&&s?.length?t.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-3",children:[a&&t.jsx("p",{className:"text-gray-400 mb-2",children:a}),s.map((e,s)=>t.jsxs("p",{className:"text-white",children:["number"==typeof e.value?e.value.toLocaleString("ar-EG"):e.value,"revenue"===e.name?" جنيه":""]},s))]}):null,pe=()=>t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center space-y-4 p-6 rounded-2xl bg-gray-800/50 backdrop-blur-xl border border-gray-700/50",children:[t.jsxs("div",{className:"relative",children:[t.jsx(h,{className:"w-12 h-12 text-blue-400 animate-spin mx-auto"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500/20 animate-ping"})]}),t.jsx("p",{className:"text-gray-300 font-medium",children:"جاري تحميل البيانات..."})]})}),je=({error:e,onRetry:s})=>t.jsx("div",{className:"text-center py-12",children:t.jsxs("div",{className:"inline-block p-6 rounded-2xl bg-gray-800/50 backdrop-blur-xl border border-gray-700/50 max-w-md",children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx(a,{className:"w-16 h-16 text-red-400 mx-auto"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500/20 animate-pulse"})]}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"عذراً، حدث خطأ ما"}),t.jsx("p",{className:"text-gray-400 mb-6 leading-relaxed",children:e}),t.jsx("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl",children:"إعادة المحاولة"})]})}),fe=e=>{switch(e){case"pending":return"معلق";case"processing":return"قيد التنفيذ";case"delivered":return"تم التسليم";case"cancelled":return"ملغي";default:return"غير معروف"}},ve=({variant:e,variantIndex:s,onImageUpload:r,onImageRemove:l,isUploading:n,uploadProgress:i,error:o})=>{const d=i[s]||0;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الصور"}),n&&d>0&&t.jsxs("span",{className:"text-sm text-blue-500",children:[Math.round(d),"% تم الرفع"]})]}),t.jsxs("div",{className:"flex gap-4 overflow-x-auto hide-scrollbar pb-2",children:[e.images.map((a,r)=>t.jsxs("div",{className:"relative flex-shrink-0 w-24 h-24 rounded-xl overflow-hidden group",children:[t.jsx("img",{src:a,alt:`${e.colorName} - ${r+1}`,className:"w-full h-full object-cover transition-transform \r\n                       group-hover:scale-105"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 \r\n                          to-transparent opacity-0 group-hover:opacity-100 \r\n                          transition-opacity"}),t.jsx("button",{type:"button",onClick:()=>l(s,r),className:"absolute top-1 right-1 p-1.5 bg-black/50 rounded-lg\r\n                       opacity-0 group-hover:opacity-100 transition-opacity\r\n                       hover:bg-red-500/20",children:t.jsx(g,{className:"w-4 h-4 text-white group-hover:text-red-500"})})]},r)),t.jsxs("label",{className:"relative flex-shrink-0 w-24 h-24 flex items-center \n                    justify-center rounded-xl cursor-pointer group \n                    transition-all duration-300 border-2 border-dashed\n                    "+(n?"bg-blue-500/10 border-blue-500/30":"bg-gray-800/50 border-gray-700 hover:border-blue-500"),children:[t.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async e=>{const t=Array.from(e.target.files);if(t?.length){try{await r(s,t)}catch(a){}e.target.value=""}},disabled:n}),n&&d>0?t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("svg",{className:"w-12 h-12",viewBox:"0 0 36 36",children:t.jsx("path",{d:"M18 2.0845\r\n                    a 15.9155 15.9155 0 0 1 0 31.831\r\n                    a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${d}, 100`,className:"text-blue-500"})})}):t.jsx(b,{className:"w-6 h-6 transition-colors duration-300\n                      "+(n?"text-blue-500 animate-pulse":"text-gray-400 group-hover:text-blue-500")})]})]}),o&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-500",children:[t.jsx(a,{className:"w-4 h-4"}),t.jsx("p",{children:o})]})]})},ye=[{label:"أسود",value:"black",code:"#000000"},{label:"أبيض",value:"white",code:"#FFFFFF"},{label:"أحمر",value:"red",code:"#FF0000"},{label:"أخضر",value:"green",code:"#008000"},{label:"أزرق",value:"blue",code:"#0000FF"},{label:"أصفر",value:"yellow",code:"#FFFF00"},{label:"برتقالي",value:"orange",code:"#FFA500"},{label:"بنفسجي",value:"purple",code:"#800080"},{label:"وردي",value:"pink",code:"#FFC0CB"},{label:"رمادي",value:"gray",code:"#808080"},{label:"بني",value:"brown",code:"#A52A2A"},{label:"ذهبي",value:"gold",code:"#FFD700"},{label:"فضي",value:"silver",code:"#C0C0C0"}],Ne=()=>{const{products:a,filters:r,isLoading:l,isDeleting:n,error:i,deleteError:o,fetchProducts:d,createProduct:c,updateProduct:x,deleteProduct:u,uploadProductImages:m,updateFilters:h}=ne(),[b,w]=e.useState("list"),[C,k]=e.useState(null),[S,P]=e.useState(!1),[E,$]=e.useState(!1),[D,U]=e.useState(!1),F=s.useMemo(()=>a?.length?a.reduce((e,s)=>(e.total++,"active"===s.status&&e.active++,s.variants.some(e=>e.sizes.every(e=>!e.inStock))&&e.outOfStock++,e.revenue+=s.salesCount*s.basePrice,e),{total:0,active:0,outOfStock:0,revenue:0}):{total:0,active:0,outOfStock:0,revenue:0},[a]),z=e=>{h({search:e})};return t.jsxs("div",{className:"min-h-screen bg-neutral-950 pb-20",dir:"rtl",children:[t.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[t.jsx("h1",{className:"text-xl font-bold text-white",children:"المنتجات"}),t.jsx(oe,{onClick:()=>P(!0),variant:"primary",size:"sm",children:t.jsx(p,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-4 md:p-6 grid grid-cols-2 gap-3 md:gap-6",children:[t.jsx(ue,{title:"إجمالي المنتجات",value:F.total,icon:j,color:"primary"}),t.jsx(ue,{title:"منتجات نشطة",value:F.active,icon:f,color:"success"})]}),t.jsxs("div",{className:"sticky top-0 md:top-16 z-30 bg-neutral-950/95 backdrop-blur-xl p-4 md:p-6 \r\n                     space-y-4 md:space-y-6 border-b border-neutral-800/50 shadow-2xl shadow-black/20",children:[t.jsxs("div",{className:"hidden md:flex items-center justify-between gap-4",children:[t.jsxs(oe,{onClick:()=>P(!0),variant:"primary",children:[t.jsx(p,{className:"w-5 h-5"}),t.jsx("span",{children:"إضافة منتج"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{onClick:()=>w("grid"),variant:"grid"===b?"primary":"secondary",size:"sm",children:t.jsx(v,{className:"w-5 h-5"})}),t.jsx(oe,{onClick:()=>w("list"),variant:"list"===b?"primary":"secondary",size:"sm",children:t.jsx(y,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx(de,{value:r.search,onChange:e=>z(e.target.value),placeholder:"ابحث عن منتج..."}),t.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400 pointer-events-none"}),r.search&&t.jsx("button",{onClick:()=>z(""),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r\n                       hover:bg-neutral-700/50 transition-colors",children:t.jsx(g,{className:"w-4 h-4 text-neutral-400"})})]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",children:ze.map(e=>t.jsxs(oe,{onClick:()=>(e=>{h({category:e})})(e.id),variant:r.category===e.id?"primary":"ghost",size:"sm",className:"whitespace-nowrap",children:[t.jsx(e.icon,{className:"w-4 h-4"}),t.jsx("span",{children:e.label})]},e.id))}),t.jsxs("div",{className:"md:hidden flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-neutral-400",children:[a.length," منتج"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{onClick:()=>w("grid"),variant:"grid"===b?"primary":"secondary",size:"sm",children:t.jsx(v,{className:"w-5 h-5"})}),t.jsx(oe,{onClick:()=>w("list"),variant:"list"===b?"primary":"secondary",size:"sm",children:t.jsx(y,{className:"w-5 h-5"})})]})]})]}),t.jsx("div",{className:"p-4 "+("grid"===b?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4":"space-y-3 md:space-y-4"),children:l?t.jsx(De,{}):i?t.jsx(Ue,{message:i}):0===a.length?t.jsx(Fe,{}):a.map(e=>"grid"===b?t.jsx(Ee,{product:e,onEdit:()=>{k(e),$(!0)},onDelete:()=>{k(e),U(!0)}},e.id):t.jsx(Ce,{product:e,onEdit:()=>{k(e),$(!0)},onDelete:()=>{k(e),U(!0)}},e.id))}),S&&t.jsx(we,{onClose:()=>P(!1),onSubmit:async(e,s)=>{try{await c(e,s)&&(P(!1),await d())}catch(t){}},uploadImages:m,ediState:E}),E&&C&&t.jsx(we,{product:C,onClose:()=>{$(!1),k(null)},onSubmit:(e,s)=>(async(e,s,t)=>{try{await x(e,s,t)&&($(!1),k(null),await d())}catch(a){}})(C.id,e,s),uploadImages:m,editeState:E}),D&&C&&t.jsx($e,{product:C,onClose:()=>{U(!1),k(null)},onConfirm:()=>(async e=>{await u(e)&&(U(!1),k(null),await d())})(C.id),isDeleting:n,error:o})]})},we=({product:s,onClose:r,onSubmit:l,uploadImages:n,ediState:i=!0})=>{const[o,d]=e.useState({id:"",name:"",code:"",category:"",description:"",basePrice:"",discountPrice:"",status:"active",features:[],tag:"",tagColor:"",variants:[{id:"",product_id:"",colorName:"",colorCode:"#000000",images:[],sizes:[{size:"",quantity:0}]}],_imageFiles:{}}),[c,x]=e.useState({}),[u,m]=e.useState(!1),{handleFormImageUpload:h,clearImageFiles:b,uploadErrors:j,isUploading:v,uploadProgress:y}=(s=>{const[t,a]=e.useState({}),[r,l]=e.useState(!1),[n,i]=e.useState({});return{handleFormImageUpload:e.useCallback(async(e,t,r)=>{if(!r?.length)return t;l(!0),a({}),i(s=>({...s,[e]:0}));try{const a=t.variants[e].colorName;if(!a.trim())throw new Error("يجب إدخال اسم اللون قبل رفع الصور");if(!t.code)return{...t,_imageFiles:{...t._imageFiles,[e]:r}};const l=await s(t.code,a,r,s=>{i(t=>({...t,[e]:s}))});return{...t,variants:t.variants.map((s,t)=>t===e?{...s,images:[...s.images,...l]}:s)}}catch(n){throw a(s=>({...s,[e]:n.message})),n}finally{l(!1),i(s=>({...s,[e]:0}))}},[s]),clearImageFiles:e.useCallback(e=>{const{_imageFiles:s,...t}=e;return{cleanData:t,imageFiles:s||{}}},[]),uploadErrors:t,isUploading:r,uploadProgress:n,setUploadErrors:a,setUploadProgress:i}})(n);e.useEffect(()=>{s&&d({id:s.id||"",name:s.name,code:s.code,category:s.category,description:s.description||"",basePrice:s.basePrice.toString(),discountPrice:s.discountPrice?.toString()||"",status:s.status,tag:s.tag,_imageFiles:{},tagColor:s.tagColor,features:s.features,variants:s.variants.map(e=>({product_id:s.id,id:e.id,colorName:e.colorName,colorCode:e.colorCode,images:e.images,sizes:e.sizes.map(e=>({size:e.size,quantity:e.quantity}))}))})},[s]);const N=e=>{const{name:s,value:t}=e.target;d(e=>({...e,[s]:t})),x(e=>({...e,[s]:""}))},w=(e,s,t)=>{d(a=>({...a,variants:a.variants.map((a,r)=>r===e?{...a,[s]:t}:a)}))},C=(e,s,t,a)=>{d(r=>({...r,variants:r.variants.map((r,l)=>l===e?{...r,sizes:r.sizes.map((e,r)=>r===s?{...e,[t]:a}:e)}:r)}))},k=async(e,s)=>{try{const t=await h(e,o,s);d(t)}catch(t){}},S=(e,s)=>{d(t=>({...t,variants:t.variants.map((t,a)=>a===e?{...t,images:t.images.filter((e,t)=>t!==s)}:t)}))};return t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),t.jsx("div",{className:"relative bg-neutral-900 rounded-xl md:rounded-2xl w-full max-w-full md:max-w-3xl \r\n                    h-full md:max-h-[95vh] overflow-y-auto hide-scrollbar border border-neutral-700/50 backdrop-blur-xl",children:t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return o.name.trim()||(e.name="اسم المنتج مطلوب"),o.category||(e.category="الفئة مطلوبة"),o.basePrice||(e.basePrice="السعر الأساسي مطلوب"),isNaN(parseFloat(o.basePrice))&&(e.basePrice="السعر يجب أن يكون رقماً"),o.discountPrice&&isNaN(parseFloat(o.discountPrice))&&(e.discountPrice="سعر الخصم يجب أن يكون رقماً"),o.variants.forEach((s,t)=>{s.colorName||(e[`variant${t}Color`]="اللون مطلوب"),s.sizes.forEach((s,a)=>{s.size||(e[`variant${t}Size${a}`]="المقاس مطلوب"),isNaN(parseInt(s.quantity))&&(e[`variant${t}Quantity${a}`]="الكمية يجب أن تكون رقماً")})}),x(e),0===Object.keys(e).length})()){m(!0);try{const{cleanData:e,imageFiles:s}=b(o),t={...e,id:e.id,name:e.name,code:e.code,category:e.category,description:e.description||"",basePrice:e.basePrice.toString(),discountPrice:e.discountPrice?.toString()||"",status:e.status,tag:e.tag,imageFiles:e.imageFiles,tagColor:e.tagColor,...e.features?.length?{features:e.features}:{},variants:e.variants.map(s=>({id:s.id,product_id:e.id,colorName:s.colorName,colorCode:s.colorCode,images:s.images,sizes:s.sizes.map(e=>({size:e.size,quantity:parseInt(e.quantity)}))}))};await l(t,s),m(!1),r()}catch(s){x(e=>({...e,submit:s.message}))}finally{m(!1)}}},className:"space-y-4 md:space-y-6 p-4 md:p-6",children:[t.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-neutral-900 py-2 -mx-4 md:-mx-6 px-4 md:px-6 border-b border-neutral-800/50",dir:"ltr",children:[t.jsx("button",{type:"button",onClick:r,className:"p-2 hover:bg-neutral-800/50 rounded-xl transition-colors",children:t.jsx(g,{className:"w-6 h-6 text-neutral-400"})}),t.jsx("h2",{className:"text-lg md:text-xl font-bold text-white",dir:"rtl",children:s?"تعديل منتج":"إضافة منتج"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(ke,{label:"اسم المنتج",name:"name",value:o.name,onChange:N,error:c.name}),t.jsx(Pe,{label:"الفئة",name:"category",value:o.category,onChange:N,error:c.category,options:[{value:"men",label:"رجالي"},{value:"women",label:"حريمي"},{value:"bags",label:"حقائب"}]}),t.jsx(Se,{label:"الوصف",name:"description",value:o.description,onChange:N,error:c.description}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(ke,{label:"السعر الأساسي",name:"basePrice",type:"number",value:o.basePrice,onChange:N,error:c.basePrice}),t.jsx(ke,{label:"سعر الخصم (اختياري)",name:"discountPrice",type:"number",value:o.discountPrice,onChange:N,error:c.discountPrice})]}),t.jsx(Pe,{label:"الحالة",name:"status",value:o.status,onChange:N,error:c.status,options:[{value:"active",label:"نشط"},{value:"inactive",label:"غير نشط"}]})]}),t.jsx("div",{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(ke,{label:"العلامة (اختياري)",name:"tag",type:"text",value:o.tag,onChange:e=>d({...o,tag:e.target.value}),error:c.discountPrice}),t.jsx(Pe,{label:"لون العلامة",name:"tagColor",value:o.tagColor,onChange:e=>d({...o,tagColor:e.target.value}),error:c.status,options:[{label:"أزرق",value:"#3B82F6"},{label:"أخضر",value:"#10B981"},{label:"أحمر",value:"#EF4444"},{label:"أصفر",value:"#F59E0B"},{label:"بنفسجي",value:"#8B5CF6"},{label:"رمادي",value:"#64748B"},{label:"وردي",value:"#EC4899"},{label:"سماوي",value:"#0EA5E9"}]})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-bold text-white",children:"المميزات (اختياري)"}),t.jsx("button",{type:"button",onClick:()=>d(e=>({...e,features:[...e.features,""]})),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r\n                 hover:bg-blue-500/20 transition-colors",children:t.jsx(p,{className:"w-5 h-5"})})]}),o.features?.map((e,s)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ke,{value:e,onChange:e=>((e,s)=>{d(t=>({...t,features:t.features.map((t,a)=>a===e?s:t)}))})(s,e.target.value),placeholder:"أدخل ميزة المنتج..."}),t.jsx("button",{type:"button",onClick:()=>(e=>d(s=>({...s,features:s.features.filter((s,t)=>t!==e)})))(s),className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r\n                   hover:bg-red-500/20 transition-colors",children:t.jsx(P,{className:"w-5 h-5"})})]},s))]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-bold text-white",children:"الألوان والمقاسات"}),t.jsx("button",{type:"button",onClick:()=>d(e=>({...e,variants:[...e.variants,{id:"",product_id:"",colorName:"",colorCode:"#000000",images:[],sizes:[{size:"",quantity:0}]}]})),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r\n                         hover:bg-blue-500/20 transition-colors",children:t.jsx(p,{className:"w-5 h-5"})})]}),o.variants.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-4 space-y-4",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4 pb-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1",children:[t.jsx(Pe,{label:"اللون",value:e.colorName,onChange:e=>{const t=ye.find(s=>s.value===e.target.value);w(s,"colorName",e.target.value),w(s,"colorCode",t?.code||"#000000")},error:c[`variant${s}Color`],options:ye}),t.jsx(ke,{label:"كود اللون",type:"color",value:e.colorCode,onChange:e=>w(s,"colorCode",e.target.value)})]}),o.variants.length>1&&t.jsx("button",{type:"button",onClick:()=>{return e=s,d(s=>({...s,variants:s.variants.filter((s,t)=>t!==e)}));var e},className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r\n                              hover:bg-red-500/20 transition-colors md:mr-4 self-start",children:t.jsx(P,{className:"w-5 h-5"})})]}),i&&t.jsx(ve,{variant:e,variantIndex:s,onImageUpload:k,onImageRemove:S,isUploading:v,uploadProgress:y,error:j[s]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h4",{className:"font-medium text-white",children:"المقاسات"}),t.jsx("button",{type:"button",onClick:()=>(e=>d(s=>({...s,variants:s.variants.map((s,t)=>t===e?{...s,sizes:[...s.sizes,{size:"",quantity:0}]}:s)})))(s),className:"p-2 bg-blue-500/10 text-blue-500 rounded-xl\r\n                               hover:bg-blue-500/20 transition-colors",children:t.jsx(p,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"space-y-3",children:e.sizes.map((a,r)=>t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{placeholder:"المقاس",value:a.size,onChange:e=>C(s,r,"size",e.target.value),error:c[`variant${s}Size${r}`]})}),t.jsx("div",{className:"flex-1",children:t.jsx(ke,{type:"number",placeholder:"الكمية",value:a.quantity,onChange:e=>C(s,r,"quantity",e.target.value),error:c[`variant${s}Quantity${r}`]})}),e.sizes.length>1&&t.jsx("button",{type:"button",onClick:()=>((e,s)=>d(t=>({...t,variants:t.variants.map((t,a)=>a===e?{...t,sizes:t.sizes.filter((e,t)=>t!==s)}:t)})))(s,r),className:"p-2 bg-red-500/10 text-red-500 rounded-xl\r\n                                     hover:bg-red-500/20 transition-colors self-start",children:t.jsx(P,{className:"w-5 h-5"})})]},r))})]})]},s))]}),c.submit&&t.jsxs("div",{className:"bg-red-500/10 text-red-500 p-4 rounded-xl flex items-center gap-2",children:[t.jsx(a,{className:"w-5 h-5"}),t.jsx("p",{children:c.submit})]}),t.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-neutral-900 border-t border-neutral-800/50 \r\n                         -mx-4 md:-mx-6 px-4 md:px-6 py-4 flex gap-3 md:gap-4",children:[t.jsx(oe,{type:"button",onClick:r,variant:"secondary",className:"flex-1 md:flex-none",children:"إلغاء"}),t.jsx(oe,{type:"submit",disabled:u||v,variant:"primary",loading:u,className:"flex-1 md:flex-none",children:u?t.jsx("span",{children:"جاري الحفظ..."}):t.jsxs(t.Fragment,{children:[t.jsx(f,{className:"w-5 h-5"}),t.jsx("span",{children:"حفظ"})]})})]})]})})]})},Ce=({product:e,onEdit:s,onDelete:a})=>{e.variants[0]?.images[0];const r=e.variants.reduce((e,s)=>e+s.sizes.reduce((e,s)=>e+s.quantity,0),0),l=e.variants.length,i=e.variants.reduce((e,s)=>e+s.sizes.length,0);return t.jsxs("div",{className:"group bg-gray-800/30 rounded-2xl p-4 \r\n                  border border-gray-700/50 hover:border-blue-500/30\r\n                  transition-all duration-300",dir:"ltr",children:[t.jsxs("div",{className:"flex gap-4",dir:"rtl",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex justify-between items-start gap-4",dir:"ltr",children:[t.jsx("div",{className:"px-2 py-1 rounded-full text-xs font-medium\n                         "+("active"===e.status?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"),children:"active"===e.status?"نشط":"غير نشط"}),t.jsxs("div",{className:"text-right",children:[t.jsx("h3",{className:"font-bold text-white group-hover:text-blue-500 \r\n                           transition-colors",children:e.name}),t.jsxs("p",{className:"text-sm text-gray-400",dir:"rtl",children:["كود: ",e.code]})]})]}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-x-6 gap-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{className:"w-4 h-4 text-blue-500"}),t.jsxs("span",{className:"text-blue-500 font-bold",children:[e.basePrice.toLocaleString("ar-EG")," جنيه"]}),e.discountPrice&&t.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[e.discountPrice.toLocaleString("ar-EG")," جنيه"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(n,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:"text-gray-400",children:["المخزون: ",r]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-amber-500",style:{backgroundColor:e.variants[0]?.colorCode}}),t.jsxs("span",{className:"text-gray-400",children:[l," لون, ",i," مقاس"]})]})]}),e.features?.length>0&&t.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.features.slice(0,3).map((e,s)=>t.jsx("span",{className:"px-2 py-1 rounded-lg bg-gray-800 text-gray-400 \r\n                               text-sm",children:e},s)),e.features.length>3&&t.jsxs("span",{className:"px-2 py-1 rounded-lg bg-gray-800 text-gray-400 \r\n                               text-sm",children:["+",e.features.length-3]})]})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("button",{onClick:s,className:"p-2 rounded-xl bg-blue-500/10 text-blue-500\r\n                     hover:bg-blue-500/20 transition-colors",children:t.jsx(S,{className:"w-5 h-5"})}),t.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-red-500/10 text-red-500\r\n                     hover:bg-red-500/20 transition-colors",children:t.jsx(P,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700/50",children:t.jsx("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar pb-2",children:e.variants.map((e,s)=>t.jsxs("div",{className:"flex-shrink-0 group/variant cursor-pointer",children:[t.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:[t.jsx("img",{src:e.images[0],alt:e.colorName,className:"w-full h-full object-cover transform transition-transform\r\n                           duration-500 group-hover/variant:scale-110"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t \r\n                               from-black/50 to-transparent"}),t.jsx("div",{className:"absolute bottom-1 right-1 w-3 h-3 rounded-full",style:{backgroundColor:e.colorCode}})]}),t.jsxs("div",{className:"mt-1 text-center",children:[t.jsx("p",{className:"text-sm text-gray-400",children:e.colorName}),t.jsxs("p",{className:"text-xs text-gray-500",children:[e.sizes.length," مقاس"]})]})]},s))})})]})},ke=s.forwardRef(({label:e,error:s,type:a="text",className:r="",...l},n)=>t.jsx(de,{ref:n,label:e,error:s,type:a,className:r,...l}));ke.displayName="Input";const Se=({label:e,error:s,className:a="",...r})=>t.jsx(xe,{label:e,error:s,className:a,...r}),Pe=({label:e,error:s,options:a=[],className:r="",...l})=>t.jsx(ce,{label:e,error:s,options:a,className:r,...l}),Ee=({product:e,onEdit:s,onDelete:a})=>{const r=e.variants[0]?.images[0],l=e.variants.reduce((e,s)=>e+s.sizes.reduce((e,s)=>e+s.quantity,0),0);return t.jsxs(ie,{variant:"default",padding:"md",className:"border-neutral-700/50 hover:border-primary-500/30 group space-y-3 md:space-y-4",children:[t.jsxs("div",{className:"relative aspect-square rounded-lg md:rounded-xl overflow-hidden",children:[t.jsx("img",{src:r,alt:e.name,className:"w-full h-full object-cover transform transition-transform\r\n                   duration-500 group-hover:scale-110"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),t.jsx("div",{className:"absolute top-1 md:top-2 right-1 md:right-2",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium\n                        "+("active"===e.status?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"),children:"active"===e.status?"نشط":"غير نشط"})}),t.jsxs("div",{className:"absolute bottom-1 md:bottom-2 left-1 md:left-2 flex gap-1 md:gap-2 \r\n                     opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:s,className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-blue-500/20 text-blue-500\r\n                         hover:bg-blue-500/30 transition-colors",children:t.jsx(S,{className:"w-4 h-4 md:w-5 md:h-5"})}),t.jsx("button",{onClick:a,className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-red-500/20 text-red-500\r\n                         hover:bg-red-500/30 transition-colors",children:t.jsx(P,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"font-bold text-white text-sm md:text-base truncate",children:e.name}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs md:text-sm text-neutral-400",children:["المخزون: ",l]}),t.jsxs("span",{className:"text-primary-500 font-bold text-sm md:text-base",children:[e.basePrice.toLocaleString("ar-EG")," جنيه"]})]})]})]})},$e=({product:e,onClose:s,onConfirm:r})=>t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),t.jsx(ie,{variant:"elevated",padding:"lg",className:"w-full max-w-md space-y-4",children:t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("div",{className:"w-16 h-16 mx-auto rounded-full bg-danger-500/10 flex items-center justify-center",children:t.jsx(a,{className:"w-8 h-8 text-danger-500"})}),t.jsx("h2",{className:"text-xl font-bold text-white",dir:"rtl",children:"تأكيد الحذف"}),t.jsxs("p",{className:"text-neutral-400",dir:"rtl",children:['هل أنت متأكد من حذف المنتج "',e.name,'"؟',t.jsx("br",{}),"لا يمكن التراجع عن هذا الإجراء."]}),t.jsxs("div",{className:"flex gap-4 pt-2",children:[t.jsx(oe,{onClick:s,variant:"secondary",className:"flex-1",children:"إلغاء"}),t.jsx(oe,{onClick:r,variant:"danger",className:"flex-1",children:"حذف"})]})]})})]}),De=()=>t.jsx("div",{className:"col-span-full flex items-center justify-center py-12",children:t.jsxs("div",{className:"space-y-4 text-center",children:[t.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 \r\n                    border-t-transparent rounded-full mx-auto"}),t.jsx("p",{className:"text-gray-400",children:"جاري تحميل المنتجات..."})]})}),Ue=({message:e})=>t.jsxs("div",{className:"col-span-full text-center py-12",children:[t.jsx(a,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),t.jsx("p",{className:"text-gray-400",children:e})]}),Fe=()=>t.jsxs("div",{className:"col-span-full text-center py-12",children:[t.jsx(k,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد منتجات"}),t.jsx("p",{className:"text-gray-400",children:"لم يتم العثور على منتجات تطابق معايير البحث"})]}),ze=[{id:"all",label:"الكل",icon:j},{id:"men",label:"رجالي",icon:w},{id:"women",label:"حريمي",icon:C}],Le=()=>{const{orders:s,selectedOrder:a,page:r,totalPages:i,filters:o,isLoading:d,error:c,setSelectedOrder:x,updateFilters:u,updateOrderStatus:m,nextPage:h,previousPage:g}=(()=>{const[s,t]=e.useState([]),[a,r]=e.useState(0),[l,n]=e.useState(null),[i,o]=e.useState(1),[d,c]=e.useState(0),[x,u]=e.useState(20),[m,h]=e.useState({status:"all",startDate:null,endDate:null,search:""}),[g,b]=e.useState(!1),[p,j]=e.useState(!1),[f,v]=e.useState(null),[y,N]=e.useState(null),{apiCall:w}=le(),C=e.useRef([]),k=e.useCallback(async(e=i,s=m)=>{b(!0),v(null);try{const a=new URLSearchParams({page:e,perPage:x,...s,...s.startDate&&{startDate:s.startDate.toISOString()},...s.endDate&&{endDate:s.endDate.toISOString()}}).toString(),l=await w(`/admin/orders?${a}`);return l?.orders&&(t(l.orders),r(l.total),c(l.pages),C.current=l.orders),l}catch(a){return v(a.message),null}finally{b(!1)}},[w,i,x,m]),S=e.useCallback(async(e,a)=>{j(!0),N(null);const r=[...s];try{t(s.map(s=>s.id===e?{...s,status:a}:s));const l=await w(`/admin/orders/${e}/status`,{method:"PUT",body:JSON.stringify({status:a})});if(!l)throw t(r),new Error("Failed to update order status");return await k(),l}catch(l){return N(l.message),t(r),null}finally{j(!1)}},[w,s,k]),P=e.useCallback(e=>{h(s=>({...s,...e})),o(1)},[]),E=e.useCallback(()=>{i<d&&o(e=>e+1)},[i,d]),$=e.useCallback(()=>{i>1&&o(e=>e-1)},[i]);return e.useEffect(()=>{k()},[i,m,k]),{orders:s,totalOrders:a,selectedOrder:l,page:i,totalPages:d,perPage:x,filters:m,isLoading:g,isUpdatingStatus:p,error:f,updateStatusError:y,setSelectedOrder:n,setPage:o,setPerPage:u,updateFilters:P,loadOrders:k,updateOrderStatus:S,nextPage:E,previousPage:$}})(),[b,p]=e.useState(!1),j=e.useMemo(()=>{if(!s.length)return null;const e=s.reduce((e,s)=>e+s.total,0),t=s.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{}),a=e/s.length;return{totalRevenue:e,totalOrders:s.length,pendingOrders:t.pending||0,processingOrders:t.processing||0,avgOrderValue:a}},[s]);return t.jsxs("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[t.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[t.jsx("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"الطلبات"}),t.jsxs("span",{className:"text-sm text-neutral-400",children:[j?.totalOrders||0," طلب"]})]}),t.jsxs("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[t.jsx(Oe,{title:"إجمالي المبيعات",value:(j?.totalRevenue?.toLocaleString("ar-EG")||0)+" جنيه",icon:l,color:"emerald"}),t.jsx(Oe,{title:"عدد الطلبات",value:j?.totalOrders||0,icon:n,color:"blue"}),t.jsx(Oe,{title:"متوسط قيمة الطلب",value:(j?.avgOrderValue?.toLocaleString("ar-EG")||0)+" جنيه",icon:$,color:"amber"}),t.jsx(Oe,{title:"طلبات معلقة",value:j?.pendingOrders||0,icon:D,color:"red"})]}),t.jsxs("div",{className:"sticky top-0 md:top-16 z-30 bg-neutral-950/95 backdrop-blur-xl p-4 space-y-4 \r\n                           border-b border-neutral-800/50",children:[t.jsx(Ie,{value:o.search,onChange:e=>u({search:e})}),t.jsx(Re,{activeStatus:o.status,onStatusChange:e=>u({status:e})})]}),t.jsx("div",{className:"p-4 space-y-3 md:space-y-4",children:d?t.jsx(qe,{}):c?t.jsx(_e,{message:c}):0===s.length?t.jsx(Me,{}):s.map(e=>t.jsx(Te,{order:e,onClick:()=>{x(e),p(!0)}},e.id))}),a&&t.jsx(Ae,{order:a,isOpen:b,onClose:()=>{p(!1),x(null)},onUpdateStatus:m}),i>1&&t.jsx(Ve,{page:r,totalPages:i,onNext:h,onPrevious:g})]})},Oe=({title:e,value:s,icon:a,color:r})=>{const l={emerald:{bg:"bg-emerald-500/10",text:"text-emerald-500",border:"border-emerald-500/20"},blue:{bg:"bg-blue-500/10",text:"text-blue-500",border:"border-blue-500/20"},amber:{bg:"bg-amber-500/10",text:"text-amber-500",border:"border-amber-500/20"},red:{bg:"bg-red-500/10",text:"text-red-500",border:"border-red-500/20"}}[r];return t.jsxs("div",{className:`relative overflow-hidden rounded-xl md:rounded-2xl p-3 md:p-4 \n                        ${l.bg} border ${l.border}`,dir:"rtl",children:[t.jsx("div",{className:"absolute top-2 md:top-4 left-2 md:left-4",children:t.jsx(a,{className:`w-5 h-5 md:w-6 md:h-6 ${l.text}`})}),t.jsxs("div",{className:"mt-5 md:mt-6",children:[t.jsx("h3",{className:"text-xs md:text-sm font-medium text-gray-400 leading-tight",children:e}),t.jsx("div",{className:"mt-1 md:mt-2",children:t.jsx("span",{className:`text-lg md:text-2xl font-bold ${l.text}`,children:s})})]})]})},Ie=({value:e,onChange:s})=>t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:e,onChange:e=>s(e.target.value),placeholder:"ابحث برقم الطلب أو رقم الهاتف...",className:"w-full h-12 bg-gray-800/50 rounded-xl px-12 text-white text-right\r\n                 border border-gray-700/50 focus:border-blue-500/50\r\n                 focus:ring-2 focus:ring-blue-500/50\r\n                 placeholder:text-gray-500",dir:"rtl"}),t.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e&&t.jsx("button",{onClick:()=>s(""),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r\n                   hover:bg-gray-700/50 transition-colors",children:t.jsx(g,{className:"w-4 h-4 text-gray-400"})})]}),Re=({activeStatus:e,onStatusChange:s})=>{const a=[{id:"all",label:"الكل",icon:n},{id:"pending",label:"معلق",icon:D},{id:"processing",label:"قيد التنفيذ",icon:r},{id:"delivered",label:"تم التسليم",icon:U},{id:"cancelled",label:"ملغي",icon:F}];return t.jsx("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",dir:"rtl",children:a.map(({id:a,label:r,icon:l})=>t.jsxs("button",{onClick:()=>s(a),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm\n                     whitespace-nowrap transition-colors\n                     "+(e===a?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[t.jsx(l,{className:"w-4 h-4"}),t.jsx("span",{children:r})]},a))})},Te=({order:e,onClick:s})=>{const a={pending:{icon:D,color:"text-yellow-500",bgColor:"bg-yellow-500/10",label:"معلق"},processing:{icon:r,color:"text-blue-500",bgColor:"bg-blue-500/10",label:"قيد التنفيذ"},delivered:{icon:U,color:"text-green-500",bgColor:"bg-green-500/10",label:"تم التسليم"},cancelled:{icon:F,color:"text-red-500",bgColor:"bg-red-500/10",label:"ملغي"}}[e.status]||{icon:n,color:"text-gray-500",bgColor:"bg-gray-500/10",label:"غير معروف"},l=a.icon,i=e.userPhone||e.user?.phone_number,o=e.userName||e.user?.name,d=e.total||0,c=e.createdAt||e.created_at;return t.jsxs("div",{onClick:s,className:"group bg-gray-800/30 rounded-xl md:rounded-2xl p-3 md:p-4 space-y-3 md:space-y-4 cursor-pointer\r\n                  border border-gray-700/50 hover:border-blue-500/30\r\n                  transition-all duration-300 relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800/0 to-gray-800/50 opacity-0 \r\n                      group-hover:opacity-100 transition-opacity duration-500"}),t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-3 md:gap-4",children:[t.jsxs("div",{className:`flex items-center gap-2 px-2 md:px-3 py-1.5 rounded-full self-start\n                          ${a.color} ${a.bgColor} border border-transparent\n                          transition-all duration-300 group-hover:border-current/20`,children:[t.jsx(l,{className:"w-3 h-3 md:w-4 md:h-4 "+("processing"===e.status?"group-hover:animate-spin":"")}),t.jsx("span",{className:"text-xs md:text-sm font-medium",children:a.label})]}),t.jsxs("div",{className:"text-right flex-1 min-w-0",children:[o&&t.jsx("h3",{className:"font-bold text-white text-sm md:text-base truncate group-hover:text-blue-500\r\n                             transition-colors duration-300",children:o}),i&&t.jsx("p",{className:"text-xs md:text-sm text-gray-400 mt-0.5",dir:"ltr",children:i}),c&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c).toLocaleString("ar-EG",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 md:pt-4 border-t border-gray-700/50 mt-3 md:mt-4",children:[t.jsx("div",{className:"flex gap-1 md:gap-2",children:i&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),i&&window.open(`https://wa.me/${i}`,"_blank")},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-green-500/10\r\n                            border border-transparent hover:border-green-500/30\r\n                            transition-all duration-300 group/btn",title:"واتساب",children:t.jsx(z,{className:"w-4 h-4 md:w-5 md:h-5 text-green-500 transition-transform duration-300\r\n                                          group-hover/btn:scale-110"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),i&&window.open(`tel:${i}`,"_blank")},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r\n                            border border-transparent hover:border-blue-500/30\r\n                            transition-all duration-300 group/btn",title:"اتصال",children:t.jsx(L,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500 transition-transform duration-300\r\n                                  group-hover/btn:scale-110"})}),t.jsx("button",{onClick:async e=>{if(e.stopPropagation(),i)try{await navigator.clipboard.writeText(i)}catch(s){}},className:"p-1.5 md:p-2 rounded-lg md:rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r\n                            border border-transparent hover:border-blue-500/30\r\n                            transition-all duration-300 group/btn",title:"نسخ رقم الهاتف",children:t.jsx(O,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500 transition-transform duration-300\r\n                                 group-hover/btn:scale-110"})})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"block font-bold text-blue-500 text-sm md:text-lg",children:[d.toLocaleString("ar-EG")," جنيه"]}),e.items?.length>0&&t.jsxs("span",{className:"text-xs text-gray-400",children:[e.items.length," منتج"]})]}),t.jsx(n,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 group-hover:text-blue-500\r\n                              transition-colors duration-300"})]})]})]})]})},Ae=({order:e,isOpen:s,onClose:a,onUpdateStatus:l})=>{if(!e)return null;const n=e.userPhone||e.user?.phone_number,i=e.items||[],o=e.total||0,d=e.subtotal||0,c=e.tracking||[];return t.jsxs("div",{className:"fixed inset-0 z-50 transition-opacity duration-300\n                      "+(s?"opacity-100":"opacity-0 pointer-events-none"),children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),t.jsx("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500 \n                        "+(s?"translate-y-0":"translate-y-full"),children:t.jsx("div",{className:"bg-gradient-to-b from-neutral-950/95 to-neutral-950 backdrop-blur-xl\r\n                        rounded-t-[2.5rem] border-t border-neutral-800/50 shadow-2xl\r\n                        max-h-[90vh] overflow-y-auto hide-scrollbar",children:t.jsxs("div",{className:"px-4 md:px-6 py-6 md:py-8 space-y-4 md:space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-neutral-850/50 transition-colors",children:t.jsx(I,{className:"w-6 h-6 text-neutral-400"})}),t.jsx("div",{className:"text-center flex-1",children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm\r\n                                bg-neutral-850/50",children:[t.jsx(Ge,{status:e.status,className:"w-4 h-4"}),t.jsx("span",{children:Be(e.status)})]})}),t.jsx("button",{onClick:async()=>{const s=`\n  طلب من: ${n}\n  المنتجات:\n  ${i.map(e=>`• ${e.productName||e.name}\n     ${e.quantity}× - المقاس: ${e.size} - اللون: ${e.variant}\n     السعر: ${(e.price*e.quantity).toLocaleString("ar-EG")} جنيه`).join("\n")}\n  \n  الإجمالي: ${o.toLocaleString("ar-EG")} جنيه\n  التاريخ: ${new Date(e.createdAt).toLocaleString("ar-EG")}`.trim();try{navigator.share?await navigator.share({text:s}):await navigator.clipboard.writeText(s)}catch(t){t.name}},className:"p-2 -m-2 rounded-full hover:bg-neutral-850/50 transition-colors",children:t.jsx(R,{className:"w-6 h-6 text-neutral-400"})})]}),t.jsxs("div",{className:"bg-neutral-850/30 rounded-xl md:rounded-2xl p-3 md:p-4 border border-neutral-700/30",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"text-base md:text-lg font-bold text-white",children:"معلومات العميل"}),t.jsx("span",{className:"text-xs md:text-sm text-gray-400",dir:"ltr",children:n})]}),t.jsxs("div",{className:"flex gap-2 mt-3 md:mt-4",children:[t.jsxs("button",{onClick:()=>window.open(`https://wa.me/${n}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-2.5 md:p-3 rounded-lg md:rounded-xl\r\n                                   bg-gray-800/50 hover:bg-green-500/10 border border-transparent\r\n                                   hover:border-green-500/30 transition-all duration-300",children:[t.jsx(z,{className:"w-4 h-4 md:w-5 md:h-5 text-green-500"}),t.jsx("span",{className:"text-xs md:text-sm text-gray-400",children:"واتساب"})]}),t.jsxs("button",{onClick:()=>window.open(`tel:${n}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-2.5 md:p-3 rounded-lg md:rounded-xl\r\n                                   bg-gray-800/50 hover:bg-blue-500/10 border border-transparent\r\n                                   hover:border-blue-500/30 transition-all duration-300",children:[t.jsx(L,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-500"}),t.jsx("span",{className:"text-xs md:text-sm text-gray-400",children:"اتصال"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",dir:"rtl",children:[t.jsx("h4",{className:"text-lg font-bold text-white",children:"المنتجات"}),t.jsxs("span",{className:"text-sm text-gray-400",children:[i.length," منتج"]})]}),t.jsx("div",{className:"space-y-3",children:i.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 flex gap-3",children:[t.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden hide-scrollbar group",children:[t.jsx("img",{src:e.image,alt:e.productName,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),t.jsxs("span",{className:"absolute bottom-1 right-1 text-xs bg-black/50 text-white\r\n                                       px-1.5 py-0.5 rounded-full",children:[e.quantity,"×"]})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex justify-between items-start gap-2",children:[t.jsxs("span",{className:"text-blue-500 font-bold whitespace-nowrap",children:[(e.price*e.quantity).toLocaleString("ar-EG")," جنيه"]}),t.jsx("h4",{className:"font-medium text-white text-right truncate",children:e.productName||e.name})]}),t.jsxs("div",{className:"mt-1 flex justify-end items-center gap-3",children:[t.jsxs("span",{className:"text-sm text-gray-400",children:["المقاس: ",e.size]}),t.jsxs("span",{className:"text-sm text-gray-400",children:["اللون: ",e.variant]})]})]})]},s))})]}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-blue-500 font-bold",children:[d.toLocaleString("ar-EG")," جنيه"]}),t.jsx("span",{className:"text-gray-400",children:"المجموع"})]}),0!=e.shipping&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-green-500 font-bold",children:[e.shipping.toLocaleString("ar-EG")," جنيه"]}),t.jsx("span",{className:"text-gray-400",children:"الشحن"})]}),t.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xl font-bold text-white",children:[o.toLocaleString("ar-EG")," جنيه"]}),t.jsx("span",{className:"text-lg font-bold text-white",children:"الإجمالي"})]})]}),c.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-bold text-white",dir:"rtl",children:"تتبع الطلب"}),t.jsx("div",{className:"relative space-y-4",children:c.map((e,s)=>t.jsxs("div",{className:"flex items-start gap-4",children:[s!==c.length-1&&t.jsx("div",{className:"absolute top-8 bottom-0 left-4 w-px \r\n                                        bg-gradient-to-b from-gray-700 to-transparent"}),t.jsx("div",{className:"relative z-10 w-8 h-8 rounded-full flex items-center justify-center\n                                      "+(e.completed?"bg-blue-500":"bg-gray-700"),children:t.jsx(Ge,{status:e.status,className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:new Date(e.timestamp).toLocaleString("ar-EG")}),t.jsx("span",{className:"font-medium text-white",children:Be(e.status)})]}),e.description&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.description})]})]},s))})]}),t.jsx("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[{status:"pending",label:"تعليق",icon:D,color:"yellow"},{status:"processing",label:"معالجة",icon:r,color:"blue"},{status:"delivered",label:"تسليم",icon:U,color:"green"},{status:"cancelled",label:"إلغاء",icon:F,color:"red"}].map(({status:s,label:a,icon:r,color:n})=>{const i={yellow:{text:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/30"},blue:{text:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"},green:{text:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/30"},red:{text:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"}}[n];return t.jsxs("button",{onClick:()=>l(e.id,s),disabled:e.status===s,className:"flex items-center justify-center gap-1.5 md:gap-2 p-2.5 md:p-3 \n                                               rounded-lg md:rounded-xl font-medium transition-all duration-300 group\n                                               "+(e.status===s?"bg-gray-800/50 text-gray-500 cursor-not-allowed":`bg-gray-800/30 hover:${i.bg} \n                                                  border border-transparent hover:${i.border}`),children:[t.jsx(r,{className:"w-4 h-4 md:w-5 md:h-5 "+(e.status===s?"text-gray-500":`${i.text} \n                                              ${"processing"===s?"group-hover:animate-spin":""}`)}),t.jsx("span",{className:"text-xs md:text-sm "+(e.status===s?"text-gray-500":`text-gray-400 group-hover:${i.text}`),children:a})]},s)})})]})})})]})},Ge=({status:e})=>{const s={pending:D,processing:r,delivered:U,cancelled:F}[e]||n;return t.jsx(s,{className:"w-5 h-5"})},Be=e=>({pending:"معلق",processing:"قيد التنفيذ",delivered:"تم التسليم",cancelled:"ملغي"}[e]||"غير معروف"),qe=()=>t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 \r\n                    border-t-transparent rounded-full"})}),_e=({message:e})=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(a,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),t.jsx("p",{className:"text-gray-400",children:e})]}),Me=()=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(n,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد طلبات"}),t.jsx("p",{className:"text-gray-400",children:"لم يتم العثور على طلبات تطابق معايير البحث"})]}),Ve=({page:e,totalPages:s,onNext:a,onPrevious:r})=>t.jsx("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r\n                  border-t border-gray-800/50 p-4",children:t.jsxs("div",{className:"flex justify-between items-center max-w-lg mx-auto",children:[t.jsx("button",{onClick:r,disabled:e<=1,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                  disabled:opacity-50 disabled:cursor-not-allowed\r\n                  hover:bg-gray-700/50 transition-colors",children:"السابق"}),t.jsxs("span",{className:"text-gray-400",children:["صفحة ",e," من ",s]}),t.jsx("button",{onClick:a,disabled:e>=s,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                  disabled:opacity-50 disabled:cursor-not-allowed\r\n                  hover:bg-gray-700/50 transition-colors",children:"التالي"})]})}),Je=()=>{const{customers:s,totalCustomers:a,selectedCustomer:r,page:i,totalPages:h,search:g,isLoading:b,setSelectedCustomer:p,setSearch:j,nextPage:f,previousPage:v}=(()=>{const[s,t]=e.useState([]),[a,r]=e.useState(0),[l,n]=e.useState(null),[i,o]=e.useState(1),[d,c]=e.useState(0),[x,u]=e.useState(20),[m,h]=e.useState(""),[g,b]=e.useState(""),[p,j]=e.useState(!1),[f,v]=e.useState(!1),[y,N]=e.useState(null),[w,C]=e.useState(null),{apiCall:k}=le(),S=e.useRef(null);e.useEffect(()=>(S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{b(m),o(1)},300),()=>{S.current&&clearTimeout(S.current)}),[m]);const P=e.useCallback(async(e=i,s=g)=>{j(!0),N(null);try{const a=new URLSearchParams({page:e,perPage:x,search:s}).toString(),l=await k(`/admin/customers?${a}`);return l?.customers&&(t(l.customers),r(l.total),c(l.pages)),l}catch(a){return N(a.message),null}finally{j(!1)}},[k,i,x,g]),E=e.useCallback(async e=>{v(!0),C(null);try{const s=await k(`/admin/customers/${e}`);return s&&n(s),s}catch(s){return C(s.message),null}finally{v(!1)}},[k]),$=e.useCallback(()=>{i<d&&o(e=>e+1)},[i,d]),D=e.useCallback(()=>{i>1&&o(e=>e-1)},[i]);return e.useEffect(()=>{P()},[i,g,P]),{customers:s,totalCustomers:a,selectedCustomer:l,page:i,totalPages:d,perPage:x,search:m,isLoading:p,isLoadingDetails:f,error:y,detailsError:w,setSelectedCustomer:n,setPage:o,setPerPage:u,setSearch:h,loadCustomers:P,loadCustomerDetails:E,nextPage:$,previousPage:D}})(),[y,w]=e.useState(!1),[C,k]=e.useState({spendingRange:[],orderCount:[],location:[],dateRange:[]});C.spendingRange;const S=e.useMemo(()=>{if(!s.length)return null;const e={low:{min:0,max:1e3,count:0,total:0},medium:{min:1001,max:5e3,count:0,total:0},high:{min:5001,max:1/0,count:0,total:0}},t={},a={new:{min:0,max:1,count:0},regular:{min:2,max:5,count:0},loyal:{min:6,max:1/0,count:0}},r={};return s.forEach(s=>{const l=s.totalSpent||0;if(l<=e.low.max?(e.low.count++,e.low.total+=l):l<=e.medium.max?(e.medium.count++,e.medium.total+=l):(e.high.count++,e.high.total+=l),s.addresses?.[0]?.governorate){const e=s.addresses[0].governorate;t[e]=(t[e]||0)+1}const n=s.orderCount||0;n<=a.new.max?a.new.count++:n<=a.regular.max?a.regular.count++:a.loyal.count++;const i=Math.floor((new Date-new Date(s.createdAt))/2592e6),o=3*Math.floor(i/3);r[o]=(r[o]||0)+1}),{spendingRanges:e,locationData:Object.entries(t).map(([e,s])=>({name:e,value:s})),orderFrequency:a,customerAges:Object.entries(r).map(([e,s])=>({months:`${e}-${parseInt(e)+3} شهور`,count:s})).sort((e,s)=>parseInt(e.months)-parseInt(s.months))}},[s]),P=e.useMemo(()=>s.length?s.filter(e=>{const s=0===C.spendingRange.length||C.spendingRange.some(s=>{switch(s){case"low":return e.totalSpent<=1e3;case"medium":return e.totalSpent>1e3&&e.totalSpent<=5e3;case"high":return e.totalSpent>5e3;default:return!0}}),t=0===C.orderCount.length||C.orderCount.some(s=>{switch(s){case"new":return e.orderCount<=1;case"regular":return e.orderCount>1&&e.orderCount<=5;case"loyal":return e.orderCount>5;default:return!0}}),a=0===C.location.length||C.location.includes(e.addresses?.[0]?.governorate),r=0===C.dateRange.length||C.dateRange.some(s=>"recent"!==s||(new Date-new Date(e.createdAt))/864e5<=30);return s&&t&&a&&r}):[],[s,C]);return t.jsxs("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[t.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[t.jsx("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"العملاء"}),t.jsxs("span",{className:"text-sm text-neutral-400",children:[a," عميل"]})]}),t.jsxs("div",{className:"p-4 space-y-6 pt-0",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ue,{title:"إجمالي العملاء",value:a,icon:o,color:"primary"}),t.jsx(ue,{title:"عملاء جدد",value:S?.orderFrequency.new.count||0,subtitle:"آخر 30 يوم",icon:o,color:"success"})]}),S&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 border border-gray-700/50",children:[t.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"تصنيف العملاء"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(c,{children:[t.jsxs(x,{data:[{name:"عملاء جدد",value:S.orderFrequency.new.count},{name:"عملاء منتظمون",value:S.orderFrequency.regular.count},{name:"عملاء مخلصون",value:S.orderFrequency.loyal.count}],cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",children:[t.jsx(u,{fill:"#10B981"}),t.jsx(u,{fill:"#3B82F6"}),t.jsx(u,{fill:"#F59E0B"})]}),t.jsx(m,{})]})})})]}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 border border-gray-700/50",children:[t.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"التوزيع الجغرافي"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(T,{data:S.locationData,children:[t.jsx(A,{dataKey:"name"}),t.jsx(G,{}),t.jsx(m,{}),t.jsx(B,{dataKey:"value",fill:"#3B82F6"})]})})})]})]})]}),t.jsxs("div",{className:"sticky top-0 z-30 bg-neutral-950/95 backdrop-blur-sm p-4 space-y-4 border-b border-neutral-800/50",children:[t.jsxs("div",{className:"relative",children:[t.jsx(de,{type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"ابحث برقم الهاتف أو العنوان...",className:"pr-12"}),t.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),t.jsxs("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar",children:[t.jsx(Qe,{label:"مستوى الإنفاق",options:[{value:"low",label:"منخفض (≤ 1000)"},{value:"medium",label:"(1000-5000)"},{value:"high",label:"مرتفع (> 5000)"}],values:C.spendingRange,onChange:e=>k(s=>({...s,spendingRange:e})),icon:l}),t.jsx(Qe,{label:"عدد الطلبات",options:[{value:"new",label:"جديد (≤ 1)"},{value:"regular",label:"منتظم (2-5)"},{value:"loyal",label:"مخلص (> 5)"}],values:C.orderCount,onChange:e=>k(s=>({...s,orderCount:e})),icon:n}),S&&t.jsx(Qe,{label:"المنطقة",options:[...S.locationData.map(e=>({value:e.name,label:e.name}))],values:C.location,onChange:e=>k(s=>({...s,location:e})),icon:q}),t.jsx(Qe,{label:"تاريخ التسجيل",options:[{value:"recent",label:"آخر 30 يوم"}],values:C.dateRange,onChange:e=>k(s=>({...s,dateRange:e})),icon:_})]})]}),t.jsx("div",{className:"p-4 space-y-4",dir:"rtl",children:b?t.jsx(He,{}):0===P.length?t.jsx(Ze,{}):P.map(e=>t.jsx(Ke,{customer:e,onClick:()=>{p(e),w(!0)}},e.id))}),r&&t.jsx(Ye,{customer:r,isOpen:y,onClose:()=>{w(!1),p(null)},analytics:S}),h>1&&t.jsx(Xe,{page:i,totalPages:h,onNext:f,onPrevious:v})]})},We=({title:e,value:s,icon:a,trend:r,subtitle:l,color:n="emerald"})=>t.jsxs("div",{className:`relative overflow-hidden rounded-2xl border p-4 ${{emerald:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20",blue:"bg-blue-500/10 text-blue-500 border-blue-500/20",amber:"bg-amber-500/10 text-amber-500 border-amber-500/20"}[n]}`,dir:"rtl",children:[t.jsx("div",{className:"absolute top-4 left-4",children:t.jsx(a,{className:"w-6 h-6"})}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400",children:e}),t.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[t.jsx("span",{className:"text-2xl font-bold",children:s}),l&&t.jsx("span",{className:"text-sm text-gray-400",children:l})]}),r&&t.jsxs("div",{className:"mt-2 flex items-center gap-1",children:[t.jsx(W,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm",children:[r,"% زيادة"]})]})]})]}),Ke=({customer:e,onClick:s})=>{const a=(()=>{const s=e.orderCount||0;return s>5?{label:"عميل مخلص",color:"text-amber-500"}:s>1?{label:"عميل منتظم",color:"text-blue-500"}:{label:"عميل جديد",color:"text-emerald-500"}})();return t.jsxs("div",{onClick:s,className:"bg-gradient-to-br from-gray-800/40 to-gray-800/20 \r\n               rounded-2xl p-4 border border-gray-700/50 space-y-4 \r\n               hover:border-blue-500/30 transition-all duration-300 cursor-pointer",dir:"ltr",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:s=>{s.stopPropagation(),window.open(`https://wa.me/${e.phone}`,"_blank")},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-green-500/10\r\n                    border border-transparent hover:border-green-500/30\r\n                    transition-all duration-300",children:t.jsx(z,{className:"w-5 h-5 text-green-500"})}),t.jsx("a",{href:`tel:${e.phone}`,onClick:e=>e.stopPropagation(),className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r\n                    border border-transparent hover:border-blue-500/30\r\n                    transition-all duration-300",children:t.jsx(L,{className:"w-5 h-5 text-blue-500"})}),t.jsx("button",{onClick:async s=>{s.stopPropagation();try{await navigator.clipboard.writeText(e.phone)}catch(t){}},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r\n                    border border-transparent hover:border-blue-500/30\r\n                    transition-all duration-300",children:t.jsx(O,{className:"w-5 h-5 text-blue-500"})})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("h3",{className:"text-lg font-bold text-white",dir:"ltr",children:e.phone}),t.jsx("span",{className:`text-sm ${a.color}`,children:a.label})]}),t.jsx("p",{className:"text-sm text-gray-400",children:new Date(e.createdAt).toLocaleDateString("ar-EG")})]})]}),e.addresses?.[0]&&t.jsxs("div",{className:"flex items-start gap-3",dir:"rtl",children:[t.jsx(M,{className:"w-5 h-5 text-blue-500 mt-0.5"}),t.jsxs("div",{className:"flex-1 text-right",children:[t.jsx("p",{className:"text-white",children:e.addresses[0].governorate}),t.jsx("p",{className:"text-sm text-gray-400",children:e.addresses[0].district}),e.addresses[0].details&&t.jsx("p",{className:"text-sm text-gray-500",children:e.addresses[0].details})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-700/50",children:[t.jsxs("div",{className:"space-y-1",dir:"rtl",children:[t.jsxs("div",{className:"flex items-center gap-2",dir:"rtl",children:[t.jsx(n,{className:"w-4 h-4 text-blue-500"}),t.jsx("span",{className:"text-sm text-gray-400",children:"الطلبات"})]}),t.jsx("p",{className:"text-lg font-bold text-white pr-4",children:e.orderCount||0})]}),t.jsxs("div",{className:"space-y-1 text-right",children:[t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"إجمالي المشتريات"}),t.jsx(E,{className:"w-4 h-4 text-blue-500"})]}),t.jsxs("p",{className:"text-lg font-bold text-blue-500 pr-4",children:[(e.totalSpent||0).toLocaleString("ar-EG")," جنيه"]})]})]})]})},Qe=({label:s,options:a,values:r=[],onChange:l,icon:n})=>{const[i,o]=e.useState(!1),d=e.useRef(null);e.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const c=e=>{const s=r.includes(e)?r.filter(s=>s!==e):[...r,e];l(s)},x=()=>{l([]),o(!1)},u=e=>t.jsx("div",{className:"w-5 h-5 rounded border flex items-center justify-center\n                      transition-colors duration-200\n                      "+(e?"border-blue-500 bg-blue-500":"border-gray-600"),children:e&&t.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})});return t.jsxs("div",{className:"relative",ref:d,children:[t.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-2 px-4 py-2 rounded-xl\n                     transition-all duration-200 whitespace-nowrap\n                     "+(i?"bg-blue-500/20 text-blue-500 border border-blue-500/30":r.length>0?"bg-blue-500/10 text-blue-500 border border-blue-500/20":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[n&&t.jsx(n,{className:"w-4 h-4"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:s}),0===r.length?null:t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-500/20 border border-blue-500/20",children:r.length})]})]}),t.jsxs("div",{className:"fixed inset-0 z-50 md:hidden transition-opacity duration-300\n                      "+(i?"opacity-100":"opacity-0 pointer-events-none"),children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>o(!1)}),t.jsx("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500 ease-out\n                        "+(i?"translate-y-0":"translate-y-full"),children:t.jsxs("div",{className:"bg-gradient-to-b from-gray-900/95 to-gray-900 backdrop-blur-xl\r\n                         rounded-t-[2.5rem] border-t border-gray-800/50 shadow-2xl\r\n                         max-h-[80vh] overflow-y-auto",children:[t.jsx("div",{className:"absolute inset-x-0 top-0 h-7 flex justify-center items-start",children:t.jsx("div",{className:"w-12 h-1 rounded-full bg-gray-700/50 mt-3"})}),t.jsxs("div",{className:"px-6 pt-8 pb-6",children:[t.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:s}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.map(e=>t.jsxs("button",{onClick:()=>c(e.value),className:"flex items-center gap-3 p-4 rounded-xl\n                               transition-all duration-200\n                               "+(r.includes(e.value)?"bg-blue-500/20 text-blue-500 border border-blue-500/30":"bg-gray-800/30 text-gray-400 hover:bg-gray-700/50"),children:[u(r.includes(e.value)),t.jsx("span",{className:"flex-1 text-right",children:e.label})]},e.value))}),t.jsxs("div",{className:"mt-4 flex gap-2",children:[t.jsx("button",{onClick:x,className:"flex-1 py-3 rounded-xl bg-gray-800/50 text-gray-400\r\n                             hover:bg-gray-700/50 transition-colors",children:"إعادة تعيين"}),t.jsx("button",{onClick:()=>o(!1),className:"flex-1 py-3 rounded-xl bg-blue-500 text-white\r\n                             hover:bg-blue-600 transition-colors",children:"تطبيق"})]})]})]})})]}),i&&t.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-gray-800\r\n                       rounded-xl shadow-xl border border-gray-700/50 \r\n                       hidden md:block",children:[t.jsx("div",{className:"py-2",children:a.map(e=>t.jsxs("button",{onClick:()=>c(e.value),className:"w-full flex items-center gap-3 px-4 py-3\n                           transition-colors\n                           "+(r.includes(e.value)?"text-blue-500 bg-blue-500/10":"text-gray-400 hover:bg-gray-700/50"),children:[u(r.includes(e.value)),t.jsx("span",{className:"flex-1 text-right",children:e.label})]},e.value))}),t.jsxs("div",{className:"border-t border-gray-700/50 p-2 flex gap-2",children:[t.jsx("button",{onClick:x,className:"flex-1 py-2 rounded-lg bg-gray-800/50 text-gray-400\r\n                         hover:bg-gray-700/50 transition-colors text-sm",children:"إعادة تعيين"}),t.jsx("button",{onClick:()=>o(!1),className:"flex-1 py-2 rounded-lg bg-blue-500 text-white\r\n                         hover:bg-blue-600 transition-colors text-sm",children:"تطبيق"})]})]})]})},Ye=({customer:e,isOpen:s,onClose:a,analytics:r})=>e?t.jsxs("div",{className:"fixed inset-0 z-50 transition-opacity duration-300\n                  "+(s?"opacity-100":"opacity-0 pointer-events-none"),children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),t.jsx("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-500\n                    "+(s?"translate-y-0":"translate-y-full"),children:t.jsx("div",{className:"bg-gradient-to-b from-gray-900/95 to-gray-900 backdrop-blur-xl\r\n                     rounded-t-[2.5rem] border-t border-gray-800/50 shadow-2xl\r\n                     max-h-[90vh] overflow-y-auto",dir:"rtl",children:t.jsxs("div",{className:"px-6 py-8 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",dir:"ltr",children:[t.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-gray-800/50 transition-colors",children:"×"}),t.jsxs("div",{className:"text-right",children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"تفاصيل العميل"}),t.jsxs("p",{className:"text-sm text-gray-400",children:["عميل منذ ",(()=>{const s=Math.floor((new Date-new Date(e.createdAt))/2592e6);if(s<1)return"أقل من شهر";if(1===s)return"شهر واحد";if(s<12)return`${s} أشهر`;const t=Math.floor(s/12);return`${t} ${1===t?"سنة":"سنوات"}`})()]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(We,{title:"إجمالي الطلبات",value:e.orderCount||0,icon:n,color:"blue"}),t.jsx(We,{title:"إجمالي المشتريات",value:`${(e.totalSpent||0).toLocaleString("ar-EG")} جنيه`,icon:E,color:"emerald"})]}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[t.jsx("h3",{className:"font-bold text-white",children:"معلومات الاتصال"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(L,{className:"w-5 h-5 text-blue-500"}),t.jsx("span",{className:"text-white",dir:"ltr",children:e.phone})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>window.open(`https://wa.me/${e.phone}`,"_blank"),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r\n                          bg-green-500/10 text-green-500 hover:bg-green-500/20\r\n                          transition-colors",children:[t.jsx(z,{className:"w-5 h-5"}),t.jsx("span",{children:"واتساب"})]}),t.jsxs("button",{onClick:()=>window.open(`tel:${e.phone}`),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r\n                          bg-blue-500/10 text-blue-500 hover:bg-blue-500/20\r\n                          transition-colors",children:[t.jsx(L,{className:"w-5 h-5"}),t.jsx("span",{children:"اتصال"})]})]})]}),e.addresses?.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"font-bold text-white",children:"العناوين"}),e.addresses.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-4 space-y-2",children:[t.jsx("p",{className:"text-white",children:e.governorate}),t.jsx("p",{className:"text-gray-400",children:e.district}),e.details&&t.jsx("p",{className:"text-sm text-gray-500",children:e.details})]},s))]})]})})})]}):null,Xe=({page:e,totalPages:s,onNext:a,onPrevious:r})=>t.jsx("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r\n                border-t border-gray-800/50 p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:r,disabled:1===e,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(V,{className:"w-5 h-5"})}),t.jsxs("span",{className:"text-gray-400",children:["صفحة ",e," من ",s]}),t.jsx("button",{onClick:a,disabled:e===s,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(J,{className:"w-5 h-5"})})]})}),He=()=>t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(h,{className:"w-8 h-8 text-blue-500 animate-spin"})}),Ze=()=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(o,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"لا يوجد عملاء"}),t.jsx("p",{className:"text-gray-400",children:"لم يتم العثور على عملاء يطابقون معايير البحث"})]}),es=()=>{const{slides:s,loading:a,errors:r,createSlide:l,updateSlide:n,deleteSlide:i,toggleSlideStatus:o,resetError:d}=(()=>{const[s,t]=e.useState([]),[a,r]=e.useState(null),[l,n]=e.useState({slides:!1,create:!1,update:!1,delete:!1,status:!1}),[i,o]=e.useState({slides:null,create:null,update:null,delete:null}),{apiCall:d}=le(),c=e.useRef([]),x=e.useCallback(e=>{o(s=>({...s,[e]:null}))},[]),u=e.useCallback(e=>{const s=["title","productId"].filter(s=>!e[s]);return s.length>0?{isValid:!1,error:`Missing required fields: ${s.join(", ")}`}:{isValid:!0}},[]),m=e.useCallback(e=>{const s=new FormData;return Object.entries(e).forEach(([e,t])=>{null!=t&&("image"===e&&t instanceof File?s.append("image",t):"image"!==e&&s.append(e,t))}),s},[]),h=e.useCallback(async()=>{n(e=>({...e,slides:!0})),x("slides");try{const e=await d("/admin/slides");return e&&(t(e),c.current=e),e}catch(e){return o(s=>({...s,slides:e.message})),null}finally{n(e=>({...e,slides:!1}))}},[d,x]),g=e.useCallback(async e=>{n(e=>({...e,create:!0})),x("create");const s=u(e);if(!s.isValid)return o(e=>({...e,create:s.error})),n(e=>({...e,create:!1})),null;try{const s=m(e),t=await d("/admin/slides",{method:"POST",body:s});return t&&await h(),t}catch(t){return o(e=>({...e,create:t.message})),null}finally{n(e=>({...e,create:!1}))}},[d,h,u,m,x]),b=e.useCallback(async(e,a)=>{n(e=>({...e,update:!0})),x("update");const r=[...s],l=s.findIndex(s=>s.id===e);try{let n,i={};if(a.image instanceof File?n=m(a):(n=JSON.stringify(a),i={"Content-Type":"application/json"}),-1!==l&&!(a.image instanceof File)){const e={...s[l],...a},r=[...s];r[l]=e,t(r)}const o=await d(`/admin/slides/${e}`,{method:"PUT",headers:i,body:n});return o?(await h(),o):(t(r),null)}catch(i){return t(r),o(e=>({...e,update:i.message})),null}finally{n(e=>({...e,update:!1}))}},[d,s,h,m,x]),p=e.useCallback(async e=>{n(e=>({...e,delete:!0})),x("delete");const a=[...s];try{t(s.filter(s=>s.id!==e));const r=await d(`/admin/slides/${e}`,{method:"DELETE"});if(!r)throw t(a),new Error("Failed to delete slide");return r}catch(r){return t(a),o(e=>({...e,delete:r.message})),null}finally{n(e=>({...e,delete:!1}))}},[d,s,x]),j=e.useCallback(async e=>{n(e=>({...e,status:!0})),x("update");const a=s.findIndex(s=>s.id===e);if(-1===a)return;const r=s[a],l="active"===r.status?"inactive":"active",i=[...s];try{const n=[...s];n[a]={...r,status:l},t(n);const o=await d(`/admin/slides/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:l})});if(!o)throw t(i),new Error("Failed to update slide status");return o}catch(c){return t(i),o(e=>({...e,update:c.message})),null}finally{n(e=>({...e,status:!1}))}},[d,s,x]);return e.useEffect(()=>{h()},[h]),{slides:s,selectedSlide:a,loading:l,errors:i,setSelectedSlide:r,loadSlides:h,createSlide:g,updateSlide:b,deleteSlide:p,toggleSlideStatus:j,resetError:x}})(),{products:c,loading:x}=ne(),[u,m]=e.useState(!1);return t.jsxs("div",{className:"min-h-screen bg-secondary-900 p-4 pt-0 pb-20",dir:"rtl",children:[t.jsx("div",{className:"sticky top-0 z-30 -mx-4 bg-secondary-900/95 backdrop-blur-xl px-4 py-3 \r\n                      border-b border-secondary-800/50 pt-0",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-xl font-bold text-white",children:"إدارة العروض"}),t.jsxs("button",{onClick:()=>{m(!0),d("create")},className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-500 \r\n                     hover:bg-blue-600 transition-colors text-white",children:[t.jsx(p,{className:"w-5 h-5"}),t.jsx("span",{children:"إضافة عرض"})]})]})}),a.slides?t.jsx(is,{}):r.slides?t.jsx(os,{message:r.slides}):0===s.length?t.jsx(ds,{}):t.jsx("div",{className:"space-y-4 mt-6",children:s.map(e=>t.jsx(ts,{slide:e,onDelete:i,onUpdate:n,onToggleStatus:o,products:c,loading:a,errors:r,resetError:d},e.id))}),u&&t.jsx(as,{onClose:()=>{m(!1),d("create")},onCreate:async e=>{await l(e)&&m(!1)},products:c,isLoading:a.create||x,error:r.create})]})},ss=({checked:e,onChange:s,disabled:a})=>t.jsxs("button",{onClick:s,disabled:a,className:"relative inline-flex items-center gap-3",children:[t.jsx("div",{className:`\n        w-10 h-5 rounded-full transition-colors duration-200 ml-[-48px]\n        ${e?"bg-blue-500":"bg-gray-700"}\n        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n      `,children:t.jsx("div",{className:`\n          absolute w-5 h-5 ml-6 bg-white rounded-full shadow transition-transform duration-200 transform\n          ${e?"translate-x-4 rtl:-translate-x-6":"translate-x-1 rtl:-translate-x-1"}\n          ${a?"cursor-not-allowed":"cursor-pointer"}\n        `,children:a&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx(h,{className:"w-3 h-3 text-blue-500 animate-spin"})})})}),t.jsx("span",{className:`\n        text-sm transition-colors duration-200\n        ${e?"text-blue-500":"text-gray-400"}\n        ${a?"opacity-50":""}\n      `,children:e?"نشط":"غير نشط"})]}),ts=({slide:s,onDelete:a,onUpdate:r,onToggleStatus:l,products:i,loading:o,errors:d,resetError:c})=>{const[x,u]=e.useState(!1),[m,h]=e.useState(!1),g=i.find(e=>e.id===s.productId);return t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl border border-gray-700/50 overflow-hidden",children:[t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden group",children:t.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover transition-transform duration-300\r\n                        group-hover:scale-110"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-bold text-white text-lg truncate",children:s.title}),g&&t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(n,{className:"w-4 h-4 text-blue-500"}),t.jsx("span",{className:"text-sm text-gray-400",children:g.name})]}),t.jsx("div",{className:"mt-6",dir:"ltr",children:t.jsx(ss,{checked:"active"===s.status,onChange:()=>l(s.id),disabled:o.status})})]}),t.jsx("button",{onClick:()=>u(!x),className:"p-2 rounded-xl hover:bg-gray-700/50 transition-colors",children:x?t.jsx(Q,{className:"w-5 h-5 text-gray-400"}):t.jsx(I,{className:"w-5 h-5 text-gray-400"})})]})}),x&&t.jsxs("div",{className:"border-t border-gray-700/50 p-4 space-y-4",children:[s.description&&t.jsx("p",{className:"text-gray-400 text-sm",children:s.description}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{h(!0),c("update")},className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r\n                        bg-blue-500/10 text-blue-500 hover:bg-blue-500/20\r\n                        transition-colors",children:"تعديل"}),t.jsx("button",{onClick:async()=>{await a(s.id)&&u(!1)},disabled:o.delete,className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r\n                        bg-red-500/10 text-red-500 hover:bg-red-500/20\r\n                        transition-colors disabled:opacity-50",children:o.delete?"جاري الحذف...":"حذف"})]}),d.delete&&t.jsx("p",{className:"text-sm text-red-500 text-center",children:d.delete})]}),m&&t.jsx(ns,{slide:s,onClose:()=>{h(!1),c("update")},onUpdate:async e=>{await r(s.id,e)&&h(!1)},products:i,isLoading:o.update,error:d.update})]})},as=({onClose:s,onCreate:a,products:r,isLoading:l,error:n})=>{const[i,o]=e.useState({title:"",description:"",productId:"",image:null}),[d,c]=e.useState(null),[x,u]=e.useState("");return t.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",children:t.jsx("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-300",children:t.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-xl rounded-t-[2.5rem] border-t \r\n                     border-gray-800/50 p-6 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"إضافة عرض جديد"}),(n||x)&&t.jsx("div",{className:"mb-4 p-3 rounded-xl bg-red-500/10 text-red-500",children:n||x}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),i.image?i.title.trim()&&i.productId?await a(i)&&s():u("Please fill in all required fields"):u("Please select an image")},className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الصورة"}),t.jsx(rs,{imagePreview:d,onChange:e=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void u("Please select a valid image file");if(s.size>5242880)return void u("Image size should be less than 5MB");o(e=>({...e,image:s})),c(URL.createObjectURL(s)),u("")}},inputId:"create-slide-image"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"العنوان"}),t.jsx("input",{type:"text",value:i.title,onChange:e=>o(s=>({...s,title:e.target.value})),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                       border border-gray-700/50 focus:border-blue-500/50",placeholder:"عنوان العرض"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الوصف"}),t.jsx("textarea",{value:i.description,onChange:e=>o(s=>({...s,description:e.target.value})),className:"w-full h-24 bg-gray-800/50 rounded-xl p-4 text-white\r\n                       border border-gray-700/50 focus:border-blue-500/50 resize-none",placeholder:"وصف العرض"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"المنتج"}),t.jsx(ls,{value:i.productId,onChange:e=>o(s=>({...s,productId:e})),products:r})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:s,className:"flex-1 h-12 rounded-xl bg-gray-800/50 text-gray-400\r\n                       hover:bg-gray-700/50 transition-colors",children:"إلغاء"}),t.jsx("button",{type:"submit",disabled:l,className:"flex-1 h-12 rounded-xl bg-blue-500 text-white\r\n                       hover:bg-blue-600 transition-colors disabled:opacity-50",children:l?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsx(h,{className:"w-5 h-5 animate-spin"}),"جاري الإنشاء..."]}):"إنشاء"})]})]})]})})})},rs=({imagePreview:e,onChange:s,inputId:a})=>t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:s,className:"hidden",id:a}),t.jsx("label",{htmlFor:a,className:"block w-full aspect-video rounded-xl border-2 border-dashed\r\n               border-gray-700/50 hover:border-blue-500/50 transition-colors\r\n               cursor-pointer overflow-hidden",children:e?t.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover"}):t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx(K,{className:"w-8 h-8 text-gray-400 mb-2"}),t.jsx("span",{className:"text-sm text-gray-400",children:"اختر صورة أو اسحبها هنا"})]})})]}),ls=({value:e,onChange:s,products:a})=>t.jsxs("div",{className:"relative",children:[t.jsxs("select",{value:e,onChange:e=>s(e.target.value),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n               border border-gray-700/50 focus:border-blue-500/50\r\n               appearance-none",children:[t.jsx("option",{value:"",children:"اختر منتج"}),a.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),t.jsx(I,{className:"absolute left-4 top-1/2 -translate-y-1/2 \r\n                         w-5 h-5 text-gray-400 pointer-events-none"})]}),ns=({slide:s,onClose:a,onUpdate:r,products:l,isLoading:n,error:i})=>{const[o,d]=e.useState({title:s.title,description:s.description||"",productId:s.productId,image:null}),[c,x]=e.useState(null),[u,m]=e.useState("");return t.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",children:t.jsx("div",{className:"fixed inset-x-0 bottom-0 transform transition-transform duration-300",children:t.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-xl rounded-t-[2.5rem] border-t \r\n                     border-gray-800/50 p-6 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"تعديل العرض"}),(i||u)&&t.jsx("div",{className:"mb-4 p-3 rounded-xl bg-red-500/10 text-red-500",children:i||u}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o.title.trim()&&o.productId?await r(o)&&a():m("Please fill in all required fields")},className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الصورة"}),t.jsx(rs,{imagePreview:c||s.imageUrl,onChange:e=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void m("Please select a valid image file");if(s.size>5242880)return void m("Image size should be less than 5MB");d(e=>({...e,image:s})),x(URL.createObjectURL(s)),m("")}},inputId:"edit-slide-image"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"العنوان"}),t.jsx("input",{type:"text",value:o.title,onChange:e=>d(s=>({...s,title:e.target.value})),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                       border border-gray-700/50 focus:border-blue-500/50",placeholder:"عنوان العرض"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الوصف"}),t.jsx("textarea",{value:o.description,onChange:e=>d(s=>({...s,description:e.target.value})),className:"w-full h-24 bg-gray-800/50 rounded-xl p-4 text-white\r\n                       border border-gray-700/50 focus:border-blue-500/50 resize-none",placeholder:"وصف العرض"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"المنتج"}),t.jsx(ls,{value:o.productId,onChange:e=>d(s=>({...s,productId:e})),products:l})]}),o.productId&&t.jsx("div",{className:"bg-gray-800/30 rounded-xl p-4",children:t.jsx(cs,{product:l.find(e=>e.id===o.productId)})}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:a,className:"flex-1 h-12 rounded-xl bg-gray-800/50 text-gray-400\r\n                       hover:bg-gray-700/50 transition-colors",children:"إلغاء"}),t.jsx("button",{type:"submit",disabled:n,className:"flex-1 h-12 rounded-xl bg-blue-500 text-white\r\n                       hover:bg-blue-600 transition-colors disabled:opacity-50",children:n?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsx(h,{className:"w-5 h-5 animate-spin"}),"جاري الحفظ..."]}):"حفظ"})]})]})]})})})},is=()=>t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx(h,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto"}),t.jsx("p",{className:"text-gray-400",children:"جاري تحميل العروض..."})]})}),os=({message:e})=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(a,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),t.jsx("p",{className:"text-gray-400",children:e})]}),ds=()=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(K,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد عروض"}),t.jsx("p",{className:"text-gray-400",children:"ابدأ بإضافة عروض جديدة لعرضها للعملاء"})]}),cs=({product:e})=>{if(!e)return null;const s=e.variants[0],a=s?.images[0];return t.jsxs("div",{className:"flex items-start gap-3",children:[a&&t.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:t.jsx("img",{src:a,alt:e.name,className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-white truncate",children:e.name}),t.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[t.jsxs("span",{className:"text-sm text-gray-400",children:[e.variants.length," ",1===e.variants.length?"لون":"ألوان"]}),t.jsxs("span",{className:"text-sm text-gray-400",children:[e.variants.reduce((e,s)=>e+s.sizes.length,0)," مقاسات"]})]})]})]})},xs=()=>{const{coupons:s,totalCoupons:a,selectedCoupon:r,couponStats:n,page:i,totalPages:d,filters:c,isLoading:x,isCreating:u,isUpdating:m,isDeleting:h,isLoadingStats:b,error:j,setSelectedCoupon:f,updateFilters:v,createCoupon:y,updateCoupon:w,deleteCoupon:C,nextPage:k,previousPage:S}=(()=>{const[s,t]=e.useState([]),[a,r]=e.useState(0),[l,n]=e.useState(null),[i,o]=e.useState(null),[d,c]=e.useState(1),[x,u]=e.useState(0),[m,h]=e.useState(20),[g,b]=e.useState({status:"",search:"",type:"all",isSpecific:null}),p={ALL:"all",ACTIVE:"active",EXPIRED:"expired",PERCENTAGE:"percentage",FIXED:"fixed"},[j,f]=e.useState(!1),[v,y]=e.useState(!1),[N,w]=e.useState(!1),[C,k]=e.useState(!1),[S,P]=e.useState(!1),[E,$]=e.useState(null),[D,U]=e.useState(null),{apiCall:F}=le(),z=e.useCallback(async(e=d)=>{f(!0),$(null);try{const s={...g,type:g.type===p.ALL?"":g.type},a=new URLSearchParams({page:e,perPage:m,...s}).toString(),l=await F(`/admin/coupons?${a}`);return l&&(t(l.coupons),r(l.total),u(l.pages)),l}catch(s){return $(s.message),null}finally{f(!1)}},[F,d,m,g]),L=async()=>{P(!0),U(null);try{const e=await F("/admin/coupons/stats");return e&&o(e),e}catch(e){return U(e.message),null}finally{P(!1)}},O=e.useCallback(e=>{b(s=>({...s,...e})),c(1)},[]),I=e.useCallback(()=>{d<x&&c(e=>e+1)},[d,x]),R=e.useCallback(()=>{d>1&&c(e=>e-1)},[d]);return e.useEffect(()=>{z()},[d,g,z]),e.useEffect(()=>{L();const e=setInterval(L,3e5);return()=>clearInterval(e)},[]),{coupons:s,totalCoupons:a,selectedCoupon:l,couponStats:i,COUPON_TYPES:p,page:d,totalPages:x,perPage:m,filters:g,isLoading:j,isCreating:v,isUpdating:N,isDeleting:C,isLoadingStats:S,error:E,statsError:D,setSelectedCoupon:n,setPage:c,setPerPage:h,updateFilters:O,loadCoupons:z,createCoupon:async e=>{y(!0),$(null);try{const s=await F("/admin/coupons",{method:"POST",body:JSON.stringify(e)});return await z(),s}catch(s){throw $(s.message),s}finally{y(!1)}},updateCoupon:async(e,s)=>{w(!0),$(null);try{const t=await F(`/admin/coupons/${e}`,{method:"PUT",body:JSON.stringify(s)});return await z(),t}catch(t){throw $(t.message),t}finally{w(!1)}},deleteCoupon:async e=>{k(!0),$(null);try{const s=await F(`/admin/coupons/${e}`,{method:"DELETE"});return await z(),s}catch(s){throw $(s.message),s}finally{k(!1)}},loadCouponStats:L,nextPage:I,previousPage:R}})(),[P,E]=e.useState(!1),[z,L]=e.useState(!1);return t.jsxs("div",{className:"min-h-screen bg-neutral-950 pb-20",children:[t.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-neutral-800/50",children:[t.jsx("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"القسائم"}),t.jsxs("span",{className:"text-sm text-neutral-400",children:[a," قسيمة"]})]}),n&&t.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[t.jsx(ue,{title:"القسائم النشطة",value:n.activeCoupons,icon:Y,color:"success"}),t.jsx(ue,{title:"إجمالي التوفير",value:`${n.totalDiscountGiven.toLocaleString("ar-EG")} جنيه`,icon:l,color:"primary"}),t.jsx(ue,{title:"معدل الاستخدام",value:`${(n.totalUsedCoupons/n.totalCoupons*100).toFixed(1)}%`,icon:$,color:"warning"}),t.jsx(ue,{title:"قسائم منتهية",value:n.expiredCoupons,icon:F,color:"danger"})]}),t.jsxs("div",{className:"sticky top-0 z-30 bg-neutral-950/95 backdrop-blur-sm p-4 space-y-4 border-b border-neutral-800/50",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:c.search,onChange:e=>v({search:e.target.value}),placeholder:"ابحث برمز القسيمة أو رقم الهاتف...",className:"w-full h-12 bg-gray-800/50 rounded-xl px-12 text-white text-right\r\n                     border border-gray-700/50 focus:border-blue-500/50\r\n                     focus:ring-2 focus:ring-blue-500/50\r\n                     placeholder:text-gray-500",dir:"rtl"}),t.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.search&&t.jsx("button",{onClick:()=>v({search:""}),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full\r\n                       hover:bg-gray-700/50 transition-colors",children:t.jsx(g,{className:"w-4 h-4 text-gray-400"})})]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar py-2",dir:"rtl",children:[{id:"all",label:"الكل",icon:Y},{id:"active",label:"نشط",icon:U},{id:"expired",label:"منتهي",icon:D},{id:"percentage",label:"نسبة مئوية",icon:X},{id:"fixed",label:"قيمة ثابتة",icon:H},{id:"specific",label:"مستخدمين محددين",icon:o}].map(({id:e,label:s,icon:a})=>t.jsxs("button",{onClick:()=>v({type:e}),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm\n                       whitespace-nowrap transition-colors\n                       "+(c.type===e?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"),children:[t.jsx(a,{className:"w-4 h-4"}),t.jsx("span",{children:s})]},e))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>E(!0),className:"flex-1 flex items-center justify-center gap-2 p-3 rounded-xl\r\n                     bg-blue-500 text-white font-medium hover:bg-blue-600\r\n                     transition-colors",children:[t.jsx(p,{className:"w-5 h-5"}),t.jsx("span",{children:"إنشاء قسيمة"})]}),t.jsx("button",{onClick:()=>L(!0),className:"p-3 rounded-xl bg-gray-800/50 text-gray-400\r\n                     hover:bg-gray-700/50 transition-colors",children:t.jsx(Z,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"p-4 space-y-4",children:x?t.jsx(js,{}):j?t.jsx(fs,{message:j}):0===s.length?t.jsx(vs,{}):s.map(e=>t.jsx(ms,{coupon:e,onClick:()=>f(e),onEdit:()=>{},onDelete:()=>C(e.id)},e.id))}),P&&t.jsx(hs,{isOpen:P,onClose:()=>E(!1),onCreate:y,isCreating:u}),r&&t.jsx(gs,{coupon:r,isOpen:!!r,onClose:()=>f(null),onUpdate:w,onDelete:C,isUpdating:m,isDeleting:h}),z&&t.jsx(bs,{stats:n,isOpen:z,onClose:()=>L(!1),isLoading:b}),d>1&&t.jsx("div",{className:"fixed bottom-0 inset-x-0 bg-gray-900/95 backdrop-blur-xl \r\n                      border-t border-gray-800/50 p-4",children:t.jsxs("div",{className:"flex justify-between items-center max-w-lg mx-auto",children:[t.jsx("button",{onClick:S,disabled:i<=1,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                      disabled:opacity-50 disabled:cursor-not-allowed\r\n                      hover:bg-gray-700/50 transition-colors",children:"السابق"}),t.jsxs("span",{className:"text-gray-400",children:["صفحة ",i," من ",d]}),t.jsx("button",{onClick:k,disabled:i>=d,className:"p-2 rounded-xl bg-gray-800/50 text-gray-400\r\n                      disabled:opacity-50 disabled:cursor-not-allowed\r\n                      hover:bg-gray-700/50 transition-colors",children:"التالي"})]})})]})},us=({title:e,value:s,icon:a,color:r})=>t.jsxs("div",{className:`relative overflow-hidden rounded-2xl p-4 \n                 bg-${r}-500/10 border border-${r}-500/20`,children:[t.jsx("div",{className:"absolute top-4 right-4",children:t.jsx(a,{className:`w-6 h-6 text-${r}-500`})}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400",children:e}),t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:`text-2xl font-bold text-${r}-500`,children:s})})]})]}),ms=({coupon:e,onClick:s,onEdit:a,onDelete:r})=>{const l=new Date(e.endDate)<new Date,n="active"===e.status&&!l;return t.jsxs("div",{onClick:s,className:"group bg-gray-800/30 rounded-2xl p-4 space-y-4 cursor-pointer\r\n               border border-gray-700/50 hover:border-blue-500/30\r\n               transition-all duration-300",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm\n                      "+(n?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"),children:[n?t.jsx(U,{className:"w-4 h-4"}):t.jsx(D,{className:"w-4 h-4"}),t.jsx("span",{children:n?"نشط":"منتهي"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:async s=>{s.stopPropagation();try{await navigator.clipboard.writeText(e.code)}catch(t){}},className:"p-1 rounded-lg bg-gray-800/50 hover:bg-blue-500/10\r\n                       border border-transparent hover:border-blue-500/30\r\n                       transition-all duration-300",children:t.jsx(O,{className:"w-4 h-4 text-blue-500"})}),t.jsx("h3",{className:"font-bold text-white group-hover:text-blue-500\r\n                         transition-colors",children:e.code})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:new Date(e.endDate).toLocaleDateString("ar-EG")})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:["percentage"===e.discountType?t.jsx(X,{className:"w-5 h-5 text-blue-500"}):t.jsx(H,{className:"w-5 h-5 text-blue-500"}),t.jsxs("span",{className:"text-white font-medium",children:[e.discountValue,"percentage"===e.discountType?"%":" جنيه"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[t.jsx(o,{className:"w-5 h-5"}),t.jsxs("span",{children:[e.usedCount,"/",e.maxUses||"∞"]})]})]})]})},hs=({isOpen:s,onClose:a,onCreate:r,isCreating:l})=>{const[n,i]=e.useState({code:"",discountType:"percentage",discountValue:"",maxUses:"",startDate:(new Date).toISOString().split("T")[0],endDate:"",specificUsers:[]});return t.jsx(ps,{isOpen:s,onClose:a,children:t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:t.jsx(I,{className:"w-6 h-6 text-gray-400"})}),t.jsx("h2",{className:"text-xl font-bold text-white",children:"إنشاء قسيمة جديدة"}),t.jsx("div",{className:"w-10"})]}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await r(n),a()}catch(s){}},className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"رمز القسيمة"}),t.jsx("input",{type:"text",value:n.code,onChange:e=>i({...n,code:e.target.value.toUpperCase()}),placeholder:"SALE2025",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                         border border-gray-700/50 focus:border-blue-500/50\r\n                         focus:ring-2 focus:ring-blue-500/50",dir:"ltr"}),t.jsx("p",{className:"text-xs text-gray-500",children:"اتركه فارغاً لإنشاء رمز تلقائي"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"نوع الخصم"}),t.jsxs("select",{value:n.discountType,onChange:e=>i({...n,discountType:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                           border border-gray-700/50 focus:border-blue-500/50\r\n                           focus:ring-2 focus:ring-blue-500/50",children:[t.jsx("option",{value:"percentage",children:"نسبة مئوية"}),t.jsx("option",{value:"fixed",children:"قيمة ثابتة"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"قيمة الخصم"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",value:n.discountValue,onChange:e=>i({...n,discountValue:e.target.value}),placeholder:"percentage"===n.discountType?"10":"100",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                             border border-gray-700/50 focus:border-blue-500/50\r\n                             focus:ring-2 focus:ring-blue-500/50"}),t.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"percentage"===n.discountType?"%":"جنيه"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"الحد الأقصى للاستخدام"}),t.jsx("input",{type:"number",value:n.maxUses,onChange:e=>i({...n,maxUses:e.target.value}),placeholder:"اتركه فارغاً للاستخدام غير المحدود",className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                         border border-gray-700/50 focus:border-blue-500/50\r\n                         focus:ring-2 focus:ring-blue-500/50"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"تاريخ البدء"}),t.jsx("input",{type:"date",value:n.startDate,onChange:e=>i({...n,startDate:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                           border border-gray-700/50 focus:border-blue-500/50\r\n                           focus:ring-2 focus:ring-blue-500/50"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"تاريخ الانتهاء"}),t.jsx("input",{type:"date",value:n.endDate,onChange:e=>i({...n,endDate:e.target.value}),className:"w-full h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                           border border-gray-700/50 focus:border-blue-500/50\r\n                           focus:ring-2 focus:ring-blue-500/50"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400",children:"مستخدمين محددين"}),t.jsx("button",{type:"button",onClick:()=>i({...n,specificUsers:[...n.specificUsers,{phone:"",maxUses:""}]}),className:"text-sm text-blue-500 hover:text-blue-400 transition-colors",children:"إضافة مستخدم"})]}),n.specificUsers.map((e,s)=>t.jsxs("div",{className:"flex gap-4",children:[t.jsx("input",{type:"tel",value:e.phone,onChange:e=>{const t=[...n.specificUsers];t[s].phone=e.target.value,i({...n,specificUsers:t})},placeholder:"رقم الهاتف",className:"flex-1 h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                             border border-gray-700/50 focus:border-blue-500/50\r\n                             focus:ring-2 focus:ring-blue-500/50",dir:"ltr"}),t.jsx("input",{type:"number",value:e.maxUses,onChange:e=>{const t=[...n.specificUsers];t[s].maxUses=e.target.value,i({...n,specificUsers:t})},placeholder:"عدد مرات الاستخدام",className:"w-32 h-12 bg-gray-800/50 rounded-xl px-4 text-white\r\n                             border border-gray-700/50 focus:border-blue-500/50\r\n                             focus:ring-2 focus:ring-blue-500/50"}),t.jsx("button",{type:"button",onClick:()=>{const e=n.specificUsers.filter((e,t)=>t!==s);i({...n,specificUsers:e})},className:"p-3 rounded-xl bg-red-500/10 text-red-500\r\n                             hover:bg-red-500/20 transition-colors",children:t.jsx(g,{className:"w-6 h-6"})})]},s))]}),t.jsx("button",{type:"submit",disabled:l,className:"w-full p-4 rounded-xl bg-blue-500 text-white font-medium\r\n                       hover:bg-blue-600 transition-colors disabled:opacity-50\r\n                       disabled:cursor-not-allowed",children:l?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(h,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"جاري الإنشاء..."})]}):"إنشاء القسيمة"})]})]})})},gs=({coupon:s,isOpen:a,onClose:r,onUpdate:l,onDelete:n,isUpdating:i,isDeleting:d})=>{const[c,x]=e.useState(!1),[u,m]=e.useState(s);return t.jsx(ps,{isOpen:a,onClose:r,children:t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:r,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:t.jsx(I,{className:"w-6 h-6 text-gray-400"})}),t.jsx("h2",{className:"text-xl font-bold text-white",children:"تفاصيل القسيمة"}),t.jsx("button",{onClick:()=>x(!c),className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:t.jsx(S,{className:"w-6 h-6 text-gray-400"})})]}),c?t.jsx("form",{onSubmit:async e=>{e.preventDefault();try{await l(s.id,u),x(!1)}catch(t){}},className:"space-y-6",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{type:"submit",disabled:i,className:"flex-1 p-4 rounded-xl bg-blue-500 text-white font-medium\r\n                           hover:bg-blue-600 transition-colors disabled:opacity-50\r\n                           disabled:cursor-not-allowed",children:i?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(h,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"جاري التحديث..."})]}):"حفظ التغييرات"}),t.jsx("button",{type:"button",onClick:()=>x(!1),className:"p-4 rounded-xl bg-gray-800/50 text-gray-400\r\n                           hover:bg-gray-700/50 transition-colors",children:"إلغاء"})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(s.code)}catch(e){}},className:"p-2 rounded-xl bg-gray-800/50 hover:bg-blue-500/10\r\n                             border border-transparent hover:border-blue-500/30\r\n                             transition-all duration-300",children:t.jsx(O,{className:"w-5 h-5 text-blue-500"})}),t.jsxs("div",{className:"text-right",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:s.code}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"رمز القسيمة"})]})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:["percentage"===s.discountType?t.jsx(X,{className:"w-5 h-5 text-blue-500"}):t.jsx(H,{className:"w-5 h-5 text-blue-500"}),t.jsxs("span",{className:"text-lg font-bold text-white",children:[s.discountValue,"percentage"===s.discountType?"%":" جنيه"]})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"قيمة الخصم"})]}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{className:"w-5 h-5 text-blue-500"}),t.jsxs("span",{className:"text-lg font-bold text-white",children:[s.usedCount,"/",s.maxUses||"∞"]})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"عدد مرات الاستخدام"})]})]}),t.jsx("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(_,{className:"w-5 h-5 text-blue-500 mt-1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-white",children:"المدة الزمنية"}),t.jsxs("div",{className:"mt-2 space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"تاريخ البدء:"}),t.jsx("span",{className:"text-white",children:new Date(s.startDate).toLocaleDateString("ar-EG")})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"تاريخ الانتهاء:"}),t.jsx("span",{className:"text-white",children:new Date(s.endDate).toLocaleDateString("ar-EG")})]})]})]})]})}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[t.jsx("h4",{className:"font-medium text-white",children:"إحصائيات الاستخدام"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-gray-400",children:"إجمالي التوفير"}),t.jsxs("p",{className:"text-lg font-bold text-blue-500",children:[s.totalDiscountGiven?.toLocaleString("ar-EG")," جنيه"]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-gray-400",children:"متوسط التوفير"}),t.jsxs("p",{className:"text-lg font-bold text-blue-500",children:[(s.totalDiscountGiven/s.usedCount||0).toLocaleString("ar-EG")," جنيه"]})]})]})]}),s.recentUsage?.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-medium text-white",children:"آخر الاستخدامات"}),t.jsx("div",{className:"space-y-3",children:s.recentUsage.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[t.jsxs("span",{className:"text-blue-500 font-medium",children:[e.discountAmount.toLocaleString("ar-EG")," جنيه"]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-white",children:e.orderId}),t.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.usedAt).toLocaleString("ar-EG")})]})]},s))})]}),s.specificUsers?.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-medium text-white",children:"المستخدمون المحددون"}),t.jsx("div",{className:"space-y-3",children:s.specificUsers.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{className:"w-5 h-5 text-blue-500"}),t.jsxs("span",{className:"text-white",children:[e.usedCount,"/",e.maxUses||"∞"]})]}),t.jsx("span",{className:"text-gray-400 dir-ltr",children:e.phone})]},s))})]}),t.jsx("button",{onClick:async()=>{if(window.confirm("هل أنت متأكد من حذف هذه القسيمة؟"))try{await n(s.id),r()}catch(e){}},disabled:d,className:"w-full p-4 rounded-xl bg-red-500/10 text-red-500\r\n                         hover:bg-red-500/20 transition-colors disabled:opacity-50\r\n                         disabled:cursor-not-allowed",children:d?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(h,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"جاري الحذف..."})]}):"حذف القسيمة"})]})]})})},bs=({stats:e,isOpen:s,onClose:a,isLoading:r})=>e||r?t.jsx(ps,{isOpen:s,onClose:a,children:t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:a,className:"p-2 -m-2 rounded-full hover:bg-gray-800/50 transition-colors",children:t.jsx(I,{className:"w-6 h-6 text-gray-400"})}),t.jsx("h2",{className:"text-xl font-bold text-white",children:"إحصائيات القسائم"}),t.jsx("div",{className:"w-10"})]}),r?t.jsx(js,{}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(us,{title:"القسائم النشطة",value:e.activeCoupons,icon:U,color:"emerald"}),t.jsx(us,{title:"إجمالي التوفير",value:`${e.totalDiscountGiven.toLocaleString("ar-EG")} جنيه`,icon:E,color:"blue"}),t.jsx(us,{title:"معدل الاستخدام",value:`${(e.totalUsedCoupons/e.totalCoupons*100).toFixed(1)}%`,icon:$,color:"amber"}),t.jsx(us,{title:"قسائم منتهية",value:e.expiredCoupons,icon:F,color:"red"})]}),t.jsxs("div",{className:"bg-gray-800/30 rounded-2xl p-4 space-y-4",children:[t.jsx("h4",{className:"font-medium text-white",children:"توزيع أنواع القسائم"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:"نسبة مئوية"}),t.jsx("span",{className:"text-white",children:e.couponsByType.percentage})]}),t.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:e.couponsByType.percentage/e.totalCoupons*100+"%"}})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:"قيمة ثابتة"}),t.jsx("span",{className:"text-white",children:e.couponsByType.fixed})]}),t.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:e.couponsByType.fixed/e.totalCoupons*100+"%"}})})]})]})]}),e.recentActivities?.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-medium text-white",children:"آخر النشاطات"}),t.jsx("div",{className:"space-y-3",children:e.recentActivities.map((e,s)=>t.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 flex justify-between items-center",children:[t.jsxs("span",{className:"text-blue-500 font-medium",children:[e.discountAmount.toLocaleString("ar-EG")," جنيه"]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-white",children:e.couponCode}),t.jsx("p",{className:"text-xs text-gray-400 dir-ltr",children:e.userPhone}),t.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.usedAt).toLocaleString("ar-EG")})]})]},s))})]})]})]})}):null,ps=s.memo(({isOpen:s,onClose:a,children:r})=>(e.useEffect(()=>(document.body.style.overflow=s?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[s]),s?t.jsxs("div",{className:"fixed inset-0 z-50",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:a,style:{backdropFilter:"blur(4px)"}}),t.jsx("div",{className:"fixed inset-x-0 bottom-0",style:{transform:"translateY(0)",willChange:"transform"},children:t.jsxs("div",{className:"bg-gradient-to-b from-secondary-900/95 to-secondary-900 \r\n                        rounded-t-[2.5rem] border-t border-secondary-800/50 shadow-2xl\r\n                        max-h-[90vh] overflow-y-auto hide-scrollbar",children:[t.jsx("div",{className:"flex justify-center pt-3 pb-1",children:t.jsx("div",{className:"w-12 h-1 rounded-full bg-secondary-700/50"})}),r]})})]}):null)),js=()=>t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"space-y-4 text-center",children:[t.jsx(h,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto"}),t.jsx("p",{className:"text-gray-400",children:"جاري تحميل القسائم..."})]})}),fs=({message:e})=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(a,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"حدث خطأ"}),t.jsx("p",{className:"text-gray-400",children:e})]}),vs=()=>t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Y,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"لا توجد قسائم"}),t.jsx("p",{className:"text-gray-400",children:"قم بإنشاء قسيمة جديدة للبدء"})]}),ys=()=>{const[s,r]=e.useState("analytics"),[l,n]=e.useState(!1),{token:i,isInitialized:o,loading:d,error:c,logout:x}=le();if(!o||d)return t.jsx("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50",children:[t.jsxs("div",{className:"relative",children:[t.jsx(h,{className:"w-16 h-16 text-primary-500 animate-spin mx-auto"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-primary-500/20 animate-ping"})]}),t.jsx("p",{className:"text-neutral-300 text-lg font-medium",dir:"rtl",children:"جاري تحميل لوحة التحكم..."})]})});if(c)return t.jsx("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center p-4",children:t.jsxs("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50 max-w-md",children:[t.jsxs("div",{className:"relative",children:[t.jsx(a,{className:"w-20 h-20 text-danger-500 mx-auto"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-danger-500/20 animate-pulse"})]}),t.jsx("h1",{className:"text-2xl font-bold text-white",dir:"rtl",children:"عذراً، حدث خطأ ما"}),t.jsx("p",{className:"text-neutral-400 leading-relaxed",dir:"rtl",children:c})]})});if(!i)return t.jsx("div",{className:"min-h-screen bg-neutral-950 flex items-center justify-center p-4",children:t.jsxs("div",{className:"text-center space-y-6 p-8 rounded-2xl bg-neutral-850/50 backdrop-blur-xl border border-neutral-700/50 max-w-md",children:[t.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center",children:t.jsx(ee,{className:"w-10 h-10 text-white"})}),t.jsx("h1",{className:"text-2xl font-bold text-white",dir:"rtl",children:"تسجيل الدخول مطلوب"}),t.jsx("p",{className:"text-neutral-400 leading-relaxed",dir:"rtl",children:"يرجى تسجيل الدخول للوصول إلى لوحة التحكم"})]})});const u=[{id:"analytics",icon:Z,label:"التحليلات"},{id:"products",icon:k,label:"المنتجات"},{id:"orders",icon:te,label:"الطلبات"},{id:"customers",icon:ae,label:"العملاء"},{id:"slides",icon:K,label:"العروض"},{id:"coupons",icon:Y,label:"كوبون"}];return t.jsxs("div",{className:"min-h-screen bg-neutral-950 text-white",children:[t.jsx("header",{className:"md:hidden fixed top-0 inset-x-0 z-50 bg-neutral-950/95 backdrop-blur-xl \r\n                        border-b border-neutral-800/50 shadow-2xl",children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsx("button",{onClick:()=>n(!0),className:"p-2 rounded-xl bg-neutral-850/50 hover:bg-neutral-800/50 transition-colors",children:t.jsx(se,{className:"w-6 h-6 text-neutral-400"})}),t.jsx("h1",{className:"text-lg font-bold text-white",dir:"rtl",children:u.find(e=>e.id===s)?.label||"لوحة التحكم"}),t.jsx("button",{onClick:x,className:"p-2 rounded-xl bg-neutral-850/50 hover:bg-danger-500/10 \r\n                     hover:border-danger-500/30 border border-transparent transition-all",children:t.jsx(ee,{className:"w-5 h-5 text-danger-500"})})]})}),t.jsxs("aside",{className:"hidden md:flex fixed left-0 top-0 h-full w-64 bg-neutral-950/95 \r\n                       backdrop-blur-xl border-r border-neutral-800/50 flex-col z-40",children:[t.jsxs("div",{className:"p-6 border-b border-neutral-800/50",children:[t.jsx("h1",{className:"text-xl font-bold text-white",dir:"rtl",children:"لوحة التحكم"}),t.jsx("p",{className:"text-sm text-neutral-400 mt-1",dir:"rtl",children:"إدارة المتجر"})]}),t.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:u.map(({id:e,icon:a,label:l})=>t.jsxs("button",{onClick:()=>r(e),className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\n                       transition-all duration-300 group text-right\n                       "+(s===e?"text-primary-400 bg-primary-500/10 border border-primary-500/20":"text-neutral-400 hover:text-neutral-300 hover:bg-neutral-850/50"),dir:"rtl",children:[t.jsx(a,{className:"w-5 h-5 transition-all duration-300\n                            "+(s===e?"text-primary-400":"group-hover:scale-110")}),t.jsx("span",{className:"font-medium",children:l}),s===e&&t.jsx("div",{className:"ml-auto w-2 h-8 rounded-full bg-gradient-to-b \r\n                              from-primary-400 to-primary-600"})]},e))}),t.jsx("div",{className:"p-4 border-t border-neutral-800/50",children:t.jsxs("button",{onClick:x,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\r\n                     text-danger-500 hover:bg-danger-500/10 border border-transparent\r\n                     hover:border-danger-500/30 transition-all duration-300",dir:"rtl",children:[t.jsx(ee,{className:"w-5 h-5"}),t.jsx("span",{className:"font-medium",children:"تسجيل الخروج"})]})})]}),l&&t.jsxs("div",{className:"md:hidden fixed inset-0 z-50",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>n(!1)}),t.jsxs("nav",{className:"absolute right-0 top-0 h-full w-80 max-w-[85vw] \r\n                         bg-neutral-950/95 backdrop-blur-xl border-l border-neutral-800/50\r\n                         transform transition-transform duration-300",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-neutral-800/50",children:[t.jsx("button",{onClick:()=>n(!1),className:"p-2 rounded-xl hover:bg-neutral-850/50 transition-colors",children:t.jsx(g,{className:"w-6 h-6 text-neutral-400"})}),t.jsx("h2",{className:"text-lg font-bold text-white",dir:"rtl",children:"القائمة"})]}),t.jsx("div",{className:"px-4 py-6 space-y-2",children:u.map(({id:e,icon:a,label:l})=>t.jsxs("button",{onClick:()=>(r(e),void n(!1)),className:"w-full flex items-center gap-3 px-4 py-4 rounded-xl\n                           transition-all duration-300 text-right\n                           "+(s===e?"text-primary-400 bg-primary-500/10 border border-primary-500/20":"text-neutral-400 hover:text-neutral-300 hover:bg-neutral-850/50"),dir:"rtl",children:[t.jsx(a,{className:"w-6 h-6 "+(s===e?"text-primary-400":"")}),t.jsx("span",{className:"font-medium text-lg",children:l})]},e))}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-neutral-800/50",children:t.jsxs("button",{onClick:x,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl\r\n                         text-danger-500 hover:bg-danger-500/10 border border-transparent\r\n                         hover:border-danger-500/30 transition-all duration-300",dir:"rtl",children:[t.jsx(ee,{className:"w-5 h-5"}),t.jsx("span",{className:"font-medium",children:"تسجيل الخروج"})]})})]})]}),t.jsx("nav",{className:"md:hidden fixed bottom-0 inset-x-0 z-40 bg-neutral-950/95 \r\n                     backdrop-blur-xl border-t border-neutral-800/50",children:t.jsx("div",{className:"flex justify-around py-2",children:u.slice(0,5).map(({id:e,icon:a,label:l})=>t.jsxs("button",{onClick:()=>r(e),className:"flex flex-col items-center gap-1 py-2 px-2 rounded-xl\n                       transition-all duration-300 min-w-0 flex-1\n                       "+(s===e?"text-primary-400":"text-neutral-500 hover:text-neutral-400"),children:[t.jsx(a,{className:`w-5 h-5 ${s===e?"scale-110":""} transition-transform`}),t.jsx("span",{className:"text-xs font-medium truncate w-full text-center",children:l}),s===e&&t.jsx("div",{className:"w-6 h-0.5 rounded-full bg-primary-400 mt-1"})]},e))})}),t.jsx("main",{className:"md:ml-64 pt-16 md:pt-0 pb-20 md:pb-8 min-h-screen\r\n                     bg-gradient-to-b from-neutral-950 via-neutral-950 to-neutral-900",children:(()=>{switch(s){case"analytics":return t.jsx(me,{});case"products":return t.jsx(Ne,{});case"orders":return t.jsx(Le,{});case"customers":return t.jsx(Je,{});case"slides":return t.jsx(es,{});case"coupons":return t.jsx(xs,{});default:return t.jsx(Z,{})}})()})]})};export{ys as default};
